@echo off
rem GeneXus Full Cycle - Generated Programs Transfer (GXFCGPT)
rem 
rem This process transfers the programs generated by GeneXus. An
rem optional parameter is allowed. Valid values are:
rem    A - to transfer ALL generated programs
rem    R - transfer REQUIRED programs only
rem The default value is R.
rem NOTE: Only uppercase values are allowed.
rem
rem
	if .%1 == . %0 R
rem
rem Mark beggining of Programs Transfer in log file.
rem
	gxmulti -m "Programs transfer began" "%MDLDIR%\GXFCycle.LOG"

rem
rem Check existence of RMTCMD in path
rem
	gxmulti -p RMTCMD.exe
	if not errorlevel 255 goto error1
rem
rem Analize requested function
rem
	if .%1 == .R goto Required
rem
rem Programs that do not need to be compiled (not required)
rem
	CALL #1 \
	IF NOT ERRORLEVEL 1 %FILEPATH%\gxmulti -m "Program #1 transfered" "%MDLDIR%\GXFCycle.LOG" \
	IF     ERRORLEVEL 1 CALL %FILEPATH%\gx400\gxfc_err.bat #1

rem
rem End of non required programs
rem

:Required
rem
rem Programs that need to be compiled (required)
rem
	CALL #2 \
	IF NOT ERRORLEVEL 1 gxmulti -m "Program #2 transfered" "%MDLDIR%\GXFCycle.LOG" \
	IF     ERRORLEVEL 1 CALL %FILEPATH%\gx400\gxfc_err.bat #2
rem
rem End of required programs
rem
	goto end
rem
rem ERROR RMTCMD not found in path
rem
:error1
  echo.
  echo Error ! RMTCMD not found in path.
  echo.
  %FILEPATH%\gxmulti -m "RMTCMD not found in path. Please check setup" "%MDLDIR%\GXFCycle.LOG"
  echo error1 >%MDLDIR%\gxfc_1.err
  goto end
:end
