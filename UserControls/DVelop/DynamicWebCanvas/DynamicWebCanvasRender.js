function DVelop_DynamicWebCanvas(){this.Width;this.Height;this.BackgroundImage;this.BackgroundScaleType;this.TextDefaultFontName="Arial";this.TextDefaultFontSize=12;this.TextDefaultColor="black";this.TextDefaultHorizontalAlign="Left";this.TextDefaultVerticalAlign="Top";this.CreatedImageBase64Data;this.ItemClickedId;this.Canvas;this.HiddenCanvas;this.BGHiddenCanvas;this.BGHiddenCanvasLoaded=!1;this.Items=[];this.ImageDrawn=!1;this.show=function(){this.Canvas=document.createElement("canvas");this.HiddenCanvas=document.createElement("canvas");this.HiddenCanvas.style.display="none";this.BGHiddenCanvas=document.createElement("canvas");this.BGHiddenCanvas.style.display="none";this.BackupCanvas=document.createElement("canvas");this.BackupCanvas.style.display="none";this.Canvas.width=this.Width;this.Canvas.height=this.Height;this.HiddenCanvas.width=this.Width;this.HiddenCanvas.height=this.Height;this.BGHiddenCanvas.width=this.Width;this.BGHiddenCanvas.height=this.Height;this.DrawBackgound(!0,this.Canvas);$("#"+this.ContainerName).append(this.Canvas).append(this.HiddenCanvas).append(this.BackupCanvas).append(this.BGHiddenCanvas);var n=this;this.Canvas.addEventListener("click",function(t){for(var i,u=t.offsetX,f=t.offsetY,r=n.Items.length-1;r>=0;r--)if(i=n.Items[r],f>i.y&&f<i.y+i.height&&u>i.x&&u<i.x+i.width){n.ItemClickedId=i.id;n.OnItemClicked();break}},!1);$(this.Canvas).on("mousemove",function(t){var r,i;if(n.disableHover==null||!n.disableHover){var u=t.offsetX,f=t.offsetY,o=n.hoverItem,s="",e=!1;for(r=n.Items.length-1;r>=0;r--)if(i=n.Items[r],f>i.y&&f<i.y+i.height&&u>i.x&&u<i.x+i.width){n.hoverItem!=i&&(n.hoverItem!=null&&n.UndoHoverItem(n.hoverItem),i.hoverEffect&&n.SaveItemToUndoHover(i));n.hoverItem=i;s="pointer";e=!0;break}$(n.Canvas).css("cursor",n.hoverItem!=null?n.hoverItem.cursor:"");n.Canvas.title=n.hoverItem!=null?n.hoverItem.tooltip:"";n.hoverItem!=null&&n.hoverItem.hoverEffect?e?n.hoverItem!=o&&n.DrawItemHovered(n.hoverItem):(n.UndoHoverItem(n.hoverItem),n.hoverItem=null):n.hoverItem=null}})};this.SaveItemToUndoHover=function(n){var t=this.BackupCanvas.getContext("2d");this.BackupCanvas.width=n.width;this.BackupCanvas.height=n.height;t.drawImage(this.Canvas,n.x,n.y,n.width,n.height,0,0,n.width,n.height)};this.UndoHoverItem=function(n){var t=this.Canvas.getContext("2d");t.drawImage(this.BackupCanvas,0,0,n.width,n.height,n.x,n.y,n.width,n.height)};this.CopyHoveredItem=function(n){var i=new Image,t=this.Canvas.getContext("2d");t.drawImage(this.HiddenCanvas,n.x,n.y,n.width,n.height,n.x,n.y,n.width,n.height)};this.AddOrUpdateImage=function(n,t,i,r,u,f,e){this.AdvancedAddOrUpdateImageWithText(n,t,i,r,u,null,f,e,null,null,null,null,null,"pointer","",!0)};this.AdvancedAddOrUpdateImage=function(n,t,i,r,u,f,e,o,s,h){this.AdvancedAddOrUpdateImageWithText(n,t,i,r,u,null,f,e,null,null,null,null,null,o,s,h)};this.AddOrUpdateText=function(n,t,i,r,u,f,e,o,s,h,c,l){this.AdvancedAddOrUpdateImageWithText(n,t,i,r,null,u,f,e,o,s,h,c,l,"pointer","",!0)};this.AdvancedAddOrUpdateText=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y){this.AdvancedAddOrUpdateImageWithText(n,t,i,r,null,u,f,e,size,s,color,horizontalAlign,verticalAlign,a,v,y)};this.AddOrUpdateImageWithText=function(n,t,i,r,u,f,e,o,s,h){this.AdvancedAddOrUpdateImageWithText(n,t,i,r,u,f,e,o,size,h,color,horizontalAlign,verticalAlign,"pointer","",!0)};this.AdvancedAddOrUpdateImageWithText=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p){var b={id:n,x:t,y:i,z:r,imageURL:u,text:f,width:e,height:o,fSize:s,fName:h,fColor:c,tHAlign:l,tVAlign:a,cursor:v,tooltip:y,hoverEffect:p},w=this.RemoveItemFromItems(n);w=this.AddItem(b)||w||this.hoverItem!=null;this.hoverItem=null;w?this.WaitAndRedrawCanvas():this.AddImageObj(b,this.Canvas,null)};this.AddItem=function(n){for(var t=0;t<this.Items.length&&this.Items[t].z<=n.z;)t++;return this.Items.splice(t,0,n),t<this.Items.length-1};this.RemoveItem=function(n){this.RemoveItemFromItems(n)&&this.WaitAndRedrawCanvas()};this.RemoveItemFromItems=function(n){var i,t;for(this.hoverItem=null,i=-1,t=0;t<this.Items.length;t++)if(this.Items[t].id==n){i=t;break}return i!=-1?(this.Items.splice(i,1),!0):!1};this.WaitAndRedrawCanvas=function(){this.disableHover=!0;var n=this;this.disableHoverTimer!=null&&clearTimeout(this.disableHoverTimer);this.reDrawTimer!=null&&clearTimeout(this.reDrawTimer);this.reDrawTimer=setTimeout(function(){n.RedrawCanvas()},100)};this.EnableHover=function(){this.disableHover=!1};this.DrawItemHovered=function(n){var i,t;for(this.DrawBackgound(!1,this.HiddenCanvas),i=0;i<this.Items.length;i++)t=this.Items[i],n.y<=t.y+t.height&&n.y+n.height>=t.y&&n.x<=t.x+t.width&&n.x+n.width>=t.x&&this.AddImageObj(t,this.HiddenCanvas,n)};this.RedrawCanvas=function(){var t,n,i;for(this.ImageDrawn=!1,t=this.Canvas,this.DrawBackgound(!1,t),n=0;n<this.Items.length;n++)this.AddImageObj(this.Items[n],t,null);i=this;this.disableHoverTimer=setTimeout(function(){i.EnableHover()},100)};this.AddImageObj=function(n,t,i){var r=new Image,u=this;r.onload=function(){u.ImageDrawn=!0;var f=t.getContext("2d");f.globalAlpha=1;i!=null&&i.id!=null&&i.id==n.id&&(f.globalAlpha=.7);n.imageURL!=null&&n.imageURL!=""&&(n.width>0||n.height>0?f.drawImage(r,n.x,n.y,n.width,n.height):(n.width=this.width,n.height=this.height,f.drawImage(r,n.x,n.y)));n.text!=null&&n.text!=""&&u.AddTextToCanvas(n,f);i!=null&&i==u.hoverItem&&u.CopyHoveredItem(i)};r.src=n.imageURL!=null&&n.imageURL!=""?n.imageURL:"DVelop/DynamicWebCanvas/DummyImage.png"};this.AddTextToCanvas=function(n,t){var r=n.x,u=n.y,e=n.fName!=null&&n.fName!=""?n.fName:this.TextDefaultFontName,f=n.fSize!=null&&n.fSize!=""&&n.fSize!=0?n.fSize:this.TextDefaultFontSize;t.fillStyle=n.fColor!=null&&n.fColor!=""?n.fColor:this.TextDefaultColor;t.font=f+"px "+e;var i=f/3+1,o=n.tHAlign!=null&&n.tHAlign!=""?n.tHAlign:this.TextDefaultHorizontalAlign,s=n.tVAlign!=null&&n.tVAlign!=""?n.tVAlign:this.TextDefaultVerticalAlign;switch(o+s){case"LeftTop":t.textBaseline="top";r+=i;u+=i;break;case"LeftCenter":t.textBaseline="middle";r+=i;u+=n.height/2;break;case"LeftBottom":t.textBaseline="bottom";r+=i;u+=n.height-i;break;case"CenterTop":t.textAlign="center";t.textBaseline="top";r+=n.width/2;u+=i;break;case"CenterCenter":t.textAlign="center";t.textBaseline="middle";r+=n.width/2;u+=n.height/2;break;case"CenterBottom":t.textAlign="center";t.textBaseline="bottom";r+=n.width/2;u+=n.height-i;break;case"RightTop":t.textAlign="right";t.textBaseline="top";r+=n.width-i;u+=i;break;case"RightCenter":t.textAlign="right";t.textBaseline="middle";r+=n.width-i;u+=n.height/2;break;case"RightBottom":t.textAlign="right";t.textBaseline="bottom";r+=n.width-i;u+=n.height-i;break;default:t.textBaseline="bottom";r+=i;u+=n.height-i}t.fillText(n.text,r,u)};this.SaveImage=function(){this.CreatedImageBase64Data=this.Canvas.toDataURL();this.CreatedImageBase64Data.length>22&&(this.CreatedImageBase64Data=this.CreatedImageBase64Data.substring(22));this.OnImageSaved()};this.ResetCanvas=function(){this.Canvas.width=this.Width;this.Canvas.height=this.Height;this.HiddenCanvas.width=this.Width;this.HiddenCanvas.height=this.Height;this.BGHiddenCanvas.width=this.Width;this.BGHiddenCanvas.height=this.Height;this.BGHiddenCanvasLoaded=!1;this.ImageDrawn=!1;this.DrawBackgound(!1,this.Canvas);this.Items=[]};this.DrawBackgound=function(n,t){var u=t.getContext("2d"),i,r;this.BackgroundImage!=""&&(u=t.getContext("2d"),u.globalAlpha=1,this.BGHiddenCanvasLoaded?u.drawImage(this.BGHiddenCanvas,0,0,t.width,t.height,0,0,t.width,t.height):(i=this,r=new Image,r.onload=function(){var f,e,o,s;if(this.width>0&&this.height>0&&i.BackgroundScaleType!="NoScale")if(i.BackgroundScaleType=="Tile")for(s=0;s<i.Canvas.height;){for(o=0;o<i.Canvas.width;)u.drawImage(r,o,s),i.BGHiddenCanvas.getContext("2d").drawImage(r,o,s),o+=this.width;s+=this.height}else i.BackgroundScaleType=="Fill"?(u.drawImage(r,0,0,i.Canvas.width,i.Canvas.height),i.BGHiddenCanvas.getContext("2d").drawImage(r,0,0,i.Canvas.width,i.Canvas.height)):i.BackgroundScaleType=="FillKeepingAspectRatio"?(f=this.width,e=this.height,i.Canvas.width*e/f>=i.Canvas.height?(e=i.Canvas.width*e/f,f=i.Canvas.width):(f=i.Canvas.height*f/e,e=i.Canvas.height),o=(i.Canvas.width-f)/2,s=(i.Canvas.height-e)/2,u.drawImage(r,o,s,f,e),i.BGHiddenCanvas.getContext("2d").drawImage(r,o,s,f,e)):(f=this.width,e=this.height,i.Canvas.width*e/f<=i.Canvas.height?(e=i.Canvas.width*e/f,f=i.Canvas.width):(f=i.Canvas.height*f/e,e=i.Canvas.height),o=(i.Canvas.width-f)/2,s=(i.Canvas.height-e)/2,u.drawImage(r,o,s,f,e),i.BGHiddenCanvas.getContext("2d").drawImage(r,o,s,f,e));else o=(i.Canvas.width-this.width)/2,s=(i.Canvas.height-this.height)/2,u.drawImage(r,o,s),i.BGHiddenCanvas.getContext("2d").drawImage(r,o,s);i.BGHiddenCanvasLoaded=!0;n&&i.ImageDrawn&&t==i.Canvas&&i.WaitAndRedrawCanvas()},r.src=this.BackgroundImage))}};$(window).one('load',function(){WWP_VV([['DynamicWebCanvas','14.0']]);});