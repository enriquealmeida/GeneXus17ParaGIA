var UCDashboardForEditor,WidgetType={Object:"Object",Filter:"Filter",TextBlock:"TextBlock",Button:"Button",Image:"Image",Blank:"Blank"},ControlType={Editbox:"Edit",Checkbox:"Check box",RadioButton:"Radio button",ComboBox:"Combo box",Slider:"Slider",DropDownList:"Drop-down list",Switch:"Switch"},DataType={Integer:"Numeric (without decimals)",Real:"Numeric (with decimals)",Character:"Character",Boolean:"Boolean",Date:"Date",DateTime:"DateTime",GUID:"GUID",GeoPoint:"GeoPoint"},FilterType={Value:"Value",
Range:"Range",Collection:"Collection"},ParameterType={Value:"Value",Collection:"Collection"},ControlOrientation={Horizontal:"Horizontal",Vertical:"Vertical"},ChartType={Column:"Column",Column3D:"Column3D",StackedColumn:"StackedColumn",StackedColumn3D:"StackedColumn3D",StackedColumn100:"StackedColumn100",Bar:"Bar",StackedBar:"StackedBar",StackedBar100:"StackedBar100",Area:"Area",StackedArea:"StackedArea",StackedArea100:"StackedArea100",SmoothArea:"SmoothArea",StepArea:"StepArea",Line:"Line",StackedLine:"StackedLine",
StackedLine100:"StackedLine100",SmoothLine:"SmoothLine",StepLine:"StepLine",Timeline:"Timeline",SmoothTimeline:"SmoothTimeline",StepTimeline:"StepTimeline",Sparkline:"Sparkline",Pie:"Pie",Pie3D:"Pie3D",Doughnut:"Doughnut",Doughnut3D:"Doughnut3D",LinearGauge:"LinearGauge",CircularGauge:"CircularGauge",Radar:"Radar",FilledRadar:"FilledRadar",PolarArea:"PolarArea",Funnel:"Funnel",Pyramid:"Pyramid",ColumnLine:"ColumnLine",Column3DLine:"Column3DLine"},PlotSeries={InTheSameChart:"InTheSameChart",InSeparateCharts:"InSeparateCharts"},
XAxisLabels={Horizontally:"Horizontally",Rotated30:"Rotated 30ยบ",Rotated45:"Rotated 45ยบ",Rotated60:"Rotated 60ยบ",Vertically:"Vertically"},ShowDataAs={Values:"Values",Percentages:"Percentages",ValuesAndPercentages:"ValuesAndPercentages"},TrendPeriod={SinceTheBeginning:"SinceTheBeginning",LastYear:"LastYear",LastSemester:"LastSemester",LastQuarter:"LastQuarter",LastMonth:"LastMonth",LastWeek:"LastWeek",LastDay:"LastDay",LastHour:"LastHour",LastMinute:"LastMinute",LastSecond:"LastSecond"},Orientation=
{Horizontal:"Horizontal",Vertical:"Vertical"},ShowDataLabelsIn={Columns:"Columns",Rows:"Rows"},Total={Yes:"Yes",No:"No"},ShowValuesAs={NoCalculation:"NoCalculation",RunningTotal:"RunningTotal",RollingAverage:"RollingAverage"},RollingAverageType={Simple:"Simple",Central:"Central",Cumulative:"Cumulative",Weighted:"Weighted",Exponential:"Exponential"},DifferenceFrom={PreviousValue:"PreviousValue",FirstValue:"FirstValue"},ShowAsPercentage={No:"No",Yes:"Yes"},MapType={Choropleth:"Choropleth",Bubble:"Bubble",
Point:"Point"},Region={World:"World",Continent:"Continent",Country:"Country"},Continent={NorthAmerica:"NorthAmerica"},Country={US:"US"},ObjectType={Query:"Query",DataProvider:"DataProvider"},OnItemClick={DoNothing:"Do nothing",RaiseItemClick:"Raise ItemClick event",ApplyFilters:"Apply filters",HighlightValues:"Highlight values"},FiltersPosition={Left:"Left",Right:"Right",Top:"Top"},MainTableLayout={Free:"Free",TwoColumns:"Two columns",ThreeColumns:"Three columns",HeaderTwoColumns:"Header + two columns",
HeaderThreeColumns:"Header + three columns",HeaderTwoColumnsFooter:"Header + two columns + footer",HeaderThreeColumnsFooter:"Header + three columns + footer"},Methods={SetFilterValue:"SetFilterValue",SetFilterRange:"SetFilterRange",SetFilterValues:"SetFilterValues"},MAIN_TABLE_ID="1",FILTERS_TABLE_ID="2",ChildType=JSON.parse(JSON.stringify(WidgetType));ChildType.Table=ElementType.Table;
function UpdateDashboardEditorElement(n,a,b,c){n=UCDashboardForEditor.editor.GetElement(n);null!=n&&(""!=c&&UCDashboardForEditor.InsertCssRules(c),b=JSON.parse(b),UCDashboardForEditor.UpdateElement(n,b,a))}function UpdateDashboardEditorParameters(n){var a=UCDashboardForEditor.DashboardObject;a.Parameters=JSON.parse(n);UCDashboardForEditor.LoadParametersDefaults(a);UCDashboardForEditor.UpdateParameterVariables(a)}function SelectAllDashboardElements(){UCDashboardForEditor.editor.SelectAll()}
function MouseOverElement(n){UCDashboardForEditor.editor.MouseOver(null,n)}function MouseOutElement(n){UCDashboardForEditor.editor.MouseOut(null,n)}function MouseClickElement(n){UCDashboardForEditor.editor.SelectElement(null,n,!1,!0)}
function DashboardViewer(n){this.WidgetsExpanded=!0;this.LoadingSpec=!1;this.HeldMethods=[];this.SetItemClickData=function(a){this.ItemClickData=a};this.GetItemClickData=function(){return this.ItemClickData};this.SetFiltersChangedData=function(a){this.FiltersChangedData=a};this.GetFiltersChangedData=function(){return this.FiltersChangedData};this.SetValuesHighlightedData=function(a){this.ValuesHighlightedData=a};this.GetValuesHighlightedData=function(){return this.ValuesHighlightedData};this.show=
function(){qv.services.GetDashboardSpecIfNeeded(this,function(a,b){b.UpdateDashboardObject(a);var c=b.DashboardObject;if(null!=c){qv.TranslationType=b.TranslationType;var d={dashboard:c,widgetsExpanded:function(){return b.WidgetsExpanded},callbacks:{selectElements:function(a){window.external.SelectElements(a)},selectObjectItem:function(a,b){window.external.SelectObjectItem(a,b)},addElement:function(a,b,c){window.external.AddElement(a,b,c)},moveElement:function(a,b,c){window.external.MoveElement(a,
b,c)},moveElements:function(a,b,c){window.external.MoveElements(a,b,c)},addKBObjects:function(a,b,c){window.external.AddKBObjects(a,b,c)}},layoutDefaults:function(a){b.LayoutDefaults(a)},tableDefaults:function(a){b.TableDefaults(a)},rowDefaults:function(a){b.RowDefaults(a)},cellDefaults:function(a){b.CellDefaults(a)},widgetDefaults:function(a,c,d){b.WidgetDefaults(a,c,d)},getWidgetContentHTML:function(a,c){return b.GetWidgetContentHTML(a,c)},addExtraRow:function(a,c){return 0==c.Rows.length||c.ElementId==
FILTERS_TABLE_ID||c.ElementId==MAIN_TABLE_ID&&a.MainTableLayout==MainTableLayout.Free||b.IsMainTableLayoutTable(c)},widgetOverflowStr:function(){return""},cellHasVisibleContent:function(a,b){return b.ChildType==ChildType.Filter?b.Filter.Visible||a:!0},isMainTableLayoutTable:function(a){return b.IsMainTableLayoutTable(a)},isHeight100Percent:function(a,c,d){return b.IsHeight100Percent(a,c,d)},getElementIcon:function(a){switch(a.WidgetType){case WidgetType.Object:return"Object.ico";case WidgetType.Filter:return"Filter.ico";
case WidgetType.TextBlock:return"TextBlock.ico";case WidgetType.Image:return"Image.ico";case WidgetType.Button:return"Button.ico";default:return""}},getUpperMostAncestorElementId:function(a){do var b=a.ElementId,a=a.ParentElement;while(b!=MAIN_TABLE_ID&&b!=FILTERS_TABLE_ID);return b},onAddElement:function(a,c){b.OnAddElement(a,c)},onRemoveElement:function(a,c){b.OnRemoveElement(a,c)},isEditor:function(){return b.IsDashboardEdit()},dependsOnElement:function(a,c){return b.DependsOnElement(a,c)},impactsElement:function(a,
c){return b.ImpactsElement(a,c)},getContainerControlId:function(){return b.getContainerControl().id},getMe:function(){return b.me()+".editor"},getMessage:function(a){return gx.getMessage(a)},get:function(a){return n(a)},startsWith:function(a,b){return qv.util.startsWith(a,b)},endsWith:function(a,b){return qv.util.endsWith(a,b)},replaceVariablesValuesInText:function(a,c){return b.ReplaceVariablesValuesInText(a,c)},getHamburgerMenuHTML:function(a){return b.GetObjectMenuHTML(a)},getElementReferences:function(a){return b.GetElementReferences(a)}};
b.LoadParameterVariables(c);b.editor=new BrowserLayout(d);b.LoadFilterVariables(c);b.SetContainerSize();b.RenderDashboard();c=b.ReplaceVariableValue(c.Layout.RefreshPeriod,[DataType.Integer,DataType.Real],!1,c.Variables.Filters);b.SetRefreshPeriod(b,c)}else b.RenderError(gx.getMessage("GX_Dashboard_NotAssigned"));b.LoadingSpec=!1;b.ReleaseMethods()})};this.HoldMethod=function(a,b){this.HeldMethods.push({Method:a,Parameters:b})};this.ReleaseMethods=function(){for(var a=0;a<this.HeldMethods.length;a++){var b=
this.HeldMethods[a].Parameters;switch(this.HeldMethods[a].Method){case Methods.SetFilterValue:this.SetFilterValue(b[0],b[1]);break;case Methods.SetFilterRange:this.SetFilterRange(b[0],b[1],b[2],b[3]);break;case Methods.SetFilterValues:this.SetFilterValues(b[0],JSON.parse(b[1]))}}this.HeldMethods.splice(0,this.HeldMethods.length)};this.Refresh=function(){this.RefreshDashboard()};this.GetFilterValue=function(a){var b=this.GetFilterByAnyName(a);return null!=b&&b.Type!=FilterType.Collection?b.Type==FilterType.Value?
b.SerializedValue:b.NameLowerValue==a?b.SerializedLowerValue:b.SerializedUpperValue:""};this.GetFilterValues=function(a){a=this.GetFilterByName(a);if(null!=a&&a.Type==FilterType.Collection)for(var b=[],c=0;c<a.Values.length;c++)b.push(this.ValueToString(a.Values[c],a.DataType,a.Picture,a.PictureProperties));return b};this.SetFilterValue=function(a,b){if(this.LoadingSpec)this.HoldMethod(Methods.SetFilterValue,[a,b]);else{var c=this.GetFilterByName(a);if(null!=c&&c.Type==FilterType.Value&&!c.IsHidden){var d=
this.UpdateFilter1(null,a,b);d&&this.RefreshWidget(c)}else if(c=this.GetObjectElementForFilter(a),null!=c){var d=this.DefaultPicture(c.Element.DataType),e=this.GetPictureProperties(c.Element.DataType,d),d=this.CheckFilterValue(b,c.Element.DataType,FilterType.Value,d,e,null,null,!1);if(d.Success&&(d=this.AddHiddenFilter(c.Object,a,d.ParsedValue,c.Element.DataType)))this.RefreshDashboard([a]),c.Object.QueryViewer.Select([{Name:a,Value:b}])}}};this.SetFilterRange=function(a,b,c,d){if(this.LoadingSpec)this.HoldMethod(Methods.SetFilterRange,
[a,b,c,d]);else{var e;e=""==a?this.GetFilterByAnyName(c):this.GetFilterByAnyName(a);null!=e&&e.Type==FilterType.Range&&(""==a?this.UpdateFilter2(null,e.NameLowerValue,c,e.SerializedLowerValue,d):""==c?this.UpdateFilter2(null,a,e.NameUpperValue,b,e.SerializedUpperValue):this.UpdateFilter2(null,a,c,b,d))&&this.RefreshWidget(e)}};this.SetFilterValues=function(a,b){if(this.LoadingSpec)this.HoldMethod(Methods.SetFilterValues,[a,JSON.stringify(b)]);else{var c=this.GetFilterByName(a);null!=c&&c.Type==FilterType.Collection&&
this.UpdateFilter1(null,a,JSON.stringify(b))&&this.RefreshWidget(c)}};this.GetObjectElementForFilter=function(a){for(var b=this.DashboardObject,c=0;c<b.Objects.length;c++){var d=b.Objects[c];if(d.OnItemClick==OnItemClick.ApplyFilters)for(var e=0;e<d.Elements.length;e++){var f=d.Elements[e];if(f.Name.toLowerCase()==a.toLowerCase())return{Object:d,Element:f}}}return null};this.SetRefreshPeriod=function(a,b){this._refreshInterval&&clearInterval(this._refreshInterval);!isNaN(b)&&0!=b&&(this._refreshInterval=
setInterval(a.me()+".RefreshDashboard();",1E3*b))};this.RenderError=function(a){this.setHtml('<div style="height: '+this.Height+"; width: "+this.Width+'; border: silver thin solid">'+this.CenteredTextHTML("","",gx.getMessage("GX_Dashboard_Error")+": "+a)+"</div>")};this.CenteredTextHTML=function(a,b,c){return"<div"+(""==b?"":' class="'+b+'"')+' style="display:table;width:100%;height:100%"><div style="display:table-cell;vertical-align:middle;text-align:center"><span'+(""==a?"":' id="'+a+'"')+">"+c+
"</span></div></div>"};this.LoadParametersDefaults=function(a){this._ValidParametersCalculated=!1;for(var b=0;b<a.Parameters.length;b++)this.ParameterDefaults(a.Parameters[b])};this.UpdateDashboardObject=function(a){function b(a,b){if(a.Object)for(var e=eval(a.Object),f=0;f<b.Parameters.length;f++){var g=b.Parameters[f];if(f+2<=e.length-1){var h=a.ParseValue(e[f+2],g.DataType,g.Type==ParameterType.Collection);h.Success&&(g.Value=h.ParsedValue,a.SerializeParameterValue(g))}}}a!=this.DashboardSpec&&
(this.DashboardSpec=a);""!=this.DashboardSpec?(this.DashboardObject=JSON.parse(this.DashboardSpec),this.LoadParametersDefaults(this.DashboardObject),b(this,this.DashboardObject),this.DashboardDefaults(this.DashboardObject),this.IsDashboardEdit()&&(UCDashboardForEditor=this)):this.DashboardObject=null};this.GetDashboardSpec=qv.services.createAsyncServerCallFn(this,qv.services.url.getDashboardSpecURL,qv.services.postInfo.DashboardSpec);this.IsRelated=function(a,b){return b.WidgetType==WidgetType.Filter?
this.IsFilterRelated(a,b):b.WidgetType==WidgetType.Object?this.IsObjectRelated(a,b):!1};this.IsFilterRelated=function(a,b){return b.IsHidden?!1:b.Type==FilterType.Range?0<=this.CaseInsensitiveIndexOf(a.Parameters,b.NameLowerValue)||0<=this.CaseInsensitiveIndexOf(a.Parameters,b.NameUpperValue):0<=this.CaseInsensitiveIndexOf(a.Parameters,b.Name)};this.IsObjectRelated=function(a,b){if(b.OnItemClick==OnItemClick.ApplyFilters)for(var c=0;c<b.Elements.length;c++)if(0<=this.CaseInsensitiveIndexOf(a.Parameters,
b.Elements[c].Name))return!0;return!1};this.DependsOnElement=function(a,b){return a.ElementType!=ElementType.Widget&&a.ElementType!=ElementType.Layout?!1:b.WidgetType==WidgetType.Filter||b.WidgetType==WidgetType.Object?this.IsRelated(a,b):!1};this.ImpactsElement=function(a,b){return a.ElementType!=ElementType.Widget&&a.ElementType!=ElementType.Layout?!1:a.WidgetType==WidgetType.Filter||a.WidgetType==WidgetType.Object?this.IsRelated(b,a):!1};this.SetContainerSize=function(){var a=document.getElementById(this.ContainerName);
""!=this.Width&&(a.style.width=gx.dom.addUnits(this.Width));""!=this.Height&&(a.style.height=gx.dom.addUnits(this.Height))};this.IsDashboardEdit=function(){this._IsDashboardEdit||(this._IsDashboardEdit=void 0!=window.external&&void 0!=window.external.SelectElements&&void 0!=window.external.DeleteSelectedElements&&void 0!=window.external.SelectObjectItem&&void 0!=window.external.AddElement&&void 0!=window.external.MoveElement&&void 0!=window.external.MoveElements&&void 0!=window.external.AddKBObjects&&
void 0!=window.external.SetFilterValue&&void 0!=window.external.SetFilterValues&&void 0!=window.external.SetFrameCollapsed&&void 0!=window.external.SendText);return this._IsDashboardEdit};this.ProcessResponsiveSizes=function(a){function b(a,b,c){for(var a=a.Rows[b],d=0,e=0,b=0;b<a.Cells.length;b++){var g=a.Cells[b];g.ResponsiveSizes.Width[c]&&(d+=g.ResponsiveSizes.Width[c],e+=1)}d=12-d;e=a.Cells.length-e;for(b=0;b<a.Cells.length;b++)if(g=a.Cells[b],!g.ResponsiveSizes.Width[c]){var f=Math.ceil(d/e);
g.ResponsiveSizes.Width[c]=f;d-=f;e-=1}}function c(a,b,c,d){function e(a,b){for(var c=0,d=0;d<a.length&&a[d].OldPos!=b;d++)a[d].Visible&&(c+=a[d].Width);return c}function g(a,b){if(a.NewPos<b.NewPos)return-1;if(a.NewPos>b.NewPos)return 1;var c;c=a.OldPos<b.OldPos?-1:a.OldPos>b.OldPos?1:0;return c}for(var f=[],h=!1,a=a.Rows[b],b=0;b<a.Cells.length;b++){var j=a.Cells[b],m=j.ResponsiveSizes.Width[d]||parseInt(12/a.Cells.length),t=j.ResponsiveSizes.Move[d]||0;f.push({OldPos:b,NewPos:0!=t?t:a.Cells.length,
Width:m+(j.ResponsiveSizes.Offset[d]||0),Visible:void 0!=j.ResponsiveSizes.Visible[d]?j.ResponsiveSizes.Visible[d]:!0});0!=t&&(h=!0)}h&&(h=e(f,c),f.sort(g),t=e(f,c)-h,0<t?a.Cells[c].ResponsiveSizes.Push[d]=t:0>t?a.Cells[c].ResponsiveSizes.Pull[d]=-t:(f=Object.values(ResponsiveScale)[Object.values(ResponsiveScale).indexOf(d)-1],void 0!=f&&(h=a.Cells[c].ResponsiveSizes.Pull[f],0<a.Cells[c].ResponsiveSizes.Push[f]&&(a.Cells[c].ResponsiveSizes.Push[d]=0),0<h&&(a.Cells[c].ResponsiveSizes.Pull[d]=0))))}
for(var d=0;d<a.Rows.length;d++){row=a.Rows[d];for(var e={},f=0;f<row.Cells.length;f++){for(var g=row.Cells[f],h={Width:{},Offset:{},Visible:{},Move:{},Push:{},Pull:{}},j=0;j<a.ResponsiveSizes.length;j++){var l=a.ResponsiveSizes[j];if(d<l.rows.length){var m=l.rows[d];if(f<m.length&&(m=m[f],void 0!=m.width&&(h.Width[l.scale]=Math.round(12*m.width/100),e[l.scale]=!0),void 0!=m.offset&&(h.Offset[l.scale]=Math.round(12*m.offset/100)),void 0!=m.visible&&(h.Visible[l.scale]=m.visible),void 0!=m.move))h.Move[l.scale]=
m.move}}g.ResponsiveSizes=h}for(j=0;j<a.ResponsiveSizes.length;j++)f=a.ResponsiveSizes[j].scale,e[f]&&b(a,d,f);for(f=0;f<row.Cells.length;f++)for(j=0;j<a.ResponsiveSizes.length;j++)c(a,d,f,a.ResponsiveSizes[j].scale)}};this.DashboardDefaults=function(a){a.Name=a.Name||"";a.Description=a.Description||"";a.Objects=[];a.Filters=[];a.Buttons=[];a.Images=[];a.TextBlocks=[]};this.LayoutDefaults=function(a){a.Title=void 0!=a.Title?qv.util.getTranslation(a.Title):"";a.RefreshPeriod=a.RefreshPeriod||0;a.MainTableLayout=
a.MainTableLayout||MainTableLayout.Free;a.FiltersPosition=a.FiltersPosition||FiltersPosition.Right;a.ElementId=a.ElementId||"";a.Parameters=a.Parameters||[]};this.ParameterDefaults=function(a){a.Name=a.Name||"";a.DataType=a.DataType||DataType.Integer;a.Type=a.Type||ParameterType.Value;a.Picture=a.Picture||this.DefaultPicture(a.DataType);var b=this.GetPictureProperties(a.DataType,a.Picture);null!=b&&(a.PictureProperties=b);a.Value||(a.Value=this.GetEmptyValue(a.DataType,a.Type==ParameterType.Collection),
this.SerializeParameterValue(a))};this.TableDefaults=function(a){a.ControlName=a.ControlName||"";a.ElementId=a.ElementId||"";a.Class=a.Class||"";a.Rows=a.Rows||[];a.Mode=TableMode.Bootstrap;a.ResponsiveSizes=a.ResponsiveSizes||[];this.ProcessResponsiveSizes(a)};this.RowDefaults=function(a){a.ElementId=a.ElementId||"";a.RowClass=a.RowClass||"";a.Cells=a.Cells||[]};this.CellDefaults=function(a){a.ElementId=a.ElementId||"";a.CellClass=a.CellClass||"";a.ChildType=a.ChildType||"";a.IsEmpty=a.IsEmpty||
""==a.ChildType;a.HasTable=a.ChildType==ChildType.Table};this.BasicWidgetDefaults=function(a,b,c){a.ElementId=a.ElementId||"";a.ControlName=a.ControlName||"";a.WidgetType=c;a.FrameVisible=a.FrameVisible||!1;a.FrameTitle=void 0!=a.FrameTitle?qv.util.getTranslation(a.FrameTitle):"";a.FrameAllowCollapsing=a.FrameAllowCollapsing||!1;a.FrameCollapsed=a.FrameCollapsed||!1;a.Parameters=a.Parameters||[]};this.ObjectElementDefaults=function(a){a.Name=a.Name||"";a.DataType=a.DataType||DataType.Integer;a.Title=
a.Title||"";a.DataField=a.DataField||"";a.Visible=a.Visible||"";a.Type=a.Type||"";a.Axis=a.Axis||"";a.Aggregation=a.Aggregation||"";a.Format=a.Format||{};a.Format.Picture=a.Format.Picture||"";a.Format.Subtotals=a.Format.Subtotals||"";a.Format.CanDragToPages=void 0!=a.Format.CanDragToPages?a.Format.CanDragToPages:!0;a.Format.Style=a.Format.Style||"";a.Format.TargetValue=a.Format.TargetValue||0;a.Format.MaximumValue=a.Format.MaximumValue||0;a.Format.ValueStyles=a.Format.ValueStyles||[];a.Format.ConditionalStyles=
a.Format.ConditionalStyles||[];a.Filter=a.Filter||{};a.Filter.Type=a.Filter.Type||"";a.Filter.Values=a.Filter.Values||[];a.ExpandCollapse=a.ExpandCollapse||{};a.ExpandCollapse.Type=a.ExpandCollapse.Type||"";a.ExpandCollapse.Values=a.ExpandCollapse.Values||[];a.AxisOrder=a.AxisOrder||{};a.AxisOrder.Type=a.AxisOrder.Type||"";a.AxisOrder.Values=a.AxisOrder.Values||[];a.Grouping=a.Grouping||{};a.Grouping.GroupByYear=a.Grouping.GroupByYear||!1;a.Grouping.YearTitle=a.Grouping.YearTitle||"";a.Grouping.GroupBySemester=
a.Grouping.GroupBySemester||!1;a.Grouping.SemesterTitle=a.Grouping.SemesterTitle||"";a.Grouping.GroupByQuarter=a.Grouping.GroupByQuarter||!1;a.Grouping.QuarterTitle=a.Grouping.QuarterTitle||"";a.Grouping.GroupByMonth=a.Grouping.GroupByMonth||!1;a.Grouping.MonthTitle=a.Grouping.MonthTitle||"";a.Grouping.GroupByDayOfWeek=a.Grouping.GroupByDayOfWeek||!1;a.Grouping.DayOfWeekTitle=a.Grouping.DayOfWeekTitle||"";a.Grouping.HideValue=a.Grouping.HideValue||!1;a.RaiseItemClick=void 0!=a.RaiseItemClick?a.RaiseItemClick:
!0;a.Analytics=a.Analytics||{};a.Analytics.ShowValuesAs=a.Analytics.ShowValuesAs||ShowValuesAs.NoCalculation;a.Analytics.RollingAverageType=a.Analytics.RollingAverageType||RollingAverageType.Simple;a.Analytics.RollingAverageTerms=a.Analytics.RollingAverageTerms||10;a.Analytics.DifferenceFrom=a.Analytics.DifferenceFrom||DifferenceFrom.PreviousValue;a.Analytics.ShowAsPercentage=a.Analytics.ShowAsPercentage||ShowAsPercentage.No};this.ObjectElementsDefaults=function(a,b){for(var c=0;c<a.length;c++)this.ObjectElementDefaults(a[c],
b)};this.ObjectDefaults=function(a,b){this.BasicWidgetDefaults(a,b,WidgetType.Object);a.Name=a.Name||"";a.Type=a.Type||ObjectType.Query;a.Elements=a.Elements||[];this.ObjectElementsDefaults(a.Elements,b);a.Class=a.Class||"";a.ContainerClass=a.ContainerClass||"";a.FrameClass=a.FrameClass||"";a.FrameTitleClass=a.FrameTitleClass||"";a.FrameBodyClass=a.FrameBodyClass||"";a.Output=a.Output||{};a.Output.Title=a.Output.Title||"";a.Output.Type=a.Output.Type||OutputType.Chart;a.Output.ChartType=a.Output.ChartType||
ChartType.Column;a.Output.PlotSeries=a.Output.PlotSeries||PlotSeries.InTheSameChart;a.Output.XAxisLabels=a.Output.XAxisLabels||XAxisLabels.Horizontally;a.Output.XAxisIntersectionAtZero=a.Output.XAxisIntersectionAtZero||!1;a.Output.ShowValues=void 0!=a.Output.ShowValues?a.Output.ShowValues:!0;a.Output.XAxisTitle=a.Output.XAxisTitle||"";a.Output.YAxisTitle=a.Output.YAxisTitle||"";a.Output.ShowDataAs=a.Output.ShowDataAs||ShowDataAs.Values;a.Output.Orientation=a.Output.Orientation||Orientation.Horizontal;
a.Output.IncludeTrend=a.Output.IncludeTrend||!1;a.Output.TrendPeriod=a.Output.TrendPeriod||TrendPeriod.SinceTheBeginning;a.Output.IncludeSparkline=a.Output.IncludeSparkline||!1;a.Output.IncludeMaxAndMin=a.Output.IncludeMaxAndMin||!1;a.Output.Paging=void 0!=a.Output.Paging?a.Output.Paging:!0;a.Output.PageSize=a.Output.PageSize||20;a.Output.ShowDataLabelsIn=a.Output.ShowDataLabelsIn||ShowDataLabelsIn.Columns;a.Output.TotalForRows=a.Output.TotalForRows||Total.Yes;a.Output.TotalForColumns=a.Output.TotalForColumns||
Total.Yes;a.Output.MapType=a.Output.MapType||MapType.Choropleth;a.Output.Region=a.Output.Region||Region.World;a.Output.Continent=a.Output.Continent||Continent.NorthAmerica;a.Output.Country=a.Output.Country||Country.US;a.OnItemClick=a.OnItemClick||OnItemClick.DoNothing};this.FilterDefaults=function(a,b){this.BasicWidgetDefaults(a,b,WidgetType.Filter);a.Type=a.Type||FilterType.Value;a.Name=a.Name||"";a.NameLowerValue=a.NameLowerValue||"";a.NameUpperValue=a.NameUpperValue||"";a.Visible=void 0!=a.Visible?
a.Visible:!0;a.CaptionClass=a.CaptionClass||"";a.ValueClass=a.ValueClass||"";a.ContainerClass=a.ContainerClass||"";a.FrameClass=a.FrameClass||"";a.FrameTitleClass=a.FrameTitleClass||"";a.FrameBodyClass=a.FrameBodyClass||"";a.Caption=void 0!=a.Caption?qv.util.getTranslation(a.Caption):a.Name;a.Value=a.Value||"";a.LowerValue=a.LowerValue||"";a.UpperValue=a.UpperValue||"";a.Values=a.Values||[];a.MinValue=a.MinValue||"";a.MaxValue=a.MaxValue||"";a.DataType=a.DataType||DataType.Integer;a.Picture=a.Picture||
"";a.Control=a.Control||{};a.Control.Type=a.Control.Type||ControlType.Editbox;a.Control.Dynamic=a.Control.Dynamic||!1;a.Control.DscAttDataType=a.Control.DscAttDataType||DataType.Character;a.Control.Dynamic?a.Control.RefreshValues=a.Control.RefreshValues||!1:(a.Control.Values=a.Control.Values||[],a.Control.Descriptions=a.Control.Descriptions||[]);a.Control.EmptyItem=a.Control.EmptyItem||!1;a.Control.EmptyItemText=void 0!=a.Control.EmptyItemText?qv.util.getTranslation(a.Control.EmptyItemText):gx.getMessage("GX_EmptyItemText");
a.Control.Orientation=a.Control.Orientation||ControlOrientation.Horizontal;a.Control.InviteMessage=void 0!=a.Control.InviteMessage?qv.util.getTranslation(a.Control.InviteMessage):"";a.IsHidden=!1};this.ButtonDefaults=function(a,b){this.BasicWidgetDefaults(a,b,WidgetType.Button);a.Caption=void 0!=a.Caption?qv.util.getTranslation(a.Caption):"";a.Class=a.Class||"";a.ContainerClass=a.ContainerClass||"";a.FrameClass=a.FrameClass||"";a.FrameTitleClass=a.FrameTitleClass||"";a.FrameBodyClass=a.FrameBodyClass||
""};this.ImageDefaults=function(a,b){this.BasicWidgetDefaults(a,b,WidgetType.Image);a.LanguageDependant=a.LanguageDependant||!1;a.ThemeDependant=a.ThemeDependant||!1;a.Sources=JSON.parse(a.Sources||"{}");a.AlternateText=void 0!=a.AlternateText?qv.util.getTranslation(a.AlternateText):"";a.Class=a.Class||"";a.ContainerClass=a.ContainerClass||"";a.FrameClass=a.FrameClass||"";a.FrameTitleClass=a.FrameTitleClass||"";a.FrameBodyClass=a.FrameBodyClass||""};this.TextBlockDefaults=function(a,b){this.BasicWidgetDefaults(a,
b,WidgetType.TextBlock);a.Caption=void 0!=a.Caption?qv.util.getTranslation(a.Caption):"";a.Class=a.Class||"";a.ContainerClass=a.ContainerClass||"";a.FrameClass=a.FrameClass||"";a.FrameTitleClass=a.FrameTitleClass||"";a.FrameBodyClass=a.FrameBodyClass||""};this.WidgetDefaults=function(a,b,c){switch(c){case WidgetType.Object:this.ObjectDefaults(a,b);break;case WidgetType.Filter:this.FilterDefaults(a,b);this.ProcessFilter(a);break;case WidgetType.Image:this.ImageDefaults(a,b);break;case WidgetType.Button:this.ButtonDefaults(a,
b);break;case WidgetType.TextBlock:this.TextBlockDefaults(a,b)}};this.ReplaceVariables=function(a,b){a.VariablesReplaced||(b(this,a),a.VariablesReplaced=!0)};this.ReplaceDashboardParametersInLayout=function(a){this.ReplaceVariables(a,function(a,c){var d=a.DashboardObject,d=d.Variables.ValidParameters.concat(d.Variables.Standard);c.Title=a.ReplaceVariablesValuesInText(c.Title,d);c.RefreshPeriod=a.ReplaceVariableValue(c.RefreshPeriod,[DataType.Integer],!1,d)})};this.ReplaceDashboardParametersInWidget=
function(a){this.ReplaceVariables(a,function(a,c){var d=a.DashboardObject,d=d.Variables.ValidParameters.concat(d.Variables.Standard);c.FrameTitle=a.ReplaceVariablesValuesInText(c.FrameTitle,d);switch(c.WidgetType){case WidgetType.Object:a.ReplaceVariablesInObject(c,d);for(var e=0;e<c.Elements.length;e++)a.ReplaceVariablesInObjectElement(c.Elements[e],d);break;case WidgetType.Filter:a.ReplaceVariablesInFilter(c,d);break;case WidgetType.TextBlock:a.ReplaceVariablesInTextBlock(c,d);break;case WidgetType.Button:a.ReplaceVariablesInButton(c,
d);break;case WidgetType.Image:a.ReplaceVariablesInImage(c,d)}})};this.ReplaceVariablesInObject=function(a,b){switch(a.Output.Type){case OutputType.Chart:a.Output.Title=this.ReplaceVariablesValuesInText(a.Output.Title,b);a.Output.XAxisTitle=this.ReplaceVariablesValuesInText(a.Output.XAxisTitle,b);a.Output.YAxisTitle=this.ReplaceVariablesValuesInText(a.Output.YAxisTitle,b);break;case OutputType.Table:case OutputType.PivotTable:a.Output.PageSize=this.ReplaceVariableValue(a.Output.PageSize,[DataType.Integer],
!1,b)}};this.ReplaceVariablesInObjectElement=function(a,b){if(a.Visible==QueryViewerVisible.Yes||a.Visible==QueryViewerVisible.Always){a.Title=this.ReplaceVariablesValuesInText(a.Title,b);if(a.Type==QueryViewerElementType.Axis&&a.Axis!=QueryViewerAxisType.Pages&&(a.DataType==DataType.Date||a.DataType==DataType.DateTime))if(a.Grouping.GroupByYear&&(a.Grouping.YearTitle=this.ReplaceVariablesValuesInText(a.Grouping.YearTitle,b)),a.Grouping.GroupBySemester&&(a.Grouping.SemesterTitle=this.ReplaceVariablesValuesInText(a.Grouping.SemesterTitle,
b)),a.Grouping.GroupByQuarter&&(a.Grouping.QuarterTitle=this.ReplaceVariablesValuesInText(a.Grouping.QuarterTitle,b)),a.Grouping.GroupByMonth&&(a.Grouping.MonthTitle=this.ReplaceVariablesValuesInText(a.Grouping.MonthTitle,b)),a.Grouping.GroupByDayOfWeek)a.Grouping.DayOfWeekTitle=this.ReplaceVariablesValuesInText(a.Grouping.DayOfWeekTitle,b);a.Type==QueryViewerElementType.Datum&&(a.Format.TargetValue=this.ReplaceVariableValue(a.Format.TargetValue,[DataType.Integer,DataType.Real],!1,b),a.Format.MaximumValue=
this.ReplaceVariableValue(a.Format.MaximumValue,[DataType.Integer,DataType.Real],!1,b));if(a.Type==QueryViewerElementType.Axis&&a.Axis!=QueryViewerAxisType.Pages){var c=[a.DataType];a.DataType==DataType.Real&&c.push(DataType.Integer);a.Filter.Type==QueryViewerFilterType.ShowSomeValues&&(a.Filter.Values=this.ReplaceVariableValue(a.Filter.Values,c,!0,b));a.ExpandCollapse.Type==QueryViewerExpandCollapseType.ExpandSomeValues&&(a.ExpandCollapse.Values=this.ReplaceVariableValue(a.ExpandCollapse.Values,
c,!0,b));a.AxisOrder.Type==QueryViewerAxisOrderType.Custom&&(a.AxisOrder.Values=this.ReplaceVariableValue(a.AxisOrder.Values,c,!0,b))}}};this.ReplaceVariablesInFilter=function(a,b){a.Caption=this.ReplaceVariablesValuesInText(a.Caption,b);a.Control.Type==ControlType.Editbox&&(a.Control.InviteMessage=this.ReplaceVariablesValuesInText(a.Control.InviteMessage,b))};this.ReplaceVariablesInFilterOnlyParameters=function(a,b){a.Type!=FilterType.Collection?(a.Type==FilterType.Value?this.ReplaceVariableValueInFilter(a.Value,
"Value","SerializedValue",a,b):(this.ReplaceVariableValueInFilter(a.LowerValue,"LowerValue","SerializedLowerValue",a,b),this.ReplaceVariableValueInFilter(a.UpperValue,"UpperValue","SerializedUpperValue",a,b)),this.ReplaceVariableValueInFilter(a.MinValue,"MinValue","",a,b),this.ReplaceVariableValueInFilter(a.MaxValue,"MaxValue","",a,b)):this.ReplaceVariableValueInFilter(a.Values,"Values","SerializedValue",a,b)};this.ReplaceVariablesInButton=function(a,b){a.Caption=this.ReplaceVariablesValuesInText(a.Caption,
b)};this.ReplaceVariablesInImage=function(a,b){a.AlternateText=this.ReplaceVariablesValuesInText(a.AlternateText,b)};this.ReplaceVariablesInTextBlock=function(a,b){a.Caption=this.ReplaceVariablesValuesInText(a.Caption,b)};this.GetQueryViewerElementId=function(a){return this.editor.GetDOMElementId(a)+"_QueryViewer"};this.GetRangeElementId=function(a){return this.editor.GetDOMElementId(a)+"_Range"};this.IsMainTable=function(a){return a.ElementId==MAIN_TABLE_ID||a.ElementId==FILTERS_TABLE_ID};this.IsMainTableLayoutTable=
function(a){return this.IsMainTable(a)?!1:this.DashboardObject.Layout.MainTableLayout!=MainTableLayout.Free&&a.ParentElement.ParentElement.ParentElement.ElementId==MAIN_TABLE_ID};this.IsHeight100Percent=function(a,b,c){if(c.ElementId==MAIN_TABLE_ID)switch(a){case MainTableLayout.TwoColumns:case MainTableLayout.ThreeColumns:return!0;case MainTableLayout.HeaderTwoColumns:case MainTableLayout.HeaderThreeColumns:case MainTableLayout.HeaderTwoColumnsFooter:case MainTableLayout.HeaderThreeColumnsFooter:return 1==
b;default:return b==c.Rows.length-1}else return b==c.Rows.length-1};this.GetPictureProperties=function(a,b){return a==DataType.Integer||a==DataType.Real?qv.util.ParseNumericPicture(a==DataType.Integer?"integer":"",b):a==DataType.Date||a==DataType.DateTime?qv.util.ParseDateTimePicture(a==DataType.DateTime?"datetime":"",b):null};this.MakeFilterItem=function(a,b){var c={};c.Name=a;c.Values=[];if(null!=b)switch(b.Type){case FilterType.Value:c.Values.push(b.SerializedValue);break;case FilterType.Range:b.NameLowerValue==
a?c.Values.push(b.SerializedLowerValue):c.Values.push(b.SerializedUpperValue);break;case FilterType.Collection:for(var d=0;d<b.Values.length;d++)c.Values.push(this.ValueToString(b.Values[d],b.DataType,b.Picture,b.PictureProperties))}return c};this.LoadOtherFilterValues=function(a){a.AllFilters=[];for(var b=this.DashboardObject,c=0;c<b.Filters.length;c++){var d=b.Filters[c];d.Type!=FilterType.Range?a.AllFilters.push(this.MakeFilterItem(d.Name,d)):(a.AllFilters.push(this.MakeFilterItem(d.NameLowerValue,
d)),a.AllFilters.push(this.MakeFilterItem(d.NameUpperValue,d)))}};this.LoadFiltersChangedData=function(a){this.FiltersChangedData={};this.FiltersChangedData.ChangedFilters=[];for(var b=0;b<a.length;b++){var c=this.GetFilterByAnyName(a[b]),d=this.MakeFilterItem(a[b],c);d.Enabled=null!=c;this.FiltersChangedData.ChangedFilters.push(d)}this.LoadOtherFilterValues(this.FiltersChangedData)};this.LoadItemClickData=function(a,b){this.ItemClickData={};this.ItemClickData.Object=a.Name;this.ItemClickData.Element=
b.ItemClickData.Name;this.ItemClickData.Value=b.ItemClickData.Value;this.ItemClickData.Context=JSON.parse(JSON.stringify(b.ItemClickData.Context));this.LoadOtherFilterValues(this.ItemClickData)};this.LoadValuesHighlightedData=function(a){this.ValuesHighlightedData={};this.ValuesHighlightedData.Elements=a;this.LoadOtherFilterValues(this.ValuesHighlightedData)};this.RefreshDashboard=function(a){a&&this.FiltersChanged&&(this.LoadFiltersChangedData(a),this.FiltersChanged());var b=this.DashboardObject;
this.UpdateFilterVariables(b,a);for(var c=0;c<b.AllWidgets.length;c++)this.RefreshElementIfNeeded(b.AllWidgets[c],a);this.RefreshElementIfNeeded(b.Layout,a)};this.CaseInsensitiveIndexOf=function(a,b){for(var c=0;c<a.length;c++)if(a[c].toLowerCase()==b.toLowerCase())return c;return-1};this.RefreshElementIfNeeded=function(a,b){var c;a:if(b){for(c=0;c<b.length;c++)if(0<=this.CaseInsensitiveIndexOf(a.Parameters,b[c])){c=!0;break a}c=!1}else c=!0;c&&(a.ElementType==ElementType.Layout?this.RefreshLayout():
a.ElementType==ElementType.Widget&&(a.WidgetType==WidgetType.Filter&&a.Control.Dynamic&&(a.Control.RefreshValues=!0),this.RefreshWidget(a)))};this.GetThemeStyleSheet=function(){if(!this._themeStyleSheet){for(var a=gx.theme+".css",b,c=0;c<document.styleSheets.length;c++)if(null!=document.styleSheets[c].href&&0<=document.styleSheets[c].href.indexOf(a)){b=document.styleSheets[c];break}this._themeStyleSheet=b}return this._themeStyleSheet};this.InsertCssRules=function(a){for(var b=this.GetThemeStyleSheet(),
a=a.split("}"),c=0;c<a.length;c++)""!=a[c]&&b.insertRule(a[c]+"}")};this.UpdateElement=function(a,b,c){switch(c){case ElementType.Table:this.UpdateTable(a,b);break;case ElementType.Row:this.UpdateRow(a,b,!1);break;case ElementType.Cell:this.UpdateCell(a,b);break;case ElementType.Widget:this.UpdateWidget(a,b)}this.editor.UpdateSelectedElementPath(a)};this.UpdateCell=function(a,b){var c=this.DashboardObject,d=this.GetElementContainer(a.ElementId);this.CellDefaults(b);if(!b.IsEmpty||a.IsEmpty)if(!b.IsEmpty&&
a.IsEmpty){var e=b[b.ChildType];this.editor.ParentInitialize(e,a);b.HasTable?this.editor.TableDefaults(e,c,""):(this.editor.WidgetDefaults(e,c,b.ChildType),this.editor.AddElement(c,e));var f=e,g=b.ChildType;a.ChildType=g;a[g]=f;a.IsEmpty=!1;var g=document.createElement("DIV"),h=[],e=e.ElementType==ElementType.Table?this.editor.GetTableHTML(c,f,!0,h,!1):this.editor.GetWidgetHTML(c,a.ParentElement.ParentElement,a,f,h);this.RemoveDomElements(h);g.innerHTML=e;e=this.GetElementContainer(a.ElementId);e.childNodes[0]&&
e.removeChild(e.childNodes[0]);e.appendChild(g.firstChild);e.classList.remove("gx-db-cell-empty")}else!a.IsEmpty&&!b.IsEmpty&&(g=a[a.ChildType],e=b[b.ChildType],a.HasTable?this.UpdateTable(g,e):this.UpdateWidget(g,e));a.CellClass!=b.CellClass&&(a.CellClass=b.CellClass,this.UpdateDOMElementClass(d,b.CellClass,"gx-db-cell"))};this.UpdateRow=function(a,b,c){function d(a,b,c,d,e,g){var s=a.GetElementContainer(e.ElementId);d.id==s.parentNode.id&&d.removeChild(s);c.Cells.splice(g,1);a.editor.RemoveElement(b,
e);e.IsEmpty||(c=e[e.ChildType],a.editor.SelectedElementIds.splice(a.editor.SelectedElementIds.indexOf(c.ElementId),1),a.editor.RemoveElement(b,c))}function e(a,b,c,d,e,g){var s;g<c.Cells.length&&(s=a.GetElementContainer(c.Cells[g].ElementId));c.Cells.splice(g,0,e);var f=document.createElement("DIV"),h=[],b=a.editor.GetCellHTML(b,c.ParentElement,c,d,e,g,"",h);a.RemoveDomElements(h);f.innerHTML=b;a=a.GetElementContainer(c.ElementId);s?a.insertBefore(f.firstChild,s):a.appendChild(f.firstChild)}function f(a,
b,c,d,e){var g=a.GetElementContainer(b.Cells[r].ElementId),a=a.GetElementContainer(b.Cells[k].ElementId);b.Cells.splice(e,0,b.Cells.splice(d,1)[0]);c.insertBefore(g,a)}function g(a,b,c,d,e){var g=c.Cells[e],b=a.editor.CellClass2(b,c,d,g,e);a.GetElementContainer(g.ElementId).className=b}function h(a,b){var c=a.Cells[b];if(!c.IsEmpty&&(c=c[c.ChildType],c.WidgetType==WidgetType.Object&&c.Output.Type==OutputType.Chart&&(c=c.QueryViewer)))c.ForceChartRendering=!0,code="try { qv.chart.checkChartSize("+
c.me()+") } catch (e) {}",c.IntervalCheckChartSize=setInterval(code,0)}var j=this.DashboardObject,l=a.Cells.length!=b.Cells.length,m=this.GetElementContainer(a.ElementId);this.RowDefaults(b);for(var o=[],k=a.Cells.length-1;0<=k;k--){var q=a.Cells[k];0>this.GetCellIndex(b,q.ElementId)&&d(this,j,a,m,q,k)}q=this.GetRowIndex(a.ParentElement,a.ElementId);for(k=0;k<b.Cells.length;k++){var p=b.Cells[k],r=this.GetCellIndex(a,p.ElementId);0>r&&!p.IsEmpty&&(o.push(p.ElementId),this.editor.ParentInitialize(p,
a),this.editor.CellDefaults(p,j),e(this,j,a,q,p,k))}for(k=0;k<a.Cells.length;k++)p=b.Cells[k],r=this.GetCellIndex(a,b.Cells[k].ElementId),r!=k&&f(this,a,m,r,k);for(k=0;k<b.Cells.length;k++)0>o.indexOf(a.Cells[k].ElementId)&&this.UpdateCell(a.Cells[k],b.Cells[k]);if(l||c)for(k=0;k<a.Cells.length;k++)g(this,a.ParentElement,a,q,k);if(l)for(k=0;k<a.Cells.length;k++)h(a,k);a.RowClass!=b.RowClass&&(a.RowClass=b.RowClass,this.UpdateDOMElementClass(m,b.RowClass,"gx-db-row"))};this.UpdateTable=function(a,
b){function c(a,b,c,d,e,g){var f=a.GetElementContainer(e.ElementId);(d.id=f.parentNode.id)&&d.removeChild(f);c.Rows.splice(g,1);for(c=0;c<e.Cells.length;c++)d=e.Cells[c],a.editor.RemoveElement(b,d),d.IsEmpty||a.editor.RemoveElement(b,d[d.ChildType]);a.editor.RemoveElement(b,e)}function d(a,b,c,d,e){var g;e<c.Rows.length&&(g=a.GetElementContainer(c.Rows[e].ElementId));c.Rows.splice(e,0,d);var f=document.createElement("DIV"),h=[],b=a.editor.GetRowHTML(b,c,d,e,h);a.RemoveDomElements(h);f.innerHTML=b;
a=a.GetElementContainer(c.ElementId);g?a.insertBefore(f.firstChild,g):a.appendChild(f.firstChild)}var e=this.DashboardObject,f=!1,g=this.GetElementContainer(a.ElementId);this.TableDefaults(b);for(var h=[],j=a.ElementId==MAIN_TABLE_ID||a.ElementId==FILTERS_TABLE_ID||this.IsMainTableLayoutTable(a)?a.Rows.length-2:a.Rows.length-1;0<=j;j--){var l=a.Rows[j];0>this.GetRowIndex(b,l.ElementId)&&(f=!0,c(this,e,a,g,l,j))}for(j=0;j<b.Rows.length;j++)l=b.Rows[j],0>this.GetRowIndex(a,l.ElementId)&&(h.push(l.ElementId),
f=!0,this.editor.ParentInitialize(l,a),this.editor.RowDefaults(l,e),d(this,e,a,l,j));0==a.Rows.length&&(l={ElementId:a.ElementId+"_NEWROW",Cells:[{ElementId:a.ElementId+"_NEWROW_NEWCELL",IsEmpty:!0}]},this.editor.ParentInitialize(l,a),this.editor.RowDefaults(l,e),d(this,e,a,l,0));for(j=0;j<b.Rows.length;j++)0>h.indexOf(a.Rows[j].ElementId)&&this.UpdateRow(a.Rows[j],b.Rows[j],f);a.Class!=b.Class&&(a.Class=b.Class,this.UpdateDOMElementClass(g,b.Class,"gx-db-table"))};this.UpdateWidget=function(a,b){var c=
this.DashboardObject,d=this.GetElementContainer(a.ElementId);this.WidgetDefaults(b,c,a.WidgetType);c=a.ContainerClass!=b.ContainerClass;this.CopyObjectProperties(b,a);this.RefreshWidget(a);c&&this.UpdateDOMElementClass(d,a.ContainerClass,"gx-db-widget")};this.CopyObjectProperties=function(a,b){for(var c in a)"Selected"!=c&&(b[c]instanceof Object&&!(b[c]instanceof Array)&&!(b[c]instanceof gx.date.gxdate)&&"ParentElement"!=c?this.CopyObjectProperties(a[c],b[c]):b[c]=a[c])};this.GetRowIndex=function(a,
b){for(var c=0;c<a.Rows.length;c++)if(a.Rows[c].ElementId==b)return c;return-1};this.GetCellIndex=function(a,b){for(var c=0;c<a.Cells.length;c++)if(a.Cells[c].ElementId==b)return c;return-1};this.GetElementContainer=function(a){a=this.editor.GetDOMElementId(a);return document.getElementById(a)};this.RemoveDomElements=function(a){for(var b=0;b<a.length;b++){var c=document.getElementById(a[b]);null!=c&&c.parentNode.removeChild(c)}};this.OnAddElement=function(a,b){switch(b.WidgetType){case WidgetType.Object:a.Objects.push(b);
break;case WidgetType.Filter:a.Filters.push(b);break;case WidgetType.Button:a.Buttons.push(b);break;case WidgetType.Image:a.Images.push(b);break;case WidgetType.TextBlock:a.TextBlocks.push(b)}};this.OnRemoveElement=function(a,b){switch(b.WidgetType){case WidgetType.Object:this.editor.RemoveElementById(a.Objects,b.ElementId);break;case WidgetType.Filter:this.editor.RemoveElementById(a.Filters,b.ElementId);break;case WidgetType.Button:this.editor.RemoveElementById(a.Buttons,b.ElementId);break;case WidgetType.Image:this.editor.RemoveElementById(a.Images,
b.ElementId);break;case WidgetType.TextBlock:this.editor.RemoveElementById(a.TextBlocks,b.ElementId)}};this.ValuesIndexOf=function(a,b,c){if((c==DataType.Date||c==DataType.DateTime)&&b instanceof gx.date.gxdate){c=!1;for(i=0;i<a.length;i++)if(0==b.compare(a[i])){c=!0;break}return c?i:-1}return a.indexOf(b)};this.SameValue=function(a,b,c){return c==DataType.Date||c==DataType.DateTime?0==a.compare(b):a===b};this.CompareValues=function(a,b,c){return c==DataType.Date||c==DataType.DateTime?a.compare(b):
a===b?0:a<b?-1:1};this.ParseValue=function(a,b,c){return this.ParseValueMain(a,b,c,!1)};this.ParseInternalValue=function(a,b,c){return this.ParseValueMain(a,b,c,!0)};this.ParseValueMain=function(a,b,c,d){var e,f;if(c)try{var g=JSON.parse(a);e=[];f=!0;for(d=0;d<g.length;d++){var h=this.ParseValueMain(g[d],b,!1,!0);h.Success&&e.push(h.ParsedValue)}}catch(j){f=!1}else switch(b){case DataType.Integer:e=parseInt(a);f=!isNaN(e);break;case DataType.Real:e=parseFloat(a);f=!isNaN(e);break;case DataType.Character:e=
a.toString();f=!0;break;case DataType.Boolean:e="true"==a.toString().toLowerCase();f=!0;break;case DataType.Date:case DataType.DateTime:e=d?new gx.date.gxdate(a,"Y4MD"):new gx.date.gxdate(a);f=!0;break;case DataType.GUID:e=36>=a.length?a:a.substr(0,36);e=e.toLowerCase().replace(/-/g,"");e=e.replace(/([0-f]{8})([0-f]{4})([0-f]{4})([0-f]{4})([0-f]{12})/,"$1-$2-$3-$4-$5");f=/([0-f]{8})-([0-f]{4})-([0-f]{4})-([0-f]{4})-([0-f]{12})/.test(e);break;case DataType.GeoPoint:""==qv.util.trim(a)?(f=!0,e=""):
(f=qv.util.trim(a.toUpperCase().replace("POINT","").replace("(","").replace(")","")).split(" "),2==f.length?(b=this.ParseValueMain(f[0],DataType.Real,!1,d),b.Success?(d=this.ParseValueMain(f[1],DataType.Real,!1,d),d.Success?-90<=b.ParsedValue&&90>=b.ParsedValue&&-180<=d.ParsedValue&&180>=d.ParsedValue?(f=!0,e="POINT ("+b.ParsedValue+" "+d.ParsedValue+")"):f=!1:f=!1):f=!1):f=!1);break;default:f=!1}return{Success:f,ParsedValue:e}};this.ValueToString=function(a,b,c,d){return this.ValueToStringMain(a,
b,c,d,!1)};this.ValueToInternalString=function(a,b,c,d){return this.ValueToStringMain(a,b,c,d,!0)};this.ValueToStringMain=function(a,b,c,d,e){if(null==a)return"";switch(b){case DataType.Integer:case DataType.Real:return gx.num.formatNumber(a,d.DecimalPrecision,c,0,!0,!1);case DataType.Character:return"@!"==c?a.toUpperCase():a;case DataType.Date:case DataType.DateTime:e?(c=a.getStringWithFmt("Y4MD"),c=c==a.emptyDateString("Y4MD")?"0000-00-00":c.replace(/\//g,"-")):c=a.getStringWithFmt(d.DateFormat);
if(b==DataType.DateTime){b=a.TimeFmt;e&&(a.TimeFmt=24);var f=e||d.IncludeHours,g=e||d.IncludeMinutes,d=e||d.IncludeSeconds,d=f?a.getTimeString(g,d,f):"";"::"==d&&(d="00:00:00");""!=d&&(c+=" "+d);e&&(a.TimeFmt=b)}return c;case DataType.GUID:return a;case DataType.GeoPoint:return a;default:return a.toString()}};this.ValuesToString=function(a,b,c,d){if(b==DataType.Date||b==DataType.DateTime){for(var e=[],f=0;f<a.length;f++){var g=this.ValueToInternalString(a[f],b,c,d);e.push(g)}return JSON.stringify(e)}return JSON.stringify(a)};
this.DefaultPicture=function(a){switch(a){case DataType.Integer:return"ZZZZZZZZZZZZZZ9";case DataType.Real:return"ZZZZZZZZZZZZZZ9.99";case DataType.Date:return"99/99/9999";case DataType.DateTime:return"99/99/9999 99:99:99";case DataType.GUID:return"XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX";default:return""}};this.ProcessFilter=function(a){function b(a,b,c,d){return a.CheckVariable(b,[c],d==FilterType.Collection,a.DashboardObject.Variables.AllParameters.concat(a.DashboardObject.Variables.Standard))}function c(a,
b,d,h,j){if(""==b&&j)return null;b=""==b?a.GetEmptyValueStr(d,h==FilterType.Collection):b;b=a.ParseInternalValue(b,d,h==FilterType.Collection);if(b.Success)return b.ParsedValue;if(j)return null;j=a.GetEmptyValueStr(d,h==FilterType.Collection);return c(a,j,d,h,!1)}""==a.Picture&&(a.Picture=this.DefaultPicture(a.DataType));var d=this.GetPictureProperties(a.DataType,a.Picture);null!=d&&(a.PictureProperties=d);if(a.Type!=FilterType.Collection){if(a.Type==FilterType.Value?(d=b(this,a.Value,a.DataType,
a.Type),d.IsVariable?a.SerializedValue=d.SerializedValue:(a.Value=c(this,a.Value,a.DataType,a.Type,!1),a.SerializedValue=this.ValueToString(a.Value,a.DataType,a.Picture,a.PictureProperties))):(d=b(this,a.LowerValue,a.DataType,a.Type),d.IsVariable?a.SerializedLowerValue=d.SerializedValue:(a.LowerValue=c(this,a.LowerValue,a.DataType,a.Type,!1),a.SerializedLowerValue=this.ValueToString(a.LowerValue,a.DataType,a.Picture,a.PictureProperties)),d=b(this,a.UpperValue,a.DataType,a.Type),d.IsVariable)?a.SerializedUpperValue=
d.SerializedValue:(a.UpperValue=c(this,a.UpperValue,a.DataType,a.Type,!1),a.SerializedUpperValue=this.ValueToString(a.UpperValue,a.DataType,a.Picture,a.PictureProperties)),d=b(this,a.MinValue,a.DataType,a.Type),d.IsVariable||(a.MinValue=c(this,a.MinValue,a.DataType,a.Type,!0)),d=b(this,a.MaxValue,a.DataType,a.Type),!d.IsVariable)a.MaxValue=c(this,a.MaxValue,a.DataType,a.Type,!0)}else if(d=b(this,a.Values,a.DataType,a.Type),d.IsVariable)a.SerializedValue=d.SerializedValue;else{for(d=0;d<a.Values.length;d++)a.Values[d]=
c(this,a.Values[d],a.DataType,FilterType.Value,!1);a.SerializedValue=this.ValuesToString(a.Values,a.DataType,a.Picture,a.PictureProperties)}if(!a.Control.Dynamic&&(a.Control.Type==ControlType.Checkbox||a.Control.Type==ControlType.ComboBox||a.Control.Type==ControlType.RadioButton||a.Control.Type==ControlType.DropDownList))if(a.DataType==DataType.Boolean)a.Control.Values=[!0,!1],a.Control.Descriptions=["true","false"];else for(d=0;d<a.Control.Values.length;d++)a.Control.Values[d]=c(this,a.Control.Values[d],
a.DataType,!1,!1),a.Control.Descriptions[d]=c(this,qv.util.getTranslation(a.Control.Descriptions[d]),DataType.Character,!1,!1)};this.RenderDashboard=function(){qv.util.SetUserControlClass(this,"gx-db"+(""!=this.Class?" ":"")+this.Class);this.InsertCssRules(this.CSSRules);var a=this.DashboardObject,b="";a.Layout&&(b=this.GetLayoutHTML(a),b=this.IsDashboardEdit()?this.TwoRowsTableHTML(null,"","100%","100%",this.editor.GetElementSelectorHTML(a.Layout),b):b,b+='<div id ="gx-dashboard-error-placeholder" class="gx-db-error" style="position:fixed;z-index:100;display:none"></div>',
this.IsDashboardEdit()&&(b+='<div id ="gx-dashboard-references-placeholder" style="position:fixed;z-index:100;display:none"></div>'));this.setHtml(b)};this.UpdateDOMElementClass=function(a,b,c){for(var d=a.classList.length-1;0<=d;d--){var e=a.classList.item(d);(e==c||!qv.util.startsWith(e,"gx-db-"))&&a.classList.remove(e)}a.classList.add(""==b?c:b)};this.RefreshLayout=function(){var a=this.DashboardObject,b=a.Variables.Filters,c=document.getElementById("gx-db-title-text");null!=c&&(c.innerText=this.ReplaceVariablesValuesInText(a.Layout.Title,
b));this.SetRefreshPeriod(this,this.ReplaceVariableValue(a.Layout.RefreshPeriod,[DataType.Integer,DataType.Real],!1,b))};this.RefreshWidget=function(a){if(a.WidgetType==WidgetType.Filter&&a.Control.Type==ControlType.Editbox&&(a.DataType==DataType.Date||a.DataType==DataType.DateTime)){var b=n("#"+this.GetRangeElementId(a.ElementId)).data("daterangepicker");null!=b&&b.hide()}var b=this.GetElementContainer(a.ElementId),c=this.editor.GetWidgetContentHTML(this.DashboardObject,a,null);a.WidgetType!=WidgetType.Object&&
(b.innerHTML=c)};this.SerializeParameterValue=function(a){a.SerializedValue=this.IsDashboardEdit()?"&"+a.Name:a.Type==ParameterType.Value?this.ValueToString(a.Value,a.DataType,a.Picture,a.PictureProperties):this.ValuesToString(a.Value,a.DataType,a.Picture,a.PictureProperties)};this.MakeVariable=function(a,b,c,d,e){return{Name:a,Value:b,SerializedValue:c,DataType:d,IsCollection:e}};this.LoadParameterVariables=function(a){a.Variables={};a.Variables.Standard=function(a){var c=[];c.push(function(a){var b=
gx.date.today(),c=DataType.Date,g=qv.util.ParseDateTimePicture("","99/99/9999"),g=a.IsDashboardEdit()?"&Today":a.ValueToString(b,c,"99/99/9999",g);return a.MakeVariable("Today",b,g,c,!1)}(a));c.push(function(a){var b=gx.date.today();b.HasTimePart=!0;var b=b.getTimeString(!0,!0,!0),c=a.IsDashboardEdit()?"&Time":b;return a.MakeVariable("Time",b,c,DataType.Character,!1)}(a));c.push(function(a){var b=a.DashboardObject.Name,c=a.IsDashboardEdit()?"&Pgmname":b;return a.MakeVariable("Pgmname",b,c,DataType.Character,
!1)}(a));c.push(function(a){var b=a.DashboardObject.Description,c=a.IsDashboardEdit()?"&Pgmdesc":b;return a.MakeVariable("Pgmdesc",b,c,DataType.Character,!1)}(a));return c}(this);a.Variables.AllParameters=this.ParametersToVariables(a.Parameters)};this.LoadFilterVariables=function(a){a.Variables.ValidParameters=this.ParametersToVariables(this.ValidParameters());for(var b=0;b<a.Filters.length;b++){var c=a.Filters[b];this.IsDashboardEdit()||this.ReplaceVariablesInFilterOnlyParameters(c,a.Variables.AllParameters.concat(a.Variables.Standard))}a.Variables.Filters=
this.FiltersToVariables(a.Filters)};this.UpdateParameterVariables=function(a){a.Variables.AllParameters=this.ParametersToVariables(a.Parameters);a.Variables.ValidParameters=this.ParametersToVariables(this.ValidParameters())};this.UpdateFilterVariables=function(a,b){function c(a,b,c){for(var d=!1,e={},g=0;g<b.Filters.length;g++){filter=b.Filters[g];switch(filter.Type){case FilterType.Value:filter.Name.toLowerCase()==c.toLowerCase()&&(d=!0,e=a.MakeVariable(filter.Name,filter.Value,filter.SerializedValue,
filter.DataType,!1));break;case FilterType.Range:filter.NameLowerValue.toLowerCase()==c.toLowerCase()?(d=!0,e=a.MakeVariable(filter.NameLowerValue,filter.LowerValue,filter.SerializedLowerValue,filter.DataType,!1)):filter.NameUpperValue.toLowerCase()==c.toLowerCase()&&(d=!0,e=a.MakeVariable(filter.NameUpperValue,filter.UpperValue,filter.SerializedUpperValue,filter.DataType,!1));break;case FilterType.Collection:filter.Name.toLowerCase()==c.toLowerCase()&&(d=!0,e=a.MakeVariable(filter.Name,filter.Values,
filter.SerializedValue,filter.DataType,!0))}if(d)break}return{Found:d,Variable:e}}function d(a,b){for(var c=0;c<a.length;c++)if(a[c].Name.toLowerCase()==b.toLowerCase())return c;return-1}if(b)for(var e=0;e<b.length;e++){var f=d(a.Variables.Filters,b[e]),g=c(this,a,b[e]),h=g.Found,g=g.Variable;!h&&0<=f?a.Variables.Filters.splice(f,1):h&&0>f?a.Variables.Filters.push(g):h&&0<=f&&(a.Variables.Filters[f]=g)}else a.Variables.Filters=this.FiltersToVariables(a.Filters)};this.FiltersToVariables=function(a){for(var b=
[],c=0;c<a.length;c++){var d=a[c];switch(d.Type){case FilterType.Value:b.push(this.MakeVariable(d.Name,d.Value,d.SerializedValue,d.DataType,!1));break;case FilterType.Range:b.push(this.MakeVariable(d.NameLowerValue,d.LowerValue,d.SerializedLowerValue,d.DataType,!1));b.push(this.MakeVariable(d.NameUpperValue,d.UpperValue,d.SerializedUpperValue,d.DataType,!1));break;case FilterType.Collection:b.push(this.MakeVariable(d.Name,d.Values,d.SerializedValue,d.DataType,!0))}}return b};this.ParametersToVariables=
function(a){for(var b=[],c=0;c<a.length;c++){var d=a[c];b.push(this.MakeVariable(d.Name,d.Value,d.SerializedValue,d.DataType,d.Type==ParameterType.Collection))}return b};this.ReplaceVariablesValuesInText=function(a,b){return 0<=a.indexOf("&")?this.ReplaceValuesInTextMain(b,a):a};this.ReplaceValuesInTextMain=function(a,b){function c(a,b,c,d){if(0<=a.indexOf("&"))for(var e=!1,f=-1;!e;)if(f=a.toLowerCase().indexOf("&"+b.toLowerCase(),f+1),0<=f){var k=a.substr(f+b.length+1,1);"a"<=k&&"z">=k||("A"<=k&&
"Z">=k||"0"<=k&&"9">=k||"_"==k)||d.push({Pos:f,Name:b,SerializedValue:c})}else e=!0}for(var d=[],e=0;e<a.length;e++){var f=a[e];c(b,f.Name,f.SerializedValue,d)}d.sort(function(a,b){return a.Pos<b.Pos?-1:a.Pos>b.Pos?1:0});f=b;for(e=d.length-1;0<=e;e--)f=f.substr(0,d[e].Pos)+d[e].SerializedValue+f.substr(d[e].Pos+d[e].Name.length+1);return f};this.ReplaceVariableValue=function(a,b,c,d){b=this.CheckVariable(a,b,c,d);return b.IsVariable?b.Value:a};this.ReplaceVariableValueInFilter=function(a,b,c,d,e){a=
this.CheckVariable(a,[d.DataType],d.Type==FilterType.Collection,e);a.IsVariable&&(d[b]=a.Value,c&&(d[c]=a.SerializedValue))};this.CheckVariable=function(a,b,c,d){var e=!1,f="",g=null,h=null;if("string"===typeof a&&a.startsWith("&"))for(var a=a.substr(1,a.length-1).toLowerCase(),j=0;j<d.length;j++){var l=d[j];if(l.Name.toLowerCase()==a&&0<=b.indexOf(l.DataType)&&l.IsCollection==c){e=!0;f="&"+l.Name;g=l.Value;h=l.SerializedValue;break}}return{IsVariable:e,Name:f,Value:g,SerializedValue:h}};this.CheckVariableInEditMode=
function(a,b,c){if(this.IsDashboardEdit()){var d=this.DashboardObject,e=[b];b==DataType.Real&&e.push(DataType.Integer);a=this.CheckVariable(a,e,c,d.Variables.AllParameters.concat(d.Variables.Standard))}else a={IsVariable:!1};return a};this.ResolveVariable=function(a,b,c){var d;null!=a?(d=this.CheckVariableInEditMode(a,b,c),a=d.IsVariable?this.GetEmptyValue(b,c):a,d=d.IsVariable):d=!1;return{Value:a,WasVariable:d}};this.ResolveVariableValue=function(a,b,c){return this.ResolveVariable(a,b,c).Value};
this.ValidParameters=function(){if(!this._ValidParametersCalculated){var a=this.DashboardObject;this._ValidParameters=[];for(var b=0;b<a.Parameters.length;b++){var c=a.Parameters[b],d;a:{d=a;for(var e=c.Name,f=0;f<d.Filters.length;f++){var g=d.Filters[f];if(!g.IsHidden){var h=g.Type==FilterType.Range;if(!h&&g.Name.toLowerCase()==e.toLowerCase()||h&&(g.NameLowerValue.toLowerCase()==e.toLowerCase()||g.NameUpperValue.toLowerCase()==e.toLowerCase())){d=!0;break a}}}d=!1}!d&&null==this.GetObjectElementForFilter(c.Name)&&
this._ValidParameters.push(c)}this._ValidParametersCalculated=!0}return this._ValidParameters};this.GetElementReferences=function(a){function b(a,b){for(var c="",d=0;d<a.Filters.length;d++){var e=a.Filters[d];if(!e.IsHidden)if(e.Type==FilterType.Range)if(e.NameLowerValue.toLowerCase()==b.toLowerCase()){c=e.NameLowerValue;break}else{if(e.NameUpperValue.toLowerCase()==b.toLowerCase()){c=e.NameUpperValue;break}}else if(e.Name.toLowerCase()==b.toLowerCase()){c=e.Name;break}}return c}function c(a,b){var c=
a.GetObjectElementForFilter(b);return null==c?"":c.Element.Name}function d(a,b){for(var c="",d=0;d<a.Parameters.length;d++){var e=a.Parameters[d];if(e.Name.toLowerCase()==b.toLowerCase()){c=e.Name;break}}return c}for(var e=this.DashboardObject,f="",g="",h="",j="",l="",m=0;m<a.Parameters.length;m++){var o=a.Parameters[m],k=b(e,o);""!=k?g+=(""==g?"":", ")+k:(k=c(this,o),""!=k?h+=(""==h?"":", ")+k:(k=d(e,o),""!=k?j+=(""==j?"":", ")+k:l+=(""==l?"":", ")+o))}if(""!=g||""!=j||""!=h)f+='<span class="gx-db-dependencies-title">'+
gx.getMessage("GX_Dashboard_DependsOn")+":</span>",""!=g&&(f+='<br><span class="gx-db-dependencies-subtitle">'+gx.getMessage("GX_Dashboard_Filters")+":</span>&nbsp"+g),""!=h&&(f+='<br><span class="gx-db-dependencies-subtitle">'+gx.getMessage("GX_Dashboard_ObjectElements")+":</span>&nbsp"+h),""!=j&&(f+='<br><span class="gx-db-dependencies-subtitle">'+gx.getMessage("GX_Dashboard_Parameters")+":</span>&nbsp"+j);""!=l&&(""!=f&&(f+="<br>"),f+='<span class="gx-db-not-resolved-dependencies-title">'+gx.getMessage("GX_Dashboard_UnknownValues")+
":</span><br>"+l);h=g="";if(a.ElementType==ElementType.Widget&&(a.WidgetType==WidgetType.Filter&&!a.IsHidden||a.WidgetType==WidgetType.Object&&a.OnItemClick==OnItemClick.ApplyFilters)){for(m=0;m<e.AllElements.length;m++)if(j=e.AllElements[m],a!=j&&(j.ElementType==ElementType.Widget||j.ElementType==ElementType.Layout)){var q;a.WidgetType==WidgetType.Filter?q=this.IsFilterRelated(j,a):a.WidgetType==WidgetType.Object&&(q=this.IsObjectRelated(j,a));q&&(h+=(""==h?"":", ")+(j.ElementType==ElementType.Layout?
j.ElementType:j.ControlName))}""!=h&&(g+='<span class="gx-db-impact-title">'+gx.getMessage("GX_Dashboard_ImpactedElements")+":</span><br>"+h)}return{DependenciesHTML:f,ImpactHTML:g}};this.GetWidget=function(a){for(var b=this.DashboardObject,c=0;c<b.AllWidgets.length;c++)if(widget=b.AllWidgets[c],widget.ElementId==a)return widget;return null};this.OldRadioButton=function(){return 0>gx.plugdesign.definition.templates.indexOf("radio-button")};this.TwoRowsTableHTML=function(a,b,c,d,e,f){return this.editor.TwoRowsTableHTML(a,
b,c,d,e,f)};this.TwoCellsTableHTML=function(a,b,c,d,e,f,g){var h=this.editor.TableClass(null==a,!1,""),j=this.editor.RowClass(""),l;this.IsDashboardEdit()?(l="gx-db-flex-cell gx-db-flex-cell-3"+(g?" gx-db-flex-cell-order-2":""),g="gx-db-flex-cell gx-db-flex-cell-9"+(g?" gx-db-flex-cell-order-1":"")):(l="col-xs-12 col-sm-3"+(g?" col-sm-push-9":""),g="col-xs-12 col-sm-9"+(g?" col-sm-pull-3":""));l=this.editor.CellClass(l,!1,!1,"");g=this.editor.CellClass(g,!1,!1,"");a=this.editor.DIVStart(a,b,h,"height:"+
c+";width:"+d,!1,!0,!1);return a+('<div class="'+j+'" style="height:100%">')+('<div class="'+l+'" style="height:100%">'+e+"</div>")+('<div class="'+g+'" style="height:100%">'+f+"</div>")+"</div></div>"};this.GetLayoutHTML=function(a){function b(a,b,c,d,e,m,o){if(b||a.IsDashboardEdit())switch(c){case FiltersPosition.Top:return a.TwoRowsTableHTML(d,e,"100%","100%",m,o);case FiltersPosition.Right:return a.TwoCellsTableHTML(d,e,"100%","100%",m,o,!0);case FiltersPosition.Left:return a.TwoCellsTableHTML(d,
e,"100%","100%",m,o,!1)}else return o}var c=this.editor.GetDOMElementId(a.Layout.ElementId),d=this.editor.GetTableHTML(a,a.Layout.MainTable,!1,[],!0),e=this.editor.GetTableHTML(a,a.Layout.FiltersTable,!1,[],!0);this.ReplaceDashboardParametersInLayout(a.Layout);""!=a.Layout.Title?(d=b(this,0<a.Filters.length,a.Layout.FiltersPosition,null,"",e,d),e=this.CenteredTextHTML("gx-db-title-text","gx-db-title",this.ReplaceVariablesValuesInText(a.Layout.Title,a.Variables.Filters)),a=this.TwoRowsTableHTML(a.Layout,
c,"100%","100%",e,d)):a=b(this,0<a.Filters.length,a.Layout.FiltersPosition,a.Layout,c,e,d);return a};this.GetWidgetContentHTML=function(a,b){var c;this.ReplaceDashboardParametersInWidget(b);switch(b.WidgetType){case WidgetType.Object:c=this.GetObjectWidgetHTML(b);break;case WidgetType.Filter:c=this.GetFilterWidgetHTML(b,a.Variables.Filters);break;case WidgetType.TextBlock:c=this.GetTextBlockWidgetHTML(b,a.Variables.Filters);break;case WidgetType.Button:c=this.GetButtonWidgetHTML(b,a.Variables.Filters);
break;case WidgetType.Image:c=this.GetImageWidgetHTML(b,a.Variables.Filters);break;case WidgetType.Blank:c="";break;default:c="Not implemented"}return c};this.GetObjectMenuHTML=function(a){var b="";if(a.WidgetType==WidgetType.Object){for(var c=this.DashboardObject,b=b+('<div style="position:absolute;right:2px;top:'+(!this.WidgetsExpanded?"calc((100% - 33px) / 2)":"2px")+'" class="dropdown"><button class="gx-db-object-menu btn btn-default dropdown-toggle" type="button" data-toggle="dropdown"><span class="gx-db-object-menu-icon glyphicon glyphicon-menu-hamburger"></span></button>'),
b=b+('<ul class="dropdown-menu'+(c.Layout.FiltersPosition==FiltersPosition.Right?"":" dropdown-menu-right")+'">'),c=0;c<a.Elements.length;c++)var d=a.Elements[c].Name,b=b+('<li><a href="#" onclick="'+this.me()+".editor.SelectObjectItem(event, '"+a.ElementId+"', '"+d+"')\">"+d+"</a></li>");b+="</ul></div>"}return b};this.GetObjectWidgetHTML=function(a){var b=this.me()+".RenderQueryViewer('"+a.ElementId+"');";setTimeout(b,0);b=""+('<div id="'+this.GetQueryViewerElementId(a.ElementId)+'"></div>');this.IsDashboardEdit()&&
(b+=this.GetObjectMenuHTML(a));return b};this.GetTextBlockWidgetHTML=function(a,b){var c=this.ReplaceVariablesValuesInText(a.Caption,b);return'<span class="'+(""==a.Class?"gx-db-textblock":a.Class)+'">'+c+"</span>"};this.GetButtonWidgetHTML=function(a,b){var c=this.ReplaceVariablesValuesInText(a.Caption,b);return'<input type="button" class="btn btn-default '+(""==a.Class?"gx-db-button":a.Class)+'" value="'+c+'"></button>'};this.GetImageWidgetHTML=function(a,b){function c(a){switch(a){case "eng":return"English";
case "spa":return"Spanish";case "ita":return"Italian";case "por":return"Portuguese";case "jap":return"Japanese";case "chs":return"SimplifiedChinese";case "cht":return"TraditionalChinese";default:return qv.util.capitalize(a)}}var d=this.ReplaceVariablesValuesInText(a.AlternateText,b),e=(a.LanguageDependant?c(gx.languageCode):"")+"_"+(a.ThemeDependant?this.IsDashboardEdit()?this.DefaultStyle:gx.theme:"");return'<img class="'+(""==a.Class?"gx-db-image":a.Class)+'" src="'+("Resources/"+a.Sources[e])+
'"'+(""!=d?' alt="'+d+'"':"")+">"};this.GetFilterWidgetHTML=function(a,b){function c(a,b,c,d,e){if(""!=b.Caption){var g=""==b.CaptionClass?"gx-db-filter-caption":b.CaptionClass;""!=d&&(g+=" "+d);return'<label class="'+g+'"'+(""==e?"":' for="'+e+'"')+">"+a.ReplaceVariablesValuesInText(b.Caption,c)+"</label>"}return""}function d(a){return a.Control.Dynamic&&(a.Control.RefreshValues||!a.Control.ValuesLoaded)}function e(a,b,d){var e;e=""+c(a,b,d,"","");var g=""==b.ValueClass?"gx-db-filter-value":b.ValueClass,
d=a.ReplaceVariablesValuesInText(b.Control.InviteMessage,d),d=""!=d?' placeholder="'+d+'"':"",f;switch(b.Type){case FilterType.Value:f=b.SerializedValue;break;case FilterType.Range:f=b.SerializedLowerValue+" - "+b.SerializedUpperValue;break;case FilterType.Collection:f=b.SerializedValue.replace(/"/g,"&quot;")}var h="";a.IsDashboardEdit()&&(h=' onfocus="'+a.me()+".editor.RemoveDraggableAttributes('"+b.ElementId+'\')" onblur="'+a.me()+'.editor.RestoreDraggableAttributes()"');b=b.Type==FilterType.Range?
"SplitAndUpdateFilter2(this, '"+b.NameLowerValue+"', '"+b.NameUpperValue+"', this.value)\"":"UpdateFilter1(this, '"+b.Name+"', this.value)\"";return e+='<input type="text" class="'+g+' form-control" value="'+f+'"'+d+' onchange="'+a.me()+"."+b+h+">"}function f(a,b,d){d=""+c(a,b,d,"","");d+='<div id="'+a.GetRangeElementId(b.ElementId)+'"></div><div style="height:20px"></div>';gx.http.loadScripts([qv.services.url.getStaticDirectory()+"DashboardViewer/noUiSlider/nouislider.min.js"],function(){var c=a.me()+
".CreateSlider('"+b.ElementId+"');";b._sliderTimeout&&clearTimeout(b._sliderTimeout);b._sliderTimeout=setTimeout(c,0)});return d}function g(a,b,d){function e(){var c=a.me()+".CreateDatePicker('"+b.ElementId+"');";b._calendarTimeout&&clearTimeout(b._calendarTimeout);b._calendarTimeout=setTimeout(c,0)}function g(){var a=qv.services.url.getStaticDirectory();return[a+"DashboardViewer/DateRangePicker/moment.min.js",a+"DashboardViewer/DateRangePicker/daterangepicker.js"]}var f=!(b.Type==FilterType.Value&&
gx.util.browser.isSmartDevice()),d=""+c(a,b,d,"",""),h=""==b.ValueClass?"gx-db-filter-value":b.ValueClass,j;if(b.Type==FilterType.Range){j="";var k=a.CheckVariableInEditMode(b.LowerValue,b.DataType,!1),l=a.CheckVariableInEditMode(b.UpperValue,b.DataType,!1);if(k.IsVariable||l.IsVariable||!gx.date.isNullDate(b.LowerValue)||!gx.date.isNullDate(b.UpperValue))j=k.IsVariable?j+k.SerializedValue:j+(gx.date.isNullDate(b.LowerValue)?"":a.ValueToString(b.LowerValue,b.DataType,b.Picture,b.PictureProperties)),
j+=" - ",j=l.IsVariable?j+l.SerializedValue:j+(gx.date.isNullDate(b.UpperValue)?"":a.ValueToString(b.UpperValue,b.DataType,b.Picture,b.PictureProperties)),j=' value="'+j+'"'}else j=a.CheckVariableInEditMode(b.Value,b.DataType,!1),j=j.IsVariable?' value="'+j.SerializedValue+'"':gx.date.isNullDate(b.Value)?"":' value="'+(f?a.ValueToString(b.Value,b.DataType,b.Picture,b.PictureProperties):a.ValueToInternalString(b.Value,b.DataType,b.Picture,b.PictureProperties).replace(" ","T"))+'"';k=b.Type==FilterType.Range?
"SplitAndUpdateFilter2(this, '"+b.NameLowerValue+"', '"+b.NameUpperValue+"', this.value)\"":f?"UpdateFilter1(this, '"+b.Name+"', this.value)\"":"UpdateFilter1Internal(this, '"+b.Name+"', this.value)\"";f?(f=gx.util.browser.isSmartDevice()?' onfocus="blur()"':"",d+='<input id="'+a.GetRangeElementId(b.ElementId)+'" type="text" class="'+h+' form-control"'+j+' onchange="'+a.me()+"."+k+f+">",gx.http.loadScripts(g(),e)):(f=null!=b.MinValue?' min="'+a.ValueToInternalString(b.MinValue,b.DataType,b.Picture,
b.PictureProperties).replace(" ","T")+'"':"",l=null!=b.MaxValue?' max="'+a.ValueToInternalString(b.MaxValue,b.DataType,b.Picture,b.PictureProperties).replace(" ","T")+'"':"",d+='<input type="'+(b.DataType==DataType.Date?"date":"datetime-local")+'" class="'+h+' form-control"'+j+f+l+' onchange="'+a.me()+"."+k+">");return d}function h(a,b,c){return a.OldRadioButton()?o(a,b,c):j(a,b,c)}function j(a,b,e){function g(a,b,c,d,e,f,s){return'<div class="btn-group"><button type="button" class="'+s+" btn btn-default"+
(d?" active":"")+'"'+(e?' style="text-align:center"':"")+' onclick="'+a.me()+".UpdateFilter1(this, '"+f.Name+"', '"+b+"')\">"+c+"</button></div>"}var f=""==b.ValueClass?"gx-db-filter-value":b.ValueClass,e=""+c(a,b,e,"",""),h=b.Control.Orientation==ControlOrientation.Vertical,e=b.Control.Orientation==ControlOrientation.Horizontal?e+'<div class="btn-group btn-group-justified">':e+'<div class="btn-group-vertical" style="width:100%">';if(d(b))var j=gx.getMessage("GX_Dashboard_Loading"),e=e+g(a,j,j,!1,
h,b,f);else{b.Control.EmptyItem&&(j=a.GetEmptyValue(b.DataType,!1),e+=g(a,a.ValueToString(j,b.DataType,b.Picture,b.PictureProperties),b.Control.EmptyItemText,a.SameValue(j,b.Value,b.DataType),h,b,f));for(var k=0;k<b.Control.Values.length;k++)var j=b.Control.Values[k],l=b.Control.Descriptions[k],e=e+g(a,a.ValueToString(j,b.DataType,b.Picture,b.PictureProperties),l,a.SameValue(j,b.Value,b.DataType),h,b,f)}return e+"</div>"}function l(a,b,e){function g(a,b,c,d){return'<option value="'+b+'"'+(d?" selected":
"")+">"+c+"</option>"}var e=""+c(a,b,e,"",""),f=""==b.ValueClass?"gx-db-filter-value":b.ValueClass,h=d(b),e=e+('<select class="'+f+' form-control" onchange="'+a.me()+".UpdateFilter1(this, '"+b.Name+"', this.value)\">");if(h)f=gx.getMessage("GX_Dashboard_Loading"),e+=g(a,f,f,!1,b);else{b.Control.EmptyItem&&(f=a.GetEmptyValue(b.DataType,!1),e+=g(a,a.ValueToString(f,b.DataType,b.Picture,b.PictureProperties),b.Control.EmptyItemText,a.SameValue(f,b.Value,b.DataType),b));for(h=0;h<b.Control.Values.length;h++)var f=
b.Control.Values[h],j=b.Control.Descriptions[h],e=e+g(a,a.ValueToString(f,b.DataType,b.Picture,b.PictureProperties),j,a.SameValue(f,b.Value,b.DataType),b)}return e+"</select>"}function m(a,b,e){function g(a,b,c,d,e,f){return'<option class="'+f+'" value="'+b+'"'+(d?" selected":"")+">"+c+"</option>"}var e=""+c(a,b,e,"",""),f=""==b.ValueClass?"gx-db-filter-value":b.ValueClass,h=d(b),j=h?' title="'+gx.getMessage("GX_Dashboard_Loading")+'"':"",k=' data-select-all-text="'+gx.getMessage("GX_Dashboard_SelectAll")+
'" data-deselect-all-text="'+gx.getMessage("GX_Dashboard_DeselectAll")+'" data-none-selected-text="'+gx.getMessage("GX_Dashboard_NothingSelected")+'" data-count-selected-text="'+gx.getMessage("GX_Dashboard_ItemsSelectedQuantity")+'" data-none-results-text="'+gx.getMessage("GX_Dashboard_NoResultsMatch")+'" data-multiple-separator=", "',l=gx.util.browser.isSmartDevice()?' data-mobile="true"':"",e=e+('<select data-style="'+f+'" class="selectpicker form-control" multiple'+l+' data-icon-base = "material-icons" data-tick-icon = "" data-selected-text-format="count > 3" data-actions-box="true" data-live-search="true" data-live-search-placeholder="'+
gx.getMessage("GX_Dashboard_SearchFilter")+'" onchange="'+a.me()+".UpdateDropDownListFilter(this, '"+b.Name+"')\""+j+k+">");if(!h){b.Control.EmptyItem&&(h=a.GetEmptyValue(b.DataType,!1),e+=g(a,a.ValueToString(h,b.DataType,b.Picture,b.PictureProperties),b.Control.EmptyItemText,0<=a.ValuesIndexOf(b.Values,h,b.DataType),b,f));j=gx.util.browser.isSmartDevice()?" gx-db-sd":"";for(k=0;k<b.Control.Values.length;k++)h=b.Control.Values[k],l=b.Control.Descriptions[k],e+=g(a,a.ValueToString(h,b.DataType,b.Picture,
b.PictureProperties),l,0<=a.ValuesIndexOf(b.Values,h,b.DataType),b,f+j)}e+="</select>";gx.http.loadScripts([qv.services.url.getStaticDirectory()+"DashboardViewer/bootstrap-select/bootstrap-select.min.js"],function(){var c=a.me()+".CreateDropDownList('"+b.ElementId+"');";b._dropDownListTimeout&&clearTimeout(b._dropDownListTimeout);b._dropDownListTimeout=setTimeout(c,0)});return e}function o(a,b,e){function g(a,b,c,d,e,f){var h="",a='<input type="radio" name="optradio_'+e.ControlName+'" onclick="'+
a.me()+".UpdateFilter1(this, '"+e.Name+"', '"+b+"')\""+(d?"checked ":"")+">";return h=e.Control.Orientation==ControlOrientation.Horizontal?'<label class="'+f+' radio-inline">'+a+c+"</label>":'<div class="radio"><label class="'+f+'">'+a+c+"</label></div>"}var e=""+c(a,b,e,"",""),f=""==b.ValueClass?"gx-db-filter-value":b.ValueClass;""!=b.Caption&&b.Control.Orientation==ControlOrientation.Horizontal&&(e+="<p>");if(d(b))var h=gx.getMessage("GX_Dashboard_Loading"),e=e+g(a,h,h,!1,b,f);else{b.Control.EmptyItem&&
(h=a.GetEmptyValue(b.DataType,!1),e+=g(a,a.ValueToString(h,b.DataType,b.Picture,b.PictureProperties),b.Control.EmptyItemText,a.SameValue(h,b.Value,b.DataType),b,f));for(var j=0;j<b.Control.Values.length;j++)var h=b.Control.Values[j],k=b.Control.Descriptions[j],e=e+g(a,a.ValueToString(h,b.DataType,b.Picture,b.PictureProperties),k,a.SameValue(h,b.Value,b.DataType),b,f)}""!=b.Caption&&b.Control.Orientation==ControlOrientation.Horizontal&&(e+="</p>");return e}function k(a,b,e){function g(a,b,c,d,e,f){var h=
"",j=d?"checked ":"",k=gx.util.browser.isSmartDevice()?'class="gx-db-sd" ':"",h=a.GetRangeElementId(e.ElementId)+"_"+b,j='<input id="'+h+'" type="checkbox" '+k+j+'onchange="'+a.me()+".UpdateFilterValue(this, '"+e.Name+"', '"+b+"', this.checked)\">",a='<i class="material-icons" onclick="document.getElementById(\''+h+"').checked = this.textContent == 'check_box_outline_blank';"+a.me()+".UpdateFilterValue(this, '"+e.Name+"', '"+b+"', this.textContent == 'check_box_outline_blank')\">"+(d?"check_box":
"check_box_outline_blank")+"</i>";return h=e.Control.Orientation==ControlOrientation.Horizontal?j+a+'<label class="'+f+' checkbox-inline" for="'+h+'">'+c+"</label>":'<div class="checkbox">'+j+a+'<label class="'+f+'" for="'+h+'">'+c+"</label></div>"}var e=""+c(a,b,e,"",""),f=""==b.ValueClass?"gx-db-filter-value":b.ValueClass;""!=b.Caption&&b.Control.Orientation==ControlOrientation.Horizontal&&(e+="<p>");if(d(b))var h=gx.getMessage("GX_Dashboard_Loading"),e=e+g(a,h,h,!1,b,f);else{b.Control.EmptyItem&&
(h=a.GetEmptyValue(b.DataType,!1),e+=g(a,a.ValueToString(h,b.DataType,b.Picture,b.PictureProperties),b.Control.EmptyItemText,0<=a.ValuesIndexOf(b.Values,h,b.DataType),b,f));for(var j=0;j<b.Control.Values.length;j++)var h=b.Control.Values[j],k=b.Control.Descriptions[j],e=e+g(a,a.ValueToString(h,b.DataType,b.Picture,b.PictureProperties),k,0<=a.ValuesIndexOf(b.Values,h,b.DataType),b,f)}""!=b.Caption&&b.Control.Orientation==ControlOrientation.Horizontal&&(e+="</p>");return e}function q(a,b,d){var e="",
g=b.Value?"checked ":"",f=gx.util.browser.isSmartDevice()?'class="gx-db-sd" ':"",h=a.GetRangeElementId(b.ElementId),g='<input id="'+h+'" type="checkbox" '+f+g+'onchange="'+a.me()+".UpdateFilter1(this, '"+b.Name+"', this.checked.toString())\">",e=e+g,g='<i class="material-icons" onclick="document.getElementById(\''+h+"').checked = this.textContent == 'check_box_outline_blank';"+a.me()+".UpdateFilter1(this, '"+b.Name+"', this.textContent == 'check_box_outline_blank')\">"+(b.Value?"check_box":"check_box_outline_blank")+
"</i>";return e=e+g+c(a,b,d,"checkbox-inline",h)}function n(a,b,d){d=""+c(a,b,d,"gx-db-switch-label","");d+='<input type="checkbox" id="'+a.GetRangeElementId(b.ElementId)+'">';gx.http.loadScripts([qv.services.url.getStaticDirectory()+"DashboardViewer/bootstrap-switch/bootstrap-switch.min.js"],function(){var c=a.me()+".CreateSwitch('"+b.ElementId+"');";b._switchTimeout&&clearTimeout(b._switchTimeout);b._switchTimeout=setTimeout(c,0)});return d}function r(a,b,c){switch(b.Control.Type){case ControlType.Editbox:return e(a,
b,c);case ControlType.RadioButton:return h(a,b,c);case ControlType.ComboBox:return l(a,b,c);case ControlType.Slider:return f(a,b,c);default:return e(a,b,c)}}function u(a,b,c){switch(b.Control.Type){case ControlType.Editbox:return e(a,b,c);case ControlType.RadioButton:return h(a,b,c);case ControlType.ComboBox:return l(a,b,c);default:return e(a,b,c)}}function w(a,b,c){switch(b.Control.Type){case ControlType.Editbox:return e(a,b,c);case ControlType.Checkbox:return q(a,b,c);case ControlType.RadioButton:return h(a,
b,c);case ControlType.ComboBox:return l(a,b,c);case ControlType.Switch:return n(a,b,c);default:return q(a,b,c)}}function v(a,b,c){switch(b.Control.Type){case ControlType.Editbox:return g(a,b,c);case ControlType.RadioButton:return h(a,b,c);case ControlType.ComboBox:return l(a,b,c);case ControlType.Slider:return f(a,b,c);default:return e(a,b,c)}}if(a.Visible){if(d(a)){var x=this,y=this.QueryFilterName(a);qv.services.createAsyncServerCallFn(this.FakeQueryViewer(y),qv.services.url.getDataURL,qv.services.postInfo.Data,
"GetData")(function(b){x.ControlValuesLoaded(a,b)})}if(a.Type==FilterType.Collection)switch(a.Control.Type){case ControlType.Editbox:return e(this,a,b);case ControlType.Checkbox:return k(this,a,b);case ControlType.DropDownList:return m(this,a,b);default:return k(this,a,b)}else switch(a.DataType){case DataType.Integer:return r(this,a,b);case DataType.Real:return r(this,a,b);case DataType.Character:return u(this,a,b);case DataType.Boolean:return w(this,a,b);case DataType.Date:return v(this,a,b);case DataType.DateTime:return v(this,
a,b);case DataType.GUID:return u(this,a,b);case DataType.GeoPoint:return u(this,a,b);default:return"Not implemented"}}else return a.Type==FilterType.Range?a.NameLowerValue+" = "+a.SerializedLowerValue+"; "+a.NameUpperValue+" = "+a.SerializedUpperValue:a.Name+" = "+a.SerializedValue};this.ControlValuesLoaded=function(a,b){var c={xml:{data:b}};if(qv.util.anyError(b)){c.Data={Rows:[]};var d=qv.util.getErrorFromText(b);this.ShowError(a.ElementId,d,!1)}else qv.services.parseDataXML(c);a.Control.RefreshValues=
!1;a.Control.ValuesLoaded=!0;a.Control.Values=[];a.Control.Descriptions=[];for(d=0;d<c.Data.Rows.length;d++){var e=c.Data.Rows[d],f=qv.util.trim(e.F1),e=qv.util.trim(e.F2);if(null!=f&&null!=e){var g=this.ParseInternalValue(f,a.DataType,!1),f=this.ParseInternalValue(e,a.Control.DscAttDataType,!1);g.Success&&f.Success&&(a.Control.Values.push(g.ParsedValue),e=this.DefaultPicture(a.Control.DscAttDataType),g=this.GetPictureProperties(a.Control.DscAttDataType,e),a.Control.Descriptions.push(this.ValueToString(f.ParsedValue,
a.Control.DscAttDataType,e,g)))}}0>this.ValuesIndexOf(a.Control.Values,a.Value,a.DataType)&&0<a.Control.Values.length&&(a.Value=a.Control.EmptyItem?this.GetEmptyValue(a.DataType,!1):a.Control.Values[0]);this.RefreshWidget(a)};this.CreateDatePicker=function(a){function b(a){var b;b=0<=a.DateFormat.indexOf("4")?a.DateFormat.replace("D","DD/").replace("M","MM/").replace("Y4","YYYY/").substr(0,10):a.DateFormat.replace("D","DD/").replace("M","MM/").replace("Y","YY/").substr(0,8);a.IncludeHours&&(b+=12==
gx.timeFormat?" hh":" HH");a.IncludeMinutes&&(b+=":mm");a.IncludeSeconds&&(b+=":ss");12==gx.timeFormat&&(b+=" A");return b}var c=this.DashboardObject,d=this.GetWidget(a);if(null!=d){a={parentEl:"#"+this.editor.GetDOMElementId(1),autoApply:d.DataType==DataType.Date,linkedCalendars:!1,opens:c.Layout.FiltersPosition==FiltersPosition.Right?"left":"right",singleDatePicker:d.Type!=FilterType.Range,autoUpdateInput:!1,showDropdowns:!0,locale:{format:b(d.PictureProperties),monthNames:[gx.getMessage("GX_Dashboard_January"),
gx.getMessage("GX_Dashboard_February"),gx.getMessage("GX_Dashboard_March"),gx.getMessage("GX_Dashboard_April"),gx.getMessage("GX_Dashboard_May"),gx.getMessage("GX_Dashboard_June"),gx.getMessage("GX_Dashboard_July"),gx.getMessage("GX_Dashboard_August"),gx.getMessage("GX_Dashboard_September"),gx.getMessage("GX_Dashboard_October"),gx.getMessage("GX_Dashboard_November"),gx.getMessage("GX_Dashboard_December")],daysOfWeek:[gx.getMessage("GX_Dashboard_Sunday"),gx.getMessage("GX_Dashboard_Monday"),gx.getMessage("GX_Dashboard_Tuesday"),
gx.getMessage("GX_Dashboard_Wednesday"),gx.getMessage("GX_Dashboard_Thursday"),gx.getMessage("GX_Dashboard_Friday"),gx.getMessage("GX_Dashboard_Saturday")],applyLabel:gx.getMessage("GX_Dashboard_Apply"),cancelLabel:gx.getMessage("GX_Dashboard_Cancel")}};null!=d.MinValue&&(c=this.CheckVariable(d.MinValue,[d.DataType],d.Type==FilterType.IsCollection,this.DashboardObject.Variables.AllParameters),c.IsVariable||(a.minDate=d.MinValue.getStringWithFmt(d.PictureProperties.DateFormat)));null!=d.MaxValue&&
(c=this.CheckVariable(d.MaxValue,[d.DataType],d.Type==FilterType.IsCollection,this.DashboardObject.Variables.AllParameters),c.IsVariable||(a.maxDate=d.MaxValue.getStringWithFmt(d.PictureProperties.DateFormat)));d.DataType==DataType.DateTime&&d.PictureProperties.IncludeHours&&(a.timePicker=!0,a.timePicker24Hour=24==gx.timeFormat,a.timePickerSeconds=d.PictureProperties.IncludeSeconds);c=n("#"+this.GetRangeElementId(d.ElementId));c.daterangepicker(a);var e=this;c.on("apply.daterangepicker",function(a,
b){function c(a,b,d){d=new gx.date.gxdate(d);d.HasTimePart=b.DataType==DataType.DateTime;return a.ValueToString(d,b.DataType,b.Picture,b.PictureProperties)}if(d.Type==FilterType.Range){var j=c(e,d,b.startDate._d),l=c(e,d,b.endDate._d);n(this).val(j+" - "+l);e.UpdateFilter2(this,d.NameLowerValue,d.NameUpperValue,j,l)}else{j=c(e,d,b.startDate._d);n(this).val(j);e.UpdateFilter1(this,d.Name,j)}})}};this.CreateSlider=function(a){var b=this.GetWidget(a);if(null!=b){var c,d,e,f,g,h,j,l,a=this.ResolveVariableValue(b.MaxValue,
b.DataType,!1),m=this.ResolveVariableValue(b.MinValue,b.DataType,!1);b.Type==FilterType.Value?h=this.ResolveVariableValue(b.Value,b.DataType,!1):(j=this.ResolveVariableValue(b.LowerValue,b.DataType,!1),l=this.ResolveVariableValue(b.UpperValue,b.DataType,!1));b._noUiSliderSlideExecuted=!1;b.Type==FilterType.Range&&(b._noUiSliderIsLowerValue=!0);switch(b.DataType){case DataType.Integer:case DataType.Real:b.Type==FilterType.Value?d=c=h:(c=j,d=l);e=null!=m?m:c-50;f=null!=a?a:d+50;g=b.DataType==DataType.Integer?
1:1/Math.pow(10,b.PictureProperties.DecimalPrecision);break;case DataType.Date:b.Type==FilterType.Value?(b.MinValueResolved=null!=m?m:gx.date.dtadd(h,-432E4),b.MaxValueResolved=null!=a?a:gx.date.dtadd(h,432E4)):(b.MinValueResolved=null!=m?m:gx.date.dtadd(j,-432E4),b.MaxValueResolved=null!=a?a:gx.date.dtadd(l,432E4));e=0;f=gx.date.daysDiff(b.MaxValueResolved,b.MinValueResolved);b.Type==FilterType.Value?d=c=gx.date.daysDiff(h,b.MinValueResolved):(c=gx.date.daysDiff(j,b.MinValueResolved),d=gx.date.daysDiff(l,
b.MinValueResolved));g=1;break;case DataType.DateTime:b.Type==FilterType.Value?(b.MinValueResolved=null!=m?m:gx.date.dtadd(h,-432E4),b.MaxValueResolved=null!=a?a:gx.date.dtadd(h,432E4)):(b.MinValueResolved=null!=m?m:gx.date.dtadd(j,-432E4),b.MaxValueResolved=null!=a?a:gx.date.dtadd(l,432E4)),e=0,f=gx.date.dtdiff(b.MaxValueResolved,b.MinValueResolved),b.Type==FilterType.Value?d=c=gx.date.dtdiff(h,b.MinValueResolved):(c=gx.date.dtdiff(j,b.MinValueResolved),d=gx.date.dtdiff(l,b.MinValueResolved)),g=
1}var o=this;h=document.getElementById(this.GetRangeElementId(b.ElementId));g={start:b.Type==FilterType.Value?[c]:[c,d],step:g,tooltips:!0,connect:b.Type==FilterType.Range,behaviour:"drag-tap",format:{to:function(a){var c=false;if(!b._noUiSliderSlideExecuted){if(b.Type==FilterType.Value)c=b.Value;else{c=b._noUiSliderIsLowerValue?b.LowerValue:b.UpperValue;b._noUiSliderIsLowerValue=!b._noUiSliderIsLowerValue}var d=o.CheckVariableInEditMode(c,b.DataType,b.Type==FilterType.Collection),c=d.IsVariable}if(c)return d.SerializedValue;
var e;switch(b.DataType){case DataType.Integer:e=a;break;case DataType.Real:e=a;break;case DataType.Date:e=gx.date.dtadd(b.MinValueResolved,Math.round(a)*86400);break;case DataType.DateTime:e=gx.date.dtadd(b.MinValueResolved,Math.round(a))}return o.ValueToString(e,b.DataType,b.Picture,b.PictureProperties)},from:function(a){return parseFloat(a)}}};e!=f?g.range={min:e,max:f}:(g.range={min:c-1,max:d+1},g.disabled=!0);noUiSlider.create(h,g);h.noUiSlider.on("slide",function(){b._noUiSliderSlideExecuted=
true});h.noUiSlider.on("set",function(){if(b.Type!=FilterType.Range)o.UpdateFilter1(null,b.Name,this.get());else{var a=this.get();o.UpdateFilter2(null,b.NameLowerValue,b.NameUpperValue,a[0],a[1])}});c=""==b.ValueClass?"gx-db-filter-value":b.ValueClass;n("#"+this.GetRangeElementId(b.ElementId)+" .noUi-tooltip").addClass(c)}};this.CreateSwitch=function(a){var b=this.GetWidget(a);if(null!=b){var a={size:"small",state:b.Value,handleWidth:0,labelWidth:10,onText:"",offText:"",onColor:"primary",offColor:"default"},
c=this,d=n("#"+this.GetRangeElementId(b.ElementId));d.bootstrapSwitch(a);d.on("switchChange.bootstrapSwitch",function(a,f){c.UpdateFilter1(null,b.Name,f.toString());f?(d.bootstrapSwitch("onColor","primary"),d.bootstrapSwitch("offColor","primary")):(d.bootstrapSwitch("onColor","default"),d.bootstrapSwitch("offColor","default"))})}};this.CreateDropDownList=function(a){null!=this.GetWidget(a)&&n("#"+this.editor.GetDOMElementId(widget.ElementId)+" > .selectpicker").selectpicker()};this.GetQueryViewerAxes=
function(a,b){for(var c=JSON.parse(JSON.stringify(a.Elements)),d=0;d<c.length;d++)this.ReplaceVariablesInObjectElement(c[d],b);return c};this.GetQueryViewerParameters=function(a){function b(a,b,c,d,e,f,k){c=d==DataType.Real?c.replace(",","."):c;c=a.ResolveVariable(c,d,e);a=c.WasVariable?e?a.ValuesToString(c.Value,d,f,k):a.ValueToString(c.Value,d,f,k):c.Value;return{Name:b,Value:a}}for(var c=[],d=0;d<a.Filters.length;d++){var e=a.Filters[d],f;e.Type!=FilterType.Range?f=b(this,e.Name,e.SerializedValue,
e.DataType,e.Type==FilterType.Collection,e.Picture,e.PictureProperties):(f=b(this,e.NameLowerValue,e.SerializedLowerValue,e.DataType,e.Type==FilterType.Collection,e.Picture,e.PictureProperties),c.push(f),f=b(this,e.NameUpperValue,e.SerializedUpperValue,e.DataType,e.Type==FilterType.Collection,e.Picture,e.PictureProperties));c.push(f)}for(d=0;d<a.Parameters.length;d++)e=a.Parameters[d],f=b(this,e.Name,e.SerializedValue,e.DataType,e.Type==ParameterType.Collection,e.Picture,e.PictureProperties),c.push(f);
return c};this.GetEmptyValueStr=function(a,b){if(b)return"[]";switch(a){case DataType.Integer:case DataType.Real:return"0";case DataType.Character:return"";case DataType.Boolean:return"false";case DataType.Date:return"0000-00-00";case DataType.DateTime:return"0000-00-00 00:00:00";case DataType.GUID:return"00000000-0000-0000-0000-000000000000";case DataType.GeoPoint:return"";default:return""}};this.GetEmptyValue=function(a,b){if(b)return[];switch(a){case DataType.Integer:case DataType.Real:return 0;
case DataType.Character:return"";case DataType.Boolean:return!1;case DataType.Date:case DataType.DateTime:return new gx.date.gxdate;case DataType.GUID:return"00000000-0000-0000-0000-000000000000";case DataType.GeoPoint:return"";default:return null}};this.NextControlId=function(){this._queryViewerId?this._queryViewerId++:this._queryViewerId=1;return this.ParentObject.GXLastCtrlId+this._queryViewerId+1};this.QueryFilterName=function(a){return this.DashboardObject.Name+"_"+a.ControlName};this.RenderQueryViewer=
function(a){var b=this.GetWidget(a);if(null!=b){var a=this.GetQueryViewerElementId(b.ElementId),c;if(!b.QueryViewer||b.QueryViewer.ContainerName!=a){var d=this.ParentObject,e=this.NextControlId(),f="QueryViewer"+b.ElementId,g=f.toUpperCase();c=gx.uc.getNew(d,e,0,"QueryViewer",a,f,g);d.setUserControl(c);b.QueryViewer=c}else c=b.QueryViewer;c._EmbeddedInDashboard=!0;a=this.DashboardObject.Variables.Filters;d=this.GetQueryViewerParameters(this.DashboardObject);e=this.GetQueryViewerAxes(b,a);this.InitializeQueryViewer(c);
c.Class=""==b.Class?"gx-db-object":b.Class;c.Visible=!0;c.Enabled=!0;c.SetParameters(d);c.SetAxes(e);c.ReturnSampleData=b.Type==ObjectType.DataProvider&&this.IsDashboardEdit()?!0:this.ReturnSampleData;c.ObjectName=b.Name;c.ObjectType=b.Type;c.Title=this.ReplaceVariablesValuesInText(b.Output.Title,a);c.Type=b.Output.Type;c.ChartType=b.Output.ChartType;c.PlotSeries=b.Output.PlotSeries;c.XAxisLabels=b.Output.XAxisLabels;c.XAxisIntersectionAtZero=b.Output.XAxisIntersectionAtZero;c.XAxisTitle=this.ReplaceVariablesValuesInText(b.Output.XAxisTitle,
a);c.YAxisTitle=this.ReplaceVariablesValuesInText(b.Output.YAxisTitle,a);c.ShowValues=b.Output.ShowValues;c.ShowDataAs=b.Output.ShowDataAs;c.Orientation=b.Output.Orientation;c.IncludeTrend=b.Output.IncludeTrend;c.TrendPeriod=b.Output.TrendPeriod;c.IncludeSparkline=b.Output.IncludeSparkline;c.IncludeMaxAndMin=b.Output.IncludeMaxAndMin;c.Paging=b.Output.Paging;c.PageSize=this.ReplaceVariableValue(b.Output.PageSize,[DataType.Integer],!1,a);c.ShowDataLabelsIn=b.Output.ShowDataLabelsIn;c.TotalForRows=
b.Output.TotalForRows;c.TotalForColumns=b.Output.TotalForColumns;c.MapLibrary=QueryViewerMapLibrary.ECharts;c.MapType=b.Output.MapType;c.Region=b.Output.Region;c.Continent=b.Output.Continent;c.Country=b.Output.Country;c.TranslationType=this.TranslationType;if(b.OnItemClick==OnItemClick.ApplyFilters||b.OnItemClick==OnItemClick.HighlightValues||b.OnItemClick==OnItemClick.RaiseItemClick&&this.ItemClick){c.AllowSelection=b.OnItemClick==OnItemClick.ApplyFilters||b.OnItemClick==OnItemClick.HighlightValues;
var h=this;c.ItemClick=function(){h.ProcessItemClick(b,c)}}else c.ItemClick&&delete c.ItemClick;if(b.OnItemClick!=OnItemClick.ApplyFilters&&b.HiddenFilters&&0<b.HiddenFilters.length){a=[];for(d=0;d<c.Metadata.Axes.length;d++)e=c.Metadata.Axes[d],this.RemoveHiddenFilter(b,e.Name),a.push(e.Name);0<a.length&&this.RefreshDashboard(a)}c.show()}};this.ProcessItemClick=function(a,b){switch(a.OnItemClick){case OnItemClick.ApplyFilters:this.ApplyHiddenFilters(a,b);break;case OnItemClick.HighlightValues:var c=
this.HighlightValues(a,b);this.ValuesHighlighted&&(this.LoadValuesHighlightedData(c),this.ValuesHighlighted());break;case OnItemClick.RaiseItemClick:this.LoadItemClickData(a,b),this.ItemClick()}};this.FakeQueryViewer=function(a){var b=this.GetQueryViewerParameters(this.DashboardObject),c={RealType:"Table",Axes:[]};c.Parameters=b;c.ParentObject={PackageName:this.ParentObject.PackageName};c.ObjectName=a;c.ObjectType=ObjectType.Query;c.ObjectId=0;c.QueryInfo="";c.AppSettings=[];c.AllowElementsOrderChange=
!1;c.UseRecordsetCache=!1;c.ReturnSampleData=this.ReturnSampleData;return c};this.InitializeQueryViewer=function(a){a.AutoRefreshGroup="";a.SetDragAndDropData({});a.SetItemExpandData({});a.SetItemCollapseData({});a.SetFilterChangedData({});a.SetItemClickData({});a.SetItemDoubleClickData({});a.ObjectId=0;a.ObjectType="";a.QueryInfo="";a.AppSettings="";a.IsExternalQuery=!1;a.ExternalQueryResult="";a.AvoidAutomaticShow=!1;a.ExecuteShow=!1;a.ObjectInfo="";a.SetAxes([]);a.SetParameters([]);a.ObjectName=
"";a.Class="";a.AutoResize=!1;a.Width="100%";a.Height="100%";a.ShowAxesSelectors="BothSelectors";a.AllowElementsOrderChange=!1;a.DisableColumnSort=!1;a.FontFamily="";a.FontSize=0;a.FontColor=gx.color.fromRGB(0,0,0);a.ExportToXML=!0;a.ExportToHTML=!0;a.ExportToXLS=!0;a.ExportToXLSX=!0;a.ExportToPDF=!0;a.Title="";a.Type=OutputType.Chart;a.ChartType=ChartType.Column;a.Paging=!0;a.PageSize=20;a.CurrentPage=0;a.ShowDataLabelsIn=ShowDataLabelsIn.Columns;a.TotalForRows=Total.Yes;a.TotalForColumns=Total.Yes;
a.PlotSeries=PlotSeries.InTheSameChart;a.XAxisLabels=XAxisLabels.Horizontally;a.XAxisIntersectionAtZero=!1;a.ShowValues=!0;a.XAxisTitle="";a.YAxisTitle="";a.ShowDataAs=ShowDataAs.Values;a.Orientation=Orientation.Horizontal;a.IncludeTrend=!1;a.TrendPeriod=TrendPeriod.SinceTheBeginning;a.IncludeSparkline=!1;a.IncludeMaxAndMin=!1;a.RememberLayout=!0};this.HighlightValues=function(a,b){var c=[],d=b.ItemClickData;if(d.Selected)for(var e=0;e<d.Context.length;e++){var f=d.Context[e],g=this.GetAxisInMetadata(b.Metadata,
f.Name);null!=g&&1==f.Values.length&&c.push({Name:g.Name,Value:f.Values[0]})}d=this.DashboardObject;for(e=0;e<d.Objects.length;e++)d.Objects[e].ElementId!=a.ElementId&&(f=d.Objects[e].QueryViewer,f.AllowSelection=!0,f.Select(c));return c};this.CheckFilterValue=function(a,b,c,d,e,f,g,h){function j(a,b){if(b==FilterType.Collection)return gx.getMessage("GX_Dashboard_NotAValidJSON");switch(a){case DataType.Integer:case DataType.Real:return gx.getMessage("GX_Dashboard_NotAValidNumber");case DataType.Boolean:return gx.getMessage("GX_Dashboard_NotAValidBoolean");
case DataType.Date:return gx.getMessage("GX_Dashboard_NotAValidDate");case DataType.DateTime:return gx.getMessage("GX_Dashboard_NotAValidDateTime");case DataType.GUID:return gx.getMessage("GX_Dashboard_NotAValidGUID");case DataType.GeoPoint:return gx.getMessage("GX_Dashboard_NotAValidGeoPoint");default:return""}}function l(a,b,c,d,e){return null!=d&&b!=DataType.Boolean&&c!=FilterType.Collection?b==DataType.Date||b==DataType.DateTime?e?0<=a.compare(d):0>=a.compare(d):e?a>=d:a<=d:!0}var m=null,o="",
k="",a=""==a?this.GetEmptyValueStr(b,c==FilterType.Collection):a,n=this.CheckVariableInEditMode(a,b,c==FilterType.Collection),p={};n.IsVariable?(p.Success=!0,p.ParsedValue=n.Value,o=n.SerializedValue):p=h?this.ParseInternalValue(a,b,c==FilterType.Collection):this.ParseValue(a,b,c==FilterType.Collection);p.Success?l(p.ParsedValue,b,c,f,!0)?l(p.ParsedValue,b,c,g,!1)?(m=p.ParsedValue,n.IsVariable||(o=c==FilterType.Collection?this.ValuesToString(m,b,d,e):this.ValueToString(m,b,d,e))):k=gx.getMessage("GX_Dashboard_MaximumExceeded"):
k=gx.getMessage("GX_Dashboard_MinimumExceeded"):k=j(b,c);return{Success:""==k,IsVariable:n.IsVariable,ParsedValue:m,ParsedSerializedValue:o,Message:k}};this.UpdateFilterLayout=function(a,b,c){function d(a,b){if(!a.OldRadioButton()){for(var c=0;c<b.parentNode.parentNode.childNodes.length;c++)b.parentNode.parentNode.childNodes[c].childNodes[0].classList.remove("active");b.classList.add("active")}}function e(a,b){for(var c="INPUT"==b.tagName?b:b.previousSibling,d=!1,e=0;e<b.parentNode.childNodes.length;e++){var f=
b.parentNode.childNodes[e];f.id==c.id&&(d=!0);if(f.classList.contains("material-icons")&&d){f.textContent="check_box_outline_blank"==f.textContent?"check_box":"check_box_outline_blank";break}}}if(null!=a)switch(b.Control.Type){case ControlType.Editbox:var f;switch(b.Type){case FilterType.Value:f=c?this.ValueToInternalString(b.Value,b.DataType,b.Picture,b.PictureProperties).replace(" ","T"):b.SerializedValue;break;case FilterType.Range:f=b.SerializedLowerValue+" - "+b.SerializedUpperValue;break;case FilterType.Collection:f=
b.SerializedValue}a.value=f;break;case ControlType.RadioButton:d(this,a);break;case ControlType.Checkbox:e(this,a)}};this.UpdateFilter1=function(a,b,c){return this.UpdateFilterMain(a,b,null,c,null,!1)};this.UpdateFilter2=function(a,b,c,d,e){return this.UpdateFilterMain(a,b,c,d,e,!1)};this.UpdateFilter1Internal=function(a,b,c){return this.UpdateFilterMain(a,b,null,c,null,!0)};this.SplitAndUpdateFilter2=function(a,b,c,d){var e=d.split(" - ");1==e.length&&(e=d.split("-"));var f=d="";1<=e.length&&(d=
e[0]);2<=e.length&&(f=e[1]);this.UpdateFilter2(a,b,c,d,f)};this.UpdateFilterMain=function(a,b,c,d,e,f){var g=this.GetFilterByNames([b,c]),h=!1,j=!1;if(null!=g){d=this.CheckFilterValue(d,g.DataType,g.Type,g.Picture,g.PictureProperties,g.MinValue,g.MaxValue,f);e=g.Type==FilterType.Range?this.CheckFilterValue(e,g.DataType,g.Type,g.Picture,g.PictureProperties,g.MinValue,g.MaxValue,f):{Success:!0,Message:""};d.Success&&(e.Success&&g.Type==FilterType.Range&&1==this.CompareValues(d.ParsedValue,e.ParsedValue,
g.DataType))&&(d.Success=!1,d.Message=gx.getMessage("GX_Dashboard_LowerValueGreaterThanUpperValue"));if(d.Success&&e.Success){if(g.Type==FilterType.Collection){if(h=g.SerializedValue!=d.ParsedSerializedValue)g.Values=d.ParsedValue,g.SerializedValue=d.ParsedSerializedValue}else if(g.Type!=FilterType.Range?h=g.SerializedValue!==d.ParsedSerializedValue:(h=g.SerializedLowerValue!==d.ParsedSerializedValue,j=g.SerializedUpperValue!==e.ParsedSerializedValue),h||j)g.Type!=FilterType.Range?(g.Value=d.ParsedValue,
g.SerializedValue=d.ParsedSerializedValue):(g.LowerValue=d.ParsedValue,g.UpperValue=e.ParsedValue,g.SerializedLowerValue=d.ParsedSerializedValue,g.SerializedUpperValue=e.ParsedSerializedValue);this.HideError()}else this.ShowError(g.ElementId,d.Message+(""==e.Message?"":" ")+e.Message,!0);(h||j||g.Control.Type==ControlType.Editbox)&&this.UpdateFilterLayout(a,g,f);if(h||j)a=[],null!=b&&h&&a.push(b),null!=c&&j&&a.push(c),this.RefreshDashboard(a),this.IsDashboardEdit()&&(g.Type!=FilterType.Range?(b=d.IsVariable?
d.ParsedSerializedValue:g.Type==FilterType.Collection?g.SerializedValue:this.ValueToInternalString(g.Value,g.DataType,g.Picture,g.PictureProperties),window.external.SetFilterValue(g.ElementId,b)):(b=d.IsVariable?d.ParsedSerializedValue:this.ValueToInternalString(g.LowerValue,g.DataType,g.Picture,g.PictureProperties),c=e.IsVariable?e.ParsedSerializedValue:this.ValueToInternalString(g.UpperValue,g.DataType,g.Picture,g.PictureProperties),window.external.SetFilterValues(g.ElementId,b,c)))}return h||j};
this.ShowError=function(a,b,c){var d=this.editor.GetErrorDiv(),e=n("#"+this.editor.GetDOMElementId(a)),f=e.offset(),g=window.getComputedStyle(document.getElementById(this.editor.GetDOMElementId(a))),a=parseInt(g.getPropertyValue("padding-bottom")),g=parseInt(g.getPropertyValue("padding-left"));d.style.left=gx.dom.addUnits(parseInt(f.left+g));d.style.top=gx.dom.addUnits(parseInt(f.top+e.height()+a));d.style.width=gx.dom.addUnits(e.width());d.innerText=b;d.style.display="block";d.classList.remove("gx-db-fade");
this._errorFadeTimeout&&clearTimeout(this._errorFadeTimeout);c&&(b=this.me()+".FadeError();",this._errorFadeTimeout=setTimeout(b,5E3))};this.HideError=function(){this.editor.GetErrorDiv().style.display="none"};this.FadeError=function(){this.editor.GetErrorDiv().classList.add("gx-db-fade")};this.UpdateFilterValue=function(a,b,c,d){for(var e=this.DashboardObject,f=!1,g=0;g<e.Filters.length;g++){var h=e.Filters[g];if(h.Name==b){c=this.CheckFilterValue(c,h.DataType,FilterType.Value,h.Picture,h.PictureProperties,
null,null,!1);if(c.Success){if(e=this.ValuesIndexOf(h.Values,c.ParsedValue,h.DataType),0>e&&d&&(h.Values.push(c.ParsedValue),h.SerializedValue=this.ValuesToString(h.Values,h.DataType,h.Picture,h.PictureProperties),f=!0),0<=e&&!d)h.Values.splice(e,1),h.SerializedValue=this.ValuesToString(h.Values,h.DataType,h.Picture,h.PictureProperties),f=!0}else this.ShowError(h.ElementId,c.Message,!0);f&&(this.UpdateFilterLayout(a,h,!1),this.RefreshDashboard([b]),this.IsDashboardEdit()&&window.external.SetFilterValue(h.ElementId,
h.SerializedValue));break}}};this.UpdateDropDownListFilter=function(a,b){var c=this.GetFilterByName(b);if(null!=c){var d;d=c.DataType==DataType.Character||c.DataType==DataType.Date||c.DataType==DataType.DateTime||c.DataType==DataType.GUID||c.DataType==DataType.GeoPoint?'"':"";for(var e="",f=0;f<a.options.length;f++)if(a.options[f].selected){var g=this.CheckFilterValue(a.options[f].value,c.DataType,FilterType.Value,c.Picture,c.PictureProperties,null,null,!1);g.Success&&(g=d+this.ValueToInternalString(g.ParsedValue,
c.DataType,c.Picture,c.PictureProperties)+d,e+=(""==e?"":", ")+g)}this.UpdateFilter1(a,b,"["+e+"]")}};this.ApplyHiddenFilters=function(a,b){for(var c=b.ItemClickData,d=[],e=0;e<c.Context.length;e++){var f=c.Context[e],g=this.GetAxisInMetadata(b.Metadata,f.Name);if(null!=g&&1==f.Values.length)if(c.Selected){var h=this.GetHiddenFilterDataType(g),f=this.ParseValue(f.Values[0],h,!1);f.Success&&this.AddHiddenFilter(a,g.Name,f.ParsedValue,h)&&d.push(g.Name)}else this.RemoveHiddenFilter(a,g.Name),d.push(g.Name)}0<
d.length&&this.RefreshDashboard(d)};this.RemoveHiddenFilter=function(a,b){for(var c=this.DashboardObject,d=0;d<c.Filters.length;d++)if(filter=c.Filters[d],filter.Name==b&&filter.IsHidden){c.Filters.splice(d,1);break}c=a.HiddenFilters.indexOf(b);0<=c&&a.HiddenFilters.splice(c,1)};this.GetFilterByName=function(a){return this.GetFilterByNames([a])};this.GetFilterByNames=function(a){for(var b=this.DashboardObject,c=0;c<b.Filters.length;c++){filter=b.Filters[c];var d=filter.Type==FilterType.Range;if(!d&&
filter.Name==a[0]||d&&filter.NameLowerValue==a[0]&&filter.NameUpperValue==a[1])return filter}return null};this.GetFilterByAnyName=function(a){for(var b=this.DashboardObject,c=0;c<b.Filters.length;c++)if(filter=b.Filters[c],filter.Type==FilterType.Range){if(filter.NameLowerValue.toLowerCase()==a.toLowerCase()||filter.NameUpperValue.toLowerCase()==a.toLowerCase())return filter}else if(filter.Name.toLowerCase()==a.toLowerCase())return filter;return null};this.AddHiddenFilter=function(a,b,c,d){for(var e=
this.DashboardObject,f=!1,g,h=!1,h=0;h<e.Filters.length;h++)if(g=e.Filters[h],g.Name==b){f=!0;break}if(f){if(h=g.Value!==c)g.Value=c,g.SerializedValue=this.ValueToString(g.Value,g.DataType,g.Picture,g.PictureProperties)}else g={},this.FilterDefaults(g,e),g.IsHidden=!0,g.Name=b,g.DataType=d,g.Type=FilterType.Value,g.MinValue="",g.MaxValue="",e.Filters.push(g),a.HiddenFilters=a.HiddenFilters||[],a.HiddenFilters.push(b),g.Value=c,this.ProcessFilter(g),h=!0;return h};this.GetAxisInMetadata=function(a,
b){for(var c=0;c<a.Axes.length;c++){var d=a.Axes[c];if(d.Name==b)return d}return null};this.GetHiddenFilterDataType=function(a){if(null!=a)switch(a.DataType){case "integer":return DataType.Integer;case "real":return DataType.Real;case "character":return DataType.Character;case "boolean":return DataType.Boolean;case "date":return DataType.Date;case "datetime":return DataType.DateTime;case "guid":return DataType.GUID;case "geopoint":return DataType.GeoPoint;default:return DataType.Integer}else return DataType.Integer}}
;
