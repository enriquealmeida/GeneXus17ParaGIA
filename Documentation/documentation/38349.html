<!DOCTYPE html>
<html>
<head>
<meta http-equiv=Content-Type content="text/html; charset=UTF-8">
<link rel="stylesheet" type="text/css" href="./images/WikiTheme2.css"/>
<link rel="stylesheet" type="text/css" href="./images/bootstrap.min.css"/>
<title>Database Mocking</title>
</head>
<body bgcolor="#FFFFFF" style="display: block;margin: 8px;"><span id="W0004BODY" class="WikiBody"><table border=0 width=100%><tr><td><div align="right"><FONT face=Verdana size=2><a href =https://wiki.genexus.com/commwiki/wiki?38349,, target=_"blank">Newest Version</a></FONT></div></td></tr></table><h1 class="WikiName">Database Mocking</h1>
<!--Database Mocking--><div class="TableWikiBody" id="tblwikibody"><h3><a id="Introduction" class="HashLink" href="#Introduction">Introduction</a></h3>

<p>Having proper data in place can be very hard when testing applications. Not only do you need different data sets to test different scenarios and equivalent classes, but also provide combinations that can be fundamental to catch bugs before they go to the production environment.<br />
Additionally, GeneXus applications are commonly data-intensive apps, which means that your tests will not only need a combination of data input but some data configured in your database to let tests run properly.</p>

<h3><a id="What+is+Database+Mocking%3F" class="HashLink" href="#What+is+Database+Mocking%3F">What is Database Mocking?</a></h3>

<p>Database Mocking is a technique that allows you to set the desired database state (for different tables) in your tests to let specific data sets ready for future test execution. Using this technique, you can focus on getting the test data-sets ready once (in a real database), and then use it on different test phases regarding the environments by using mocking. In other words, Database Mocking is a simulation of a database with few records.  </p>

<h3><a id="How+does+it+work%3F" class="HashLink" href="#How+does+it+work%3F">How does it work?</a></h3>

<p>Mocking works by recording data (SQLs / results) used for a test by listening for all sentences and responses during <strong>the recording stage</strong>. That information is stored (as <strong>mocking data</strong>) and will be used in all future executions of the test in different environments. During the recording, the queries are stored in order (order is relevant) so it is expected that the test will run the queries in the same order that was recorded. Consequently, if over time the tests navigation changes or queries are different, mocking data will need to be recorded again.</p>

<p>In case during test execution, the tests need some data that was not recorded during the recording stage, that query will use real database data sources to get the answer.</p>

<h3><a id="How+is+it+used%3F" class="HashLink" href="#How+is+it+used%3F">How is it used?</a></h3>

<p>To start the <strong>recording stage </strong>just right-click over a Unit Test and select the option &quot;Record Mocking Data&quot;.</p>

<p><img src="./images/50420.png" id="50420" class="WikiImage"/></p>

<p><strong>This will run the test </strong>you've selected using your current data sources/databases. So, ensure you have the database in the required state so your recording can be checked into GeneXus server and add value to your team.</p>

<p>Finally, once the test ends, <strong>mocking data</strong> will be stored in a KB file object associated with the test using its name. Thus, after having associated mocking data on a test, every time it runs it will use that previously recorded data without using the database.  </p>

<p>There are some properties in the unit tests where the mock information is stored. There is a boolean property for each generator that indicates if the test should be mocked and if this property is set to true, the KB object file containing the mock information.</p>

<p><img src="./images/50402.png" id="50402" class="WikiImage"/></p>

<p>Additionally, each mock file object is set to be extracted to its appropriate target environment.</p>

<h3><a id="Advanced" class="HashLink" href="#Advanced">Advanced</a></h3>

<p>In case you have dynamic data for your sentences, let's say, an auto number PK or a Date Time, for example, you may need to modify the recorded mock data so it works every time. To allow this you need to modify the type of matching by setting the field KeyPattern.</p>

<p>See an example in <a href="https://wiki.genexus.com/commwiki/wiki?50844,," target="_blank">this article</a></p>

<h3><a id="Sharing+mock+data" class="HashLink" href="#Sharing+mock+data">Sharing mock data</a></h3>

<p>Once you have your objects, tests, and mock data ready, you can commit these objects to GeneXus server and tests won't depend on the state of the database used by other developers and, more importantly, its success won't depend on the different environments used by your continuous integration pipeline either. If your test is successful in your local environment it will work the same in any other environment (as long as the version of the objects is the same of course).</p>

<h3><a id="Example" class="HashLink" href="#Example">Example</a></h3>

<p>See a showcase in <a href="https://wiki.genexus.com/commwiki/wiki?50429,," target="_blank">this article</a>.</p>

<h3><a id="Troubleshooting" class="HashLink" href="#Troubleshooting">Troubleshooting</a></h3>

<p>In case you have a file set for a test but no mock data is loaded, check that the File object is set to be extracted for the current generator.</p>

<p> </p>

<p style="text-align: justify;"></p>

<p></p>
</div><hr /><table id="Pages" class="Table" cellpadding="1" cellspacing="2" style=" width: 100%;" ><TR><TD><b>Backlinks</b></TD></TR><TR><TD><a href="38327.html">Toc:Automated Testing</a></TD><TD><a href="43807.html">Changelog GXtest</a></TD><TD><a href="50393.html">Database Mocking (GeneXus 17 Upgrade 9 or prior)</a></TD></TR><TR><TD><a href="46887.html">GXtest for GeneXus 17 Release Notes</a></TD><TD><a href="48326.html">GXtest Menu Commands (GeneXus 17 upgrade 4 or prior)</a></TD><TD><a href="49100.html">GXtest Menu Commands (GeneXus 17 upgrade 5)</a></TD></TR><TR><TD><a href="50208.html">GXtest Menu Commands (GeneXus 17 Upgrade 8 and prior)</a></TD><TD><a href="41571.html">GXtest v4 Licensing</a></TD><TD><a href="47894.html">GXtest v4 Licensing (GeneXus 17 upgrade 2 or prior)</a></TD><TD><a href="48384.html">GXtest v4 Licensing (GeneXus 17 upgrade 4 or prior)</a></TD></TR><TR><TD><a href="48711.html">GXtest v4 Licensing (GeneXus 17 upgrade 5)</a></TD><TD><a href="47575.html">Tests Explorer window</a></TD><TD><a href="47885.html">Tests Explorer window (GeneXus 17 upgrade 2 or prior)</a></TD><TD><a href="48014.html">Tests Explorer window (GeneXus 17 upgrade 3 or prior)</a></TD></TR></table>
</span></body>
</html><hr /><table id="Pages" class="Table" cellpadding="1" cellspacing="2" style=" width: 100%;" ><TR><td align="left"><font face="Verdana" size="1"><em>Source: <a href="https://wiki.genexus.com" target=_blank>wiki.genexus.com</a></em></font></td><td align="right"><font face="Verdana" size="1"><em>Last modification: 05/31/22 11:59 AM</em></font></td></TR></table></font>