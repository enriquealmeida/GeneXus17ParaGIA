<!DOCTYPE html>
<html>
<head>
<meta http-equiv=Content-Type content="text/html; charset=UTF-8">
<link rel="stylesheet" type="text/css" href="./images/WikiTheme2.css"/>
<link rel="stylesheet" type="text/css" href="./images/bootstrap.min.css"/>
<title>WeChat Pay API</title>
</head>
<body bgcolor="#FFFFFF" style="display: block;margin: 8px;"><span id="W0004BODY" class="WikiBody"><table border=0 width=100%><tr><td><div align="right"><FONT face=Verdana size=2><a href =https://wiki.genexus.com/commwiki/wiki?37322,, target=_"blank">Newest Version</a></FONT></div></td></tr></table><h1 class="WikiName">WeChat Pay API</h1>
<!--WeChat Pay API--><table class="TableWikiBody" id="tblwikibody"><tbody><tr><td><p>WeChat Pay API for GeneXus consists of an External Object and a group of Procedures, SDTs and Domains that can be used to interact with the WeChat Pay <a href="33545.html">Extension Library</a> to integrate payment capabilities when using WeChat Pay in the generated applications. For Android and iOS.</p>

<h2><a id="Versions" class="HashLink" href="#Versions">Versions</a></h2>

<p>Version 1.0 (Dec 11, 2017) - <a href="https://wiki.genexus.com/commwiki/wiki?37325,," target="_blank">Download</a>.  <strong><span style="color: rgb(255,0,0);">Latest</span>!</strong></p>

<h2><a id="Structure" class="HashLink" href="#Structure">Structure</a></h2>

<p><img src="./images/37326.png" id="37326" class="WikiImage"/></p>

<h2><a id="External+Object" class="HashLink" href="#External+Object">External Object</a></h2>

<h3><a id="WeChatPayProvider" class="HashLink" href="#WeChatPayProvider"><strong>WeChatPayProvider</strong></a></h3>

<p><br />
<em>Method</em></p>

<table border="1" cellpadding="1" cellspacing="1">
	<tbody>
		<tr>
			<td style="background-color: rgb(204,204,204);"><strong>Name</strong></td>
			<td>Pay</td>
		</tr>
		<tr>
			<td style="background-color: rgb(204,204,204);"><strong>Description     </strong></td>
			<td>Used to perform the payment transaction with WeChat Pay   </td>
		</tr>
		<tr>
			<td style="background-color: rgb(204,204,204);"><strong>Parameters  </strong></td>
			<td><i>PaymentInformation</i>: SDT(PaymentInformation)</td>
		</tr>
		<tr>
			<td style="background-color: rgb(204,204,204);"><strong>Returns</strong></td>
			<td>None</td>
		</tr>
	</tbody>
</table>

<p><br />
<em>Properties</em></p>

<table border="1" cellpadding="1" cellspacing="1">
	<tbody>
		<tr>
			<td style="background-color: rgb(204,204,204);"><strong>Name</strong></td>
			<td style="background-color: rgb(204,204,204);"><strong>Description</strong></td>
		</tr>
		<tr>
			<td>ErrorCode</td>
			<td>ErrorCode with the result of Pay method   </td>
		</tr>
		<tr>
			<td>ErrorDescription<em>     </em></td>
			<td>ErrorDescription with the result of Pay method</td>
		</tr>
	</tbody>
</table>

<p><br />
<em>Event</em> </p>

<table border="1" cellpadding="1" cellspacing="1">
	<tbody>
		<tr>
			<td style="background-color: rgb(204,204,204);"><strong>Name</strong></td>
			<td>OnPaymentFinished</td>
		</tr>
		<tr>
			<td style="background-color: rgb(204,204,204);"><strong>Description</strong></td>
			<td>Triggered when the payment transaction in WeChat Pay is completed.   </td>
		</tr>
		<tr>
			<td style="background-color: rgb(204,204,204);"><strong>Parameters     </strong></td>
			<td><i>PaymentResult</i>: SDT(PaymentResult)</td>
		</tr>
		<tr>
			<td style="background-color: rgb(204,204,204);"><strong>Returns</strong></td>
			<td>None</td>
		</tr>
	</tbody>
</table>

<h2><a id="Domains" class="HashLink" href="#Domains">Domains</a></h2>

<h3><a id="Environment+%28CommonPay%29" class="HashLink" href="#Environment+%28CommonPay%29"><strong>Environment (CommonPay)</strong></a></h3>

<p>The environment where the payment transaction will be executed.</p>

<table border="1" cellpadding="1" cellspacing="1">
	<tbody>
		<tr>
			<td style="background-color: rgb(221,221,221);"><strong>Value</strong></td>
			<td style="background-color: rgb(221,221,221);"><strong>Description</strong></td>
		</tr>
		<tr>
			<td><em>Production   </em></td>
			<td>Production environment, transactions are real   </td>
		</tr>
		<tr>
			<td><em>Sandbox  </em></td>
			<td>Test environment </td>
		</tr>
	</tbody>
</table>

<h3><a id="ReturnCode+%28WeChatPay%29" class="HashLink" href="#ReturnCode+%28WeChatPay%29"><strong>ReturnCode (WeChatPay)</strong></a></h3>

<p>Return values to send to WeChat Pay in the response to the asynchronous notification service.</p>

<table border="1" cellpadding="1" cellspacing="1">
	<tbody>
		<tr>
			<td style="background-color: rgb(221,221,221);"><strong>Value</strong></td>
			<td style="background-color: rgb(221,221,221);"><strong>Description   </strong></td>
		</tr>
		<tr>
			<td><em>Success   </em></td>
			<td>SUCCESS</td>
		</tr>
		<tr>
			<td><em>Fail  </em></td>
			<td>FAIL</td>
		</tr>
	</tbody>
</table>

<h2><a id="Structured+data+types" class="HashLink" href="#Structured+data+types">Structured data types</a></h2>

<h3><a id="Configuration+%28CommonPay%29" class="HashLink" href="#Configuration+%28CommonPay%29"><strong>Configuration (CommonPay)</strong></a></h3>

<p>Used to make all the settings needed to perform the payment transactions.</p>

<table border="1" cellpadding="1" cellspacing="1">
	<tbody>
		<tr>
			<td colspan="3" style="background-color: rgb(204,204,204);"><strong>Field</strong></td>
			<td style="background-color: rgb(204,204,204);"><strong>Domain</strong></td>
			<td style="background-color: rgb(204,204,204);"><strong>Description</strong></td>
		</tr>
		<tr>
			<td colspan="3">AppId</td>
			<td>VarChar(40)</td>
			<td>Application ID obtained when the application was <a href="https://wiki.genexus.com/commwiki/wiki?37323,," target="_blank">registered</a> in WeChat Open Platform site.</td>
		</tr>
		<tr>
			<td colspan="3">Environment</td>
			<td>Environment</td>
			<td>Environment where the payment transaction will be executed.</td>
		</tr>
		<tr>
			<td colspan="3">CertificateFilename</td>
			<td>VarChar(200)  </td>
			<td><em>Not used for WeChat Pay</em></td>
		</tr>
		<tr>
			<td colspan="3">CertificatePassword  </td>
			<td>VarChar(40)</td>
			<td><em>Not used for WeChat Pay</em></td>
		</tr>
		<tr>
			<td colspan="3">CallbackURL</td>
			<td>URL</td>
			<td>URL of the payment notification service</td>
		</tr>
		<tr>
			<td colspan="3">Timeout</td>
			<td>Numeric(4.0)</td>
			<td>Timeout in minutes for the payment transaction</td>
		</tr>
		<tr>
			<td colspan="3">MerchantId</td>
			<td>VarChar(40)</td>
			<td>Identifier of the user registered in WeChat Open Platform</td>
		</tr>
		<tr>
			<td colspan="3">MerchantKey</td>
			<td>VarChar(80)</td>
			<td>Key assigned to the application in WeChat Open Platform</td>
		</tr>
		<tr>
			<td colspan="3">AdditionalConfig</td>
			<td><em>&lt;Collection&gt;</em></td>
			<td>Additional information for the application configuration</td>
		</tr>
		<tr>
			<td> </td>
			<td colspan="2">Name</td>
			<td>VarChar(40)</td>
			<td>Name of the additional information</td>
		</tr>
		<tr>
			<td> </td>
			<td colspan="2">Value</td>
			<td>VarChar(200)</td>
			<td>Value of the additional information.</td>
		</tr>
	</tbody>
</table>

<h3><a id="PaymentResult+%28CommonPay%29" class="HashLink" href="#PaymentResult+%28CommonPay%29"><strong>PaymentResult (CommonPay)</strong></a></h3>

<p>Information sent to the <em>OnPaymentFinished</em> event of the WeChatPayProvider ExternalObject</p>

<table border="1" cellpadding="1" cellspacing="1">
	<tbody>
		<tr>
			<td colspan="3" style="background-color: rgb(204,204,204);"><strong>Field</strong></td>
			<td style="background-color: rgb(204,204,204);"><strong>Domain</strong></td>
			<td style="background-color: rgb(204,204,204);"><strong>Description</strong></td>
		</tr>
		<tr>
			<td colspan="3">ErrorCode</td>
			<td>Numeric(4.0)</td>
			<td>Error code for the payment transaction result</td>
		</tr>
		<tr>
			<td colspan="3">ErrorDescription  </td>
			<td>VarChar(200)</td>
			<td>Error description for the payment transaction result</td>
		</tr>
		<tr>
			<td colspan="3">OrderNumber</td>
			<td>VarChar(40)</td>
			<td>Order number of the completed payment transaction. Can be used for payment processing in the application.</td>
		</tr>
		<tr>
			<td colspan="3">AdditionalInfo</td>
			<td>LongVarChar(2M)  </td>
			<td>Additional information returned from the payment transaction.</td>
		</tr>
	</tbody>
</table>

<h3><a id="PaymentApplicationData+%28WeChatPay%29" class="HashLink" href="#PaymentApplicationData+%28WeChatPay%29"><strong>PaymentApplicationData (WeChatPay)</strong></a></h3>

<p>Used to set payment data entered by the user (product descriptions, currency, amount) and input of the <em>GetPaymentInformation</em> procedure.</p>

<table border="1" cellpadding="1" cellspacing="1">
	<tbody>
		<tr>
			<td colspan="3" style="background-color: rgb(204,204,204);"><strong>Field</strong></td>
			<td style="background-color: rgb(204,204,204);"><strong>Domain</strong></td>
			<td style="background-color: rgb(204,204,204);"><strong>Description</strong></td>
		</tr>
		<tr>
			<td colspan="3">ProductCode</td>
			<td>Character(128)   </td>
			<td>Code of the product or products involved in the payment</td>
		</tr>
		<tr>
			<td colspan="3">ProductDescription   </td>
			<td>VarChar(200)</td>
			<td>Description of the product or products involved in the payment</td>
		</tr>
		<tr>
			<td colspan="3">Currency</td>
			<td>Character(3)</td>
			<td>Currency for the payment transaction</td>
		</tr>
		<tr>
			<td colspan="3">TotalAmount</td>
			<td>Amount</td>
			<td>Amount of the payment transaction</td>
		</tr>
		<tr>
			<td colspan="3">RandomString</td>
			<td>Character(32)</td>
			<td><em>Not set by the user. </em>Random value used in the WeChat Pay communication.  </td>
		</tr>
		<tr>
			<td colspan="3">OrderNumber</td>
			<td>Character(64)</td>
			<td><em>Not set by the user.</em> Order number for the payment transaction.</td>
		</tr>
	</tbody>
</table>

<h3><a id="PaymentInfoParameters+%28WeChatPay%29" class="HashLink" href="#PaymentInfoParameters+%28WeChatPay%29"><strong>PaymentInfoParameters (WeChatPay)</strong></a></h3>

<p>Structure used by the <em>GetPaymentInformation</em> procedure to make two intermediate actions when preparing the payment transaction. It is managed automatically by the API, and there is no need for the developer to handle it while coding the integration.</p>

<table border="1" cellpadding="1" cellspacing="1">
	<tbody>
		<tr>
			<td colspan="3" style="background-color: rgb(204,204,204);"><strong>Field</strong></td>
			<td style="background-color: rgb(204,204,204);"><strong>Domain</strong></td>
			<td style="background-color: rgb(204,204,204);"><strong>Description</strong></td>
		</tr>
		<tr>
			<td colspan="3">AppId</td>
			<td>Character(32)</td>
			<td>Application ID obtained when the application was <a href="https://wiki.genexus.com/commwiki/wiki?37154,," target="_blank">registered</a> in the Alipay developer's site.</td>
		</tr>
		<tr>
			<td colspan="3">MerchantId</td>
			<td>Character(32)   </td>
			<td>Identifier of the user registered in WeChat Open Platform</td>
		</tr>
		<tr>
			<td colspan="3">MerchantKey</td>
			<td>Character(64)</td>
			<td>Key assigned to the application in WeChat Open Platform</td>
		</tr>
		<tr>
			<td colspan="3">DeviceId</td>
			<td>Character(32)</td>
			<td>Identifier of the device that is making the transaction (<em>ClientInformation.Id</em> value is used)</td>
		</tr>
		<tr>
			<td colspan="3">RandomString</td>
			<td>Character(32)</td>
			<td>Random value used in the WeChat Pay communication</td>
		</tr>
		<tr>
			<td colspan="3">Signature</td>
			<td>Character(32)</td>
			<td>Signature of the transaction parameters</td>
		</tr>
		<tr>
			<td colspan="3">SignatureType</td>
			<td>SignatureType</td>
			<td><em>Fixed value : HMACSHA256</em></td>
		</tr>
		<tr>
			<td colspan="3">ProductDescription</td>
			<td>Character(128)</td>
			<td>Description of the product or products involved in the payment</td>
		</tr>
		<tr>
			<td colspan="3">OrderNumber</td>
			<td>Character(32)</td>
			<td>Order number for the payment transaction</td>
		</tr>
		<tr>
			<td colspan="3">Currency</td>
			<td>Character(3)</td>
			<td>Currency for the payment transaction</td>
		</tr>
		<tr>
			<td colspan="3">TotalAmount</td>
			<td>Numeric(9.0)</td>
			<td>Amount of the payment transaction</td>
		</tr>
		<tr>
			<td colspan="3">TransactionStartTime  </td>
			<td>Character(14)</td>
			<td>Time when transaction starts</td>
		</tr>
		<tr>
			<td colspan="3">NotificationAddress</td>
			<td>Character(256)  </td>
			<td>URL of the payment notification service</td>
		</tr>
		<tr>
			<td colspan="3">TransactionType</td>
			<td>Character(16)</td>
			<td><em>Fixed value: APP</em></td>
		</tr>
		<tr>
			<td colspan="3">PrepayId</td>
			<td>Character(32)</td>
			<td>Transaction identifier returned by WeChat Pay servers before performing the payment</td>
		</tr>
		<tr>
			<td colspan="3">Timestamp</td>
			<td>Character(20)</td>
			<td>Current time when preparing the payment</td>
		</tr>
		<tr>
			<td colspan="3">Package</td>
			<td>Character(128)</td>
			<td><em>Fixed value: Sign=WXPay.</em></td>
		</tr>
	</tbody>
</table>

<h3><a id="PaymentInformation+%28WeChatPay%29" class="HashLink" href="#PaymentInformation+%28WeChatPay%29"><strong>PaymentInformation (WeChatPay)</strong></a></h3>

<p>Information returned by the <em>GetPaymentInformation</em> procedure to be sent to WeChat Pay to perform the payment.</p>

<table border="1" cellpadding="1" cellspacing="1">
	<tbody>
		<tr>
			<td colspan="3" style="background-color: rgb(204,204,204);"><strong>Field</strong></td>
			<td style="background-color: rgb(204,204,204);"><strong>Domain</strong></td>
			<td style="background-color: rgb(204,204,204);"><strong>Description</strong></td>
		</tr>
		<tr>
			<td colspan="3">ErrorCode</td>
			<td>Numeric(10.0)</td>
			<td>Error code returned by the <em>GetPaymentInformation</em> procedure</td>
		</tr>
		<tr>
			<td colspan="3">ErrorDescription   </td>
			<td>Character(128)</td>
			<td>Error description returned by the <em>GetPaymentInformation</em> procedure</td>
		</tr>
		<tr>
			<td colspan="3">AppId</td>
			<td>Character(32)</td>
			<td>Application ID obtained when the application was <a href="https://wiki.genexus.com/commwiki/wiki?37154,," target="_blank">registered</a> in the Alipay developer's site.</td>
		</tr>
		<tr>
			<td colspan="3">MerchantId</td>
			<td>Character(32)</td>
			<td>Identifier of the user registered in WeChat Open Platform</td>
		</tr>
		<tr>
			<td colspan="3">OrderNumber</td>
			<td>Character(32)</td>
			<td>Order number for the payment transaction</td>
		</tr>
		<tr>
			<td colspan="3">DeviceId</td>
			<td>Character(32)</td>
			<td>Identifier of the device that is making the transaction (<em>ClientInformation.Id</em> value is used)</td>
		</tr>
		<tr>
			<td colspan="3">RandomString</td>
			<td>Character(32)</td>
			<td>Random value used in the WeChat Pay communication</td>
		</tr>
		<tr>
			<td colspan="3">Signature</td>
			<td>Character(32)</td>
			<td>Signature of the transaction parameters</td>
		</tr>
		<tr>
			<td colspan="3">SignatureParameters  </td>
			<td>LongVarChar(2M)  </td>
			<td>Parameters sent to WeChat Pay that were signed</td>
		</tr>
		<tr>
			<td colspan="3">TransactionType</td>
			<td>Character(16)</td>
			<td><em>Fixed value: APP</em></td>
		</tr>
		<tr>
			<td colspan="3">PrepayId</td>
			<td>Character(64)</td>
			<td>Transaction identifier returned by WeChat Pay servers before performing the payment</td>
		</tr>
		<tr>
			<td colspan="3">Timestamp</td>
			<td>Character(20)</td>
			<td>Current time when preparing the payment</td>
		</tr>
		<tr>
			<td colspan="3">Package</td>
			<td>Character(20)</td>
			<td><em>Fixed value: Sign=WXPay</em></td>
		</tr>
		<tr>
			<td colspan="3">ReturnCode</td>
			<td>Character(20)</td>
			<td>Code returned by the WeChat Pay servers when sending payment information</td>
		</tr>
		<tr>
			<td colspan="3">ReturnMessage</td>
			<td>Character(20)</td>
			<td>Message returned by the WeChat Pay servers when sending payment information</td>
		</tr>
		<tr>
			<td colspan="3">BusinessResult</td>
			<td>Character(16)</td>
			<td>Additional info returned by the WeChat Pay servers when sending payment information.</td>
		</tr>
	</tbody>
</table>

<h3><a id="PaymentNotificationInfo+%28WeChatPay%29" class="HashLink" href="#PaymentNotificationInfo+%28WeChatPay%29"><strong>PaymentNotificationInfo (WeChatPay)</strong></a></h3>

<p>Information sent by WeChat Pay to the asynchronous payment notification service. This information can be used by the developer in the <em>CallbackHandler</em> procedure.</p>

<table border="1" cellpadding="1" cellspacing="1">
	<tbody>
		<tr>
			<td colspan="3" style="background-color: rgb(204,204,204);"><strong>Field</strong></td>
			<td style="background-color: rgb(204,204,204);"><strong>Domain</strong></td>
			<td style="background-color: rgb(204,204,204);"><strong>Description   </strong></td>
		</tr>
		<tr>
			<td colspan="3">AppId</td>
			<td>DateTime</td>
			<td> </td>
		</tr>
		<tr>
			<td colspan="3">PaymentBank</td>
			<td>Character(64)</td>
			<td> </td>
		</tr>
		<tr>
			<td colspan="3">CashPaymentAmount</td>
			<td>Character(128)   </td>
			<td> </td>
		</tr>
		<tr>
			<td colspan="3">DeviceId</td>
			<td>Character(32)</td>
			<td> </td>
		</tr>
		<tr>
			<td colspan="3">CurrencyType</td>
			<td>Character(10)</td>
			<td> </td>
		</tr>
		<tr>
			<td colspan="3">IsSuscriber</td>
			<td>Character(3)</td>
			<td> </td>
		</tr>
		<tr>
			<td colspan="3">MerchantId</td>
			<td>Character(10)</td>
			<td> </td>
		</tr>
		<tr>
			<td colspan="3">RandomString</td>
			<td>Character(256)</td>
			<td> </td>
		</tr>
		<tr>
			<td colspan="3">UserTag</td>
			<td>Character(64)</td>
			<td> </td>
		</tr>
		<tr>
			<td colspan="3">MerchantTradeNumber</td>
			<td>Character(64)</td>
			<td> </td>
		</tr>
		<tr>
			<td colspan="3">ResultCode</td>
			<td>Character(64)</td>
			<td> </td>
		</tr>
		<tr>
			<td colspan="3">BusinessResult</td>
			<td>Character(16)</td>
			<td> </td>
		</tr>
		<tr>
			<td colspan="3">Signature</td>
			<td>Character(100)</td>
			<td> </td>
		</tr>
		<tr>
			<td colspan="3">PaymentEndTime</td>
			<td>Character(30)</td>
			<td> </td>
		</tr>
		<tr>
			<td colspan="3">TransactionType</td>
			<td>Email</td>
			<td> </td>
		</tr>
		<tr>
			<td colspan="3">TransactionId</td>
			<td>TradeStatus</td>
			<td> </td>
		</tr>
		<tr>
			<td colspan="3">TotalAmount</td>
			<td>Amount</td>
			<td> </td>
		</tr>
	</tbody>
</table>

<h3><a id="PaymentNotificationResult+%28WeChatPay%29" class="HashLink" href="#PaymentNotificationResult+%28WeChatPay%29"><strong>PaymentNotificationResult (WeChatPay)</strong></a></h3>

<p>Information used to return a result to WeChat Pay when the asynchronous payment notification service is called. A variable of this type is returned by the <em>CallbackHandler</em> procedure.</p>

<table border="1" cellpadding="1" cellspacing="1">
	<tbody>
		<tr>
			<td colspan="3" style="background-color: rgb(204,204,204);"><strong>Field</strong></td>
			<td style="background-color: rgb(204,204,204);"><strong>Domain</strong></td>
			<td style="background-color: rgb(204,204,204);"><strong>Description   </strong></td>
		</tr>
		<tr>
			<td colspan="3">ReturnCode</td>
			<td>ReturnCode</td>
			<td> </td>
		</tr>
		<tr>
			<td colspan="3">ReturnMessage   </td>
			<td>VarChar(100)   </td>
			<td> </td>
		</tr>
	</tbody>
</table>

<h3><a id="SandboxPaymentInfo+%28WeChatPay%29" class="HashLink" href="#SandboxPaymentInfo+%28WeChatPay%29"><strong>SandboxPaymentInfo (WeChatPay)</strong></a></h3>

<p>Information returned by WeChat Pay servers when using the sandbox environment. This information has then to be set in a <em>PaymentInformation</em> variable to be returned by the <em>GetPaymentInformation</em> procedure.</p>

<table border="1" cellpadding="1" cellspacing="1">
	<tbody>
		<tr>
			<td colspan="3" style="background-color: rgb(204,204,204);"><strong>Field</strong></td>
			<td style="background-color: rgb(204,204,204);"><strong>Domain</strong></td>
			<td style="background-color: rgb(204,204,204);"><strong>Description</strong></td>
		</tr>
		<tr>
			<td colspan="3">AppId</td>
			<td>Character(32)</td>
			<td>Application ID obtained when the application was <a href="https://wiki.genexus.com/commwiki/wiki?37154,," target="_blank">registered</a> in the Alipay developer's site.</td>
		</tr>
		<tr>
			<td colspan="3">MerchantId</td>
			<td>Character(32)  </td>
			<td>Identifier of the user registered in WeChat Open Platform</td>
		</tr>
		<tr>
			<td colspan="3">RandomString  </td>
			<td>Character(32)</td>
			<td>Random value used in the WeChat Pay communication</td>
		</tr>
		<tr>
			<td colspan="3">Signature</td>
			<td>Character(32)</td>
			<td>Signature of the transaction parameters</td>
		</tr>
		<tr>
			<td colspan="3">PrepayId</td>
			<td>Character(64)</td>
			<td>Transaction identifier returned by WeChat Pay servers before performing the payment</td>
		</tr>
		<tr>
			<td colspan="3">Timestamp</td>
			<td>Character(20)</td>
			<td>Current time when preparing the payment</td>
		</tr>
		<tr>
			<td colspan="3">Package</td>
			<td>Character(20)</td>
			<td><em>Fixed value: Sign=WXPay.</em></td>
		</tr>
	</tbody>
</table>

<h2><a id="Procedures" class="HashLink" href="#Procedures">Procedures</a></h2>

<h3><a id="LoadConfig+%28CommonPay%29" class="HashLink" href="#LoadConfig+%28CommonPay%29"><strong>LoadConfig (CommonPay)</strong></a></h3>

<p>Loads the configuration needed to perform the payment with WeChat Pay. By default, it reads the information from the WeChatPay_Config.xml file.</p>

<table border="1" cellpadding="1" cellspacing="1">
	<tbody>
		<tr>
			<td style="background-color: rgb(204,204,204);"><strong>Parameters     </strong></td>
			<td><i>PaymentProvider</i>: Alipay</td>
		</tr>
		<tr>
			<td style="background-color: rgb(204,204,204);"><strong>Returns</strong></td>
			<td><i>Configuration</i>:SDT(Configuration)   </td>
		</tr>
	</tbody>
</table>

<h3><a id="GetPaymentInformation+%28WeChatPay%29" class="HashLink" href="#GetPaymentInformation+%28WeChatPay%29"><strong>GetPaymentInformation (WeChatPay)</strong></a></h3>

<p>Processes the payment data given by the user and returns all the required information (signed) ready to be sent to WeChat Pay.</p>

<table border="1" cellpadding="1" cellspacing="1">
	<tbody>
		<tr>
			<td style="background-color: rgb(204,204,204);"><strong>Parameters     </strong></td>
			<td><i>PaymentApplicationData</i>: SDT(PaymentApplicationData)   </td>
		</tr>
		<tr>
			<td style="background-color: rgb(204,204,204);"><strong>Returns</strong></td>
			<td><i>PaymentInformation</i>: SDT(PaymentInformation)</td>
		</tr>
	</tbody>
</table>

<h3><a id="OnAboutToPay+%28WeChatPay%29" class="HashLink" href="#OnAboutToPay+%28WeChatPay%29"><strong>OnAboutToPay (WeChatPay)</strong></a></h3>

<p>Used to process the payment data just before it is sent to WeChat Pay. One common use is to store the payment information (especially the OrderNumber) in the application database tables.</p>

<table border="1" cellpadding="1" cellspacing="1">
	<tbody>
		<tr>
			<td style="background-color: rgb(204,204,204);"><strong>Parameters     </strong></td>
			<td><i>PaymentApplicationData</i>: SDT(PaymentApplicationData)   </td>
		</tr>
		<tr>
			<td style="background-color: rgb(204,204,204);"><strong>Returns</strong></td>
			<td>-</td>
		</tr>
	</tbody>
</table>

<h3><a id="CallbackService+%28WeChatPay%29" class="HashLink" href="#CallbackService+%28WeChatPay%29"><strong>CallbackService (WeChatPay)</strong></a></h3>

<p>HTTP Procedure. Asynchronous payment notification service called by WeChat Pay servers after the payment process is completed. It turns the HTTP information into an SDT (<em>PaymentNotificationInfo</em>) and calls CallbackHandler procedure.</p>

<table border="1" cellpadding="1" cellspacing="1">
	<tbody>
		<tr>
			<td style="background-color: rgb(204,204,204);"><strong>Parameters     </strong></td>
			<td><i>-</i></td>
		</tr>
		<tr>
			<td style="background-color: rgb(204,204,204);"><strong>Returns</strong></td>
			<td><i>PaymentNotificationResult</i>: SDT(PaymentNotificationResult) </td>
		</tr>
	</tbody>
</table>

<h3><a id="CallbackHandler+%28Alipay%29" class="HashLink" href="#CallbackHandler+%28Alipay%29"><strong>CallbackHandler (Alipay)</strong></a></h3>

<p>Used to process the data sent by WeChat Pay servers when calling the asynchronous payment notification service.</p>

<table border="1" cellpadding="1" cellspacing="1">
	<tbody>
		<tr>
			<td style="background-color: rgb(204,204,204);"><strong>Parameters     </strong></td>
			<td><i>PaymentNotificationInfo</i>: SDT(PaymentNotificationInfo)   </td>
		</tr>
		<tr>
			<td style="background-color: rgb(204,204,204);"><strong>Returns</strong></td>
			<td><i>PaymentNotificationResult</i>: SDT(PaymentNotificationResult)</td>
		</tr>
	</tbody>
</table>

<h4><a id="" class="HashLink" href="#"></a></h4>
<br /></td></tr></tbody></table><hr /><table id="Pages" class="Table" cellpadding="1" cellspacing="2" style=" width: 100%;" ><TR><TD><b>Backlinks</b></TD></TR><TR><TD><a href="45383.html">App Id property</a></TD><TD><a href="37321.html">HowTo: Pay using WeChat Pay in GeneXus applications</a></TD><TD><a href="46593.html">Integration and Evolution with GeneXus 17</a></TD></TR><TR></TR></table>
</span></body>
</html><hr /><table id="Pages" class="Table" cellpadding="1" cellspacing="2" style=" width: 100%;" ><TR><td align="left"><font face="Verdana" size="1"><em>Source: <a href="https://wiki.genexus.com" target=_blank>wiki.genexus.com</a></em></font></td><td align="right"><font face="Verdana" size="1"><em>Last modification: 07/31/20 01:21 PM</em></font></td></TR></table></font>