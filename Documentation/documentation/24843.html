<!DOCTYPE html>
<html>
<head>
<meta http-equiv=Content-Type content="text/html; charset=UTF-8">
<link rel="stylesheet" type="text/css" href="./images/WikiTheme2.css"/>
<link rel="stylesheet" type="text/css" href="./images/bootstrap.min.css"/>
<title>When duplicate clause</title>
</head>
<body bgcolor="#FFFFFF" style="display: block;margin: 8px;"><span id="W0004BODY" class="WikiBody"><table border=0 width=100%><tr><td><div align="right"><FONT face=Verdana size=2><a href =https://wiki.genexus.com/commwiki/wiki?24843,, target=_"blank">Newest Version</a></FONT></div></td></tr></table><h1 class="WikiName">When duplicate clause</h1>
<!--When duplicate clause--><table class="TableWikiBody" id="tblwikibody"><tbody><tr><td><p>Allows to specify the code to be executed when a body of a <a href="24744.html">For Each command</a> or <a href="6714.html">New command</a> is trying to update or create (respectively) a record with a value for a candidate Key (in for each case) and/or primary key (in new case) attribute that has already exists for another record. </p>

<p>It only makes sense in procedures (because it has to do with updates).</p>

<h3><a id="Syntax" class="HashLink" href="#Syntax">Syntax</a></h3>

<p style="margin-left: 40.0px;"><strong>When duplicate</strong></p>

<p style="margin-left: 80.0px;"><em>&lt;CodeWhenDuplicate&gt;</em></p>

<p>GeneXus uses the unique index to ensure the uniqueness of that candidate key, as well as the primary index for the primary key. In case it finds duplicates, if this clause is programmed in the For Each/New command, it will execute its related code (<em>&lt;CodeWhenDuplicate&gt;</em>).</p>

<p>If the clause is not included, and you try to update an attribute that is a candidate key (for each) or assign value to a candidate or primary key (new) and a record with that value already exists, no code will be executed.</p>

<p>About <strong>New command</strong>: most of the times an update of some attributes of that existing record is needed. In these cases a <a href="24744.html">For Each command</a> is needed. Inside, the attributes to be updated are assigned. Although not so common, other commands can be executed as well. That is:</p>

<table border="0" cellpadding="1" cellspacing="1">
	<tbody>
		<tr>
			<td><em>      &lt;CodeWhenDuplicate&gt;</em> ::= </td>
			<td> [<em>&lt;AnotherCode&gt;</em>]</td>
		</tr>
		<tr>
			<td> </td>
			<td>
			<p><strong> For each</strong><br />
			     { <em>&lt;attribute&gt;</em> = <em>&lt;expr&gt; </em>} ...<br />
			<strong>endfor</strong></p>
			</td>
		</tr>
		<tr>
			<td> </td>
			<td>[<em>&lt;AnotherCode&gt;</em>]</td>
		</tr>
	</tbody>
</table>

<h4><a id="Note%3A" class="HashLink" href="#Note%3A">Note:</a></h4>

<ul>
	<li><strong>Inside For each</strong>: If another For Each command is included into the <em>&lt;CodeWhenDuplicate&gt;</em>, and its table has same common attribute with the external For Each (that of <em>&lt;MainCode&gt;)</em>, this attribute will be considered as instantiated, acting as a filters in the When Duplicate For Each.</li>
</ul>

<p>For more detailed information for each command, see the sintax section in <a href="24744.html">For Each command</a>, and <a href="6714.html">New command</a>.</p>

<h3><a id="Example" class="HashLink" href="#Example">Example</a></h3>

<p>If the CustomerName attribute is a candidate Key (there exists a unique index) in the Customer table, and we are trying to update it for many records accessed by means of a for each:</p>

<pre class="prettyprint lang-genexus" style="max-width: 100%">
for each Customer

    CustomerName = &amp;customer

<strong>when duplicate</strong>

    msg( ' The customer ' + &amp;customer + 'already exists')

endfor</pre>

<p>when there already exists a record with the value contained in &amp;customer, the for each main code is not executed. Instead, the when duplicate code will be executed.</p>

<h3><a id="Scope" class="HashLink" href="#Scope">Scope</a></h3>

<table border="0" cellpadding="1" cellspacing="1" style="width: 500.0px;">
	<tbody>
		<tr>
			<td><strong>Commands</strong></td>
			<td><a href="24744.html">For Each command</a>, <a href="8596.html">Xfor Each command</a>, <a href="6714.html">New command</a></td>
		</tr>
		<tr>
			<td><strong>Objects</strong></td>
			<td><a href="6293.html">Procedure object</a></td>
		</tr>
		<tr>
			<td> </td>
			<td> </td>
		</tr>
	</tbody>
</table>

<p><br />
</p>

<p><br />
<br />
</p>
<br /><br /></td></tr></tbody></table><script src="./images/run_prettify.js?lang=genexus"></script><hr /><table id="Pages" class="Table" cellpadding="1" cellspacing="2" style=" width: 100%;" ><TR><TD><b>Backlinks</b></TD></TR><TR><TD><a href="24744.html">For Each command</a></TD><TD><a href="6442.html">Inline Formulas outside a contextual table</a></TD></TR><TR><TD><a href="6714.html">New command</a></TD></TR></table>
</span></body>
</html><hr /><table id="Pages" class="Table" cellpadding="1" cellspacing="2" style=" width: 100%;" ><TR><td align="left"><font face="Verdana" size="1"><em>Source: <a href="https://wiki.genexus.com" target=_blank>wiki.genexus.com</a></em></font></td><td align="right"><font face="Verdana" size="1"><em>Last modification: 07/31/20 01:21 PM</em></font></td></TR></table></font>