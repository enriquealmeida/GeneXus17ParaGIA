<!DOCTYPE html>
<html>
<head>
<meta http-equiv=Content-Type content="text/html; charset=UTF-8">
<link rel="stylesheet" type="text/css" href="./images/WikiTheme2.css"/>
<link rel="stylesheet" type="text/css" href="./images/bootstrap.min.css"/>
<title>Microsoft Exchange OAuth 2.0 for emails: Generation and data collection from the Administrator</title>
</head>
<body bgcolor="#FFFFFF" style="display: block;margin: 8px;"><span id="W0004BODY" class="WikiBody"><table border=0 width=100%><tr><td><div align="right"><FONT face=Verdana size=2><a href =https://wiki.genexus.com/commwiki/wiki?50396,, target=_"blank">Newest Version</a></FONT></div></td></tr></table><h1 class="WikiName">Microsoft Exchange OAuth 2.0 for emails: Generation and data collection from the Administrator</h1>
<!--Microsoft Exchange OAuth 2.0 for emails: Generation and data collection from the Administrator--><div class="TableWikiBody" id="tblwikibody"><p id="tw-target-text">In this article, you will find the necessary steps to provide data to connect to the mailbox through <a href='https://help.salesforce.com/s/articleView?id=sf.lightning_sync_admin_security_connection_oauth.htm&amp;type=5'>Microsoft Exchange OAuth 2.0</a>.</p>

<p>Example: Application administrators have to provide the necessary data to the programmers (at their request) so that they can connect to their mailbox.</p>

<h2><a id="Steps" class="HashLink" href="#Steps">Steps</a></h2>

<p>You need to follow these 3 steps to provide data through Microsoft Exchange OAuth:</p>

<ol>
	<li><a href='https://docs.microsoft.com/en-us/azure/active-directory/develop/quickstart-register-app#register-an-application'>OAuth Application Registration</a></li>
	<li><a href='https://docs.microsoft.com/en-us/azure/active-directory/develop/quickstart-register-app#register-an-application'>Authentication Code Generation</a></li>
	<li><a href="50396.html">Refresh Token Generation</a></li>
</ol>

<p> </p>

<h3><a id="1.+OAuth+Application+Registration" class="HashLink" href="#1.+OAuth+Application+Registration">1. OAuth Application Registration</a></h3>

<p>A) Follow this tutorial from Microsoft: <a href='https://docs.microsoft.com/en-us/azure/active-directory/develop/quickstart-register-app#register-an-application'>Register an application with the Microsoft identity platform</a>. Execute all steps of the &quot;Register an application&quot; section (8 steps in total).</p>

<p>B) Now you have to configure the platform settings. To do so, follow these steps: <a href='https://docs.microsoft.com/en-us/azure/active-directory/develop/quickstart-register-app#configure-platform-settings'>Configure platforms settings</a> (4 steps in total). </p>

<p>C) In step 4, select &quot;Mobile and desktop Applications&quot; as Platform and continue.</p>

<p>D) A new window called Configure Desktop + devices is opened. </p>

<p>Select the Redirect URI: https://login.microsoftonline.com/common/oauth2/nativeclient and confirm.</p>

<h3><a id="+" class="HashLink" href="#+"> </a></h3>

<h3><a id="2.+Authentication+Code+Generation" class="HashLink" href="#2.+Authentication+Code+Generation">2. Authentication Code Generation</a></h3>

<p id="tw-target-text">After registering the application, you can start the code authorization request process.</p>

<p id="tw-target-text">A) Get the Application (client) ID of the newly created Application:</p>

<p><img src="./images/50405.png" id="50405" class="WikiImage"/></p>

<p>You can find it by clicking on the <strong>overview</strong> window, below &quot;Display Name.&quot;</p>

<p id="tw-target-text">B) Open a browser and execute the following URL. The &quot;Client_id&quot; data must be replaced by that of the newly created Application:</p>

<pre class="prettyprint lang-genexus" style="max-width: 100%">
https://login.microsoftonline.com/organizations/oauth2/v2.0/authorize?
client_id=<strong>xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx</strong>
&amp;response_type=code
&amp;redirect_uri=https%3A%2F%2Flogin.microsoftonline.com%2Fcommon%2Foauth2%2Fnativeclient
&amp;response_mode=form_post
&amp;scope=offline_access%20https%3A%2F%2Foutlook.office.com%2FSMTP.Send%20https%3A%2F%2Foutlook.office.com%2FPOP.AccessAsUser.All
&amp;state=12345</pre>

<p id="tw-target-text">C) Log in with your Microsoft account and accept the following permissions:</p>

<p><img src="./images/50407.png" id="50407" class="WikiImage"/></p>

<p>D) After accepting, the browser will be redirected to the <strong>Redirect URI</strong> (https://login.microsoftonline.com/common/oauth2/nativeclient). You will see a blank screen.</p>

<p>E) After you are redirected to that blank screen, open the browser <strong>DeveloperTools</strong> (F12 in Chrome).</p>

<p>F) Go to <strong>Network Tab</strong> and refresh the page.</p>

<p id="tw-target-text">G) Once in the <strong>Network Tab</strong>, select the Request and copy the &quot;code&quot; of the Request.</p>

<h3><a id="+" class="HashLink" href="#+"> </a></h3>

<h3><a id="3.+Refresh+Token+Generation" class="HashLink" href="#3.+Refresh+Token+Generation">3. Refresh Token Generation</a></h3>

<p>Read more about this topic in this article: <a href="50438.html">OAuth Module</a>.</p>

<h3><a id="See+also+" class="HashLink" href="#See+also+">See also </a></h3>

<p><a href="50408.html">Google OAuth 2.0 process for Mails</a></p>

<p>  </p>
</div><script src="./images/run_prettify.js?lang=genexus"></script><hr /><table id="Pages" class="Table" cellpadding="1" cellspacing="2" style=" width: 100%;" ><TR><TD><b>Backlinks</b></TD></TR><TR><TD><a href="50408.html">Google OAuth 2.0 process for emails: Generation and data collection by the Administrator</a></TD><TD><a href="50396.html">Microsoft Exchange OAuth 2.0 for emails: Generation and data collection from the Administrator</a></TD><TD><a href="50438.html">OAuth Module</a></TD></TR></table>
</span></body>
</html><hr /><table id="Pages" class="Table" cellpadding="1" cellspacing="2" style=" width: 100%;" ><TR><td align="left"><font face="Verdana" size="1"><em>Source: <a href="https://wiki.genexus.com" target=_blank>wiki.genexus.com</a></em></font></td><td align="right"><font face="Verdana" size="1"><em>Last modification: 04/05/22 02:44 PM</em></font></td></TR></table></font>