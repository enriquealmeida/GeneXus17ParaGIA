<!DOCTYPE html>
<html>
<head>
<meta http-equiv=Content-Type content="text/html; charset=UTF-8">
<link rel="stylesheet" type="text/css" href="./images/WikiTheme2.css"/>
<link rel="stylesheet" type="text/css" href="./images/bootstrap.min.css"/>
<title>Declare referential integrity property</title>
</head>
<body bgcolor="#FFFFFF" style="display: block;margin: 8px;"><span id="W0004BODY" class="WikiBody"><table border=0 width=100%><tr><td><div align="right"><FONT face=Verdana size=2><a href =https://wiki.genexus.com/commwiki/wiki?9093,, target=_"blank">Newest Version</a></FONT></div></td></tr></table><h1 class="WikiName">Declare referential integrity property</h1>
<!--Declare referential integrity property--><table class="TableWikiBody" id="tblwikibody"><tbody><tr><td>Controls the DBMS referential integrity declaration.  <h3><a id="Values" class="HashLink" href="#Values">Values</a></h3>

<p> <table style="border-style: none;border-collapse: collapse;"><tbody><tr><td style="border-width: 1.0px;border-style: dotted;vertical-align: top;padding: 4.0px;"><strong>No                                                          </strong></td><td style="border-width: 1.0px;border-style: dotted;vertical-align: top;padding: 4.0px;">GeneXus will not declare integrity references for the database nor eliminate those which are defined during the creation/reorganization process.</td></tr><tr><td style="border-width: 1.0px;border-style: dotted;vertical-align: top;padding: 4.0px;"><strong>Remove                                                      </strong></td><td style="border-width: 1.0px;border-style: dotted;vertical-align: top;padding: 4.0px;">GeneXus will remove, during the creation/reorganization process, all integrity references related to the table/s being reorganized.</td></tr><tr><td style="border-width: 1.0px;border-style: dotted;vertical-align: top;padding: 4.0px;"><strong>Yes                                                         </strong></td><td style="border-width: 1.0px;border-style: dotted;vertical-align: top;padding: 4.0px;">GeneXus will declare all integrity references for the database during the creation/reorganization process (default value since GeneXus X version).</td></tr></tbody></table></p>
 <h3><a id="Description" class="HashLink" href="#Description">Description</a></h3>

<p> <p>To define this database property, the property must be configured in the ‘Creation/Reorganization Information’ section within the model’s ‘DBMS Options’. This property allows registering in the DBMS when the database is created that Referential Integrity will be enforced. During reorganizations, the referential integrity declaration is done in an incremental way. It means that the only tables being modified in the reorganization will be taken into account to set its referential integrity. Therefore, if the reorganization attempts to violate the Referential Integrity defined in the DBMS, an error message will be triggered.</p>

<h4><a id="Notes" class="HashLink" href="#Notes">Notes</a></h4>

<ul>
	<li>When this option is set to No, GeneXus will NOT generate referential integrity for the DBMS. However, this option will not affect referential integrity controls performed by the programs generated by GeneXus.</li>
	<li>When this option is set to Yes, the reorganization process may block some other tables in addition to the ones specified in the Impact Analysis Report. When a table is being reorganized, all integrity references which make use of this table as the &quot;parent&quot; (superordinated) table must be temporarily eliminated.You may have problems if you set this option to Yes for an existing database because the data may not validate the integrity references which are being declared. In this case, the DBMS detects the inconsistencies during the reorganization process and returns an error code.</li>
	<li>Changing this option setting will gradually be reflected on the database as the tables are reorganized.</li>
	<li>Integrity references between local and remote tables cannot be defined.</li>
	<li>When this option is set to Yes, the only possible values the Primary Key Definition property can be set to are: Primary Key and Constraint; the Index value is not allowed.</li>
	<li>If you want to eliminate the existing Referential Integrity, the Remove value must be used. The database must be created again, and then the Referential Integrity must be changed to No.</li>
	<li>In a Client/Server model with local tables, the referential integrity is not defined; thus, it is possible to perform actions on a local table which violate the integrity of the server table and vice versa.</li>
	<li>If you are working with the “Generate Null for Nullvalue” property in NO (the generated value is the GeneXus Null one and not the DBMS Null one) the Allownulls rule on a foreign key produces an error, since the GeneXus null value violates the DBMS referential integrity because it will search this value as key in some table. If you have the “Generate Null for Nullvalue” property in YES there are no problems.</li>
	<li>In a Client/Server model, the rule Error_handler can be used to handle the error, thus preventing the end of the program.</li>
	<li>If the error is not handled, the program will cancel because of the Referential Integrity violation.</li>
</ul></p>
 <h3><a id="Samples" class="HashLink" href="#Samples">Samples</a></h3>

<p> <p>Let’s suppose there is an application with the following structures (with Referential Integrity):<br />
<br />
<img src="./images/6003.png" id="6003" class="WikiImage"/>   <strong>Category</strong><br />
       CategoryId*<br />
       CategoryName<br />
<br />
<img src="./images/6003.png" id="6003" class="WikiImage"/>  <strong>Client</strong><br />
      CliIentd*<br />
      ClientName<br />
      ClientTelephone<br />
      CategoryId<br />
      CategoryName<br />
<br />
Let’s consider both tables with data.</p>

<p>There is also a process called <b>Delete</b>, which eliminates all the records of the table Category: </p>

<pre class="prettyprint lang-genexus" style="max-width: 100%">
For each Defined by CategoryName
    Delete
Endfor
</pre>

<p>This process tries to delete records of a table that are in another table as foreign key, thus violating the referential integrity. Depending on the DBMS, or if Access is used, an error will occur. By way of example, the following dialog appears in SQL Server:</p>

<p><i>Error code 547 : Delete statement conflicted with COLUMN REFERENCE constraint …</i></p>

<p>This causes the program to cancel.</p>

<p>The <b>Error_handler</b> rule can be used in this case to handle the error, thus preventing the program from closing.</p>

<p>The following steps should be taken:</p>

<p>Define a sub-routine for the procedure in order to handle the error:</p>

<pre class="prettyprint lang-genexus" style="max-width: 100%">
Sub 'Error_handler'
    If &amp;gxDBErr= 547 //SQL Server error code
        Msg('This Procedure can not be carried out because the referential integrity is violated.')
        Rollback
    EndIf
EndSub  // 'Error-handler'
</pre>

<p>In addition to that, define the rule: Error_handler(‘Message’).</p></p>
 <h3><a id="Scope" class="HashLink" href="#Scope">Scope</a></h3>

<p> Available at the datastore.<br /><strong>Datastore:</strong> Iseries, DB2 UDB, INFORMIX, MYSQL, ORACLE, POSTGRESQL, SQLSERVER<br /><strong>Platforms:</strong> Web(.Net, Java)<br /></p>
 <h3><a id="See+Also" class="HashLink" href="#See+Also">See Also</a></h3>

<p> <p><a href="6853.html">Error_Handler Rule</a><br />
<a href="8986.html">Generate null for nullvalue() property</a></p></p>
</td></tr></tbody></table><script src="./images/run_prettify.js?lang=genexus"></script><hr /><table id="Pages" class="Table" cellpadding="1" cellspacing="2" style=" width: 100%;" ><TR><TD><b>Backlinks</b></TD></TR><TR><TD><a href="17719.html">Applying property changes</a></TD><TD><a href="9070.html">DBMS Options for JDBC Technology</a></TD></TR></table>
</span></body>
</html><hr /><table id="Pages" class="Table" cellpadding="1" cellspacing="2" style=" width: 100%;" ><TR><td align="left"><font face="Verdana" size="1"><em>Source: <a href="https://wiki.genexus.com" target=_blank>wiki.genexus.com</a></em></font></td><td align="right"><font face="Verdana" size="1"><em>Last modification: 07/31/20 01:38 PM</em></font></td></TR></table></font>