<!DOCTYPE html>
<html>
<head>
<meta http-equiv=Content-Type content="text/html; charset=UTF-8">
<link rel="stylesheet" type="text/css" href="./images/WikiTheme2.css"/>
<link rel="stylesheet" type="text/css" href="./images/bootstrap.min.css"/>
<title>Query object</title>
</head>
<body bgcolor="#FFFFFF" style="display: block;margin: 8px;"><span id="W0004BODY" class="WikiBody"><table border=0 width=100%><tr><td><div align="right"><FONT face=Verdana size=2><a href =https://wiki.genexus.com/commwiki/wiki?9026,, target=_"blank">Newest Version</a></FONT></div></td></tr></table><h1 class="WikiName">Query object</h1>
<!--Category:Query object--><table class="TableWikiBody" id="tblwikibody"><tbody><tr><td><p>Defines a reusable query to the application database. </p>

<h3><a id="Description" class="HashLink" href="#Description">Description</a></h3>

<p>Many times you may need to make queries to the database to analyze data and be able to make decisions.</p>

<p>In this sense, you may need to group data according to one or several criteria, make calculations, and finally view the result in a certain way such as:</p>

<ul>
	<li>A static table, with fixed rows and columns</li>
	<li>A dynamic table, which allows, for instance, shifting columns and grouping data</li>
	<li>Or a chart</li>
</ul>

<p><br />
The Query object allows you to create these queries in a simple and intuitive way, thus enhancing the value of the information retrieved from the database.<br />
 </p>

<div style="background-color: rgb(242,242,242);border-left: 6.0px solid rgb(128,128,128);margin-bottom: 15.0px;padding: 4.0px 12.0px;"><b>Note</b>: To execute a Query object at runtime, you must use a <a href="9075.html">QueryViewer control</a>.</div>

<h3><br />
Query object creation and description</h3>
You can create a Query object through the <a href="9931.html">New Object dialog</a> (it is inside the Reporting group).

<p>Query objects are composed of four sections:</p>

<p>1) Structure<br />
2) SQL Statement<br />
3) Preview<br />
4) Documentation.</p>

<p>These sections are displayed below the query's name.</p>

<p><img src="./images/32899.png" id="32899" class="WikiImage"/></p>

<h3><a id="1%29+Structure" class="HashLink" href="#1%29+Structure">1) Structure</a></h3>

<p>The most important task executed using the Query object is the definition of the query. Each Query object defines one query over the database, and a very intuitive GeneXus-assisted definition interface is provided to make this task easier.</p>

<p><img src="./images/32889.png" id="32889" class="WikiImage"/></p>

<p>A query is defined in the Structure section of the object, which has four main subsections:</p>

<ul>
	<li><strong>Attributes: </strong>Attributes that will be returned in the query result.</li>
	<li><strong>Parameters: </strong>if the query receives parameters to filter the result, it must be declared in this section.</li>
	<li><strong>Filters: </strong>Filters applied to the query's result.</li>
	<li><strong>OrderBy: </strong>Declares the desired default query order. This option is not taken into account when using a pivot-table output.</li>
</ul>

<p>After filling the query structure with the proper data, the object will look, for example, as the following image:</p>

<p><img src="./images/32624.png" id="32624" class="WikiImage"/></p>

<h3><a id="Subsections" class="HashLink" href="#Subsections">Subsections</a></h3>

<h4 style="margin-left: 40.0px;"><a id="1.1%29+Attributes" class="HashLink" href="#1.1%29+Attributes">1.1) Attributes</a></h4 style="margin-left: 40.0px;">

<p style="margin-left: 40.0px;">The attributes involved in the query are selected here in a simple flat list. They can be added to the list by dragging from the <i>Work With Attributes </i>toolbox or just writing the attribute name inline in the query structure. The suggest mechanism is provided while writing to make attribute selection easier and faster.</p>

<p style="margin-left: 40.0px;"><img src="./images/32625.png" id="32625" class="WikiImage"/></p>

<p style="margin-left: 40.0px;">The description column will be the label for the attribute in the query output, is recommended to check these values when defining the Query. The attribute list can be reorganized by moving the items up and down; check the contextual menu for more options.</p>

<p style="margin-left: 40.0px;">Also, it is possible to define for the attributes:</p>

<ul>
	<li style="margin-left: 40.0px;"><strong>Aggregation function:</strong> the functions available are <i>Count</i>, <i>Sum,</i> <i>Average, Min, and Max</i> (*). The definition of nested aggregation functions is allowed - i.e. Sum(Count(ProductName)). The function to be applied can be set by typing it inline or by right-clicking on an attribute with aggregation and using the contextual menu.</li>
</ul>

<p style="margin-left: 80.0px;">Also, you have the possibility to group by some attribute before applying the aggregation function. This functionality allows the user to consult the data in different ways without creating all the DataBase tables.</p>

<p style="margin-left: 80.0px;">As an example, imagine you have the table Year with the attributes YearId, MonthId, and DayId (the table will have 365 registers), but you want to make a Query by Month. To do this, you can use the aggregation: Sum(YearId) by (MonthId) that will show only 12 registers instead of 365. The syntax for this aggregation is as follows;</p>

<pre class="Code" style="margin-left: 80.0px;">
&lt;Aggregation function&gt;(&lt;AttributeName&gt;) by(&lt;AttributeName<sub>1</sub>&gt;, &lt;AttributeName<sub>2</sub>&gt;, ..,&lt;AttributeName<sub>n</sub>&gt;)</pre>

<p style="margin-left: 80.0px;">* Not all aggregation functions apply for all attributes types. <i><strong>Sum, </strong></i><strong><i>Average, Max </i>and<i> Min</i> are only available for Numeric attributes</strong>. Also, when dragging and dropping a Numeric-with-decimals attribute to the query structure, the <i>Sum</i> function is automatically applied.</p>

<ul>
	<li style="margin-left: 40.0px;"><strong>Percentage:</strong> set that the attribute information is going to be displayed in percentage terms. Only for attributes with aggregation functions previously applied. You can configure to show it as a percentage with the <i>Show as percentage</i> contextual menu option.</li>
	<li style="margin-left: 40.0px;"><a href="12250.html"><strong>Filters</strong></a>: particular filters for the attribute (when using an aggregated attribute).  can define different kinds of filters for the attribute; the options are the same when defining a global one, refer to the filter section below.</li>
	<li style="margin-left: 40.0px;"><a href="11782.html"><strong>Expressions</strong></a></li>
</ul>

<p style="margin-left: 40.0px;">Properties (displayed in the Properties section) varies depending on the type of the selected attribute:</p>

<p style="margin-left: 40.0px;">For example. <a href="12555.html"><strong>ShowAllValues</strong></a> property<em> </em>is only available for attributes with no aggregation functions applied while the properties <strong>Percentage</strong> and <a href="https://wiki.genexus.com/commwiki/wiki?30963,," target="_blank"><strong>Calculation Group</strong></a> are only available for attributes with aggregation applied. </p>

<table align="center" border="1" cellpadding="1" cellspacing="1">
	<tbody>
		<tr>
			<td style="text-align: center;"><strong>Attributes with aggregation functions applied</strong></td>
			<td style="text-align: center;"><strong>Attributes with no aggregation functions applied</strong></td>
		</tr>
		<tr>
			<td style="text-align: center;"><img src="./images/32627.png" id="32627" class="WikiImage"/></td>
			<td style="text-align: center;"><img src="./images/32628.png" id="32628" class="WikiImage"/></td>
		</tr>
	</tbody>
</table>

<p> </p>

<h4 style="margin-left: 40.0px;"><a id="1.2%29+Parameters" class="HashLink" href="#1.2%29+Parameters">1.2) Parameters</a></h4 style="margin-left: 40.0px;">

<p style="margin-left: 40.0px;">In this section it is possible to define the query parameters and configure the following properties:</p>

<p style="margin-left: 40.0px;"><img src="./images/32629.png" id="32629" class="WikiImage"/></p>

<ul>
	<li style="margin-left: 40.0px;"><strong>Name: </strong>parameter name. This property value will be used when the query parameter values are set at runtime for the <a href="9075.html">QueryViewer control</a>.</li>
	<li style="margin-left: 40.0px;"><strong>Description: </strong>parameter description.</li>
	<li style="margin-left: 40.0px;"><strong>Based On:</strong> define the parameter type based on an attribute or domain.</li>
	<li style="margin-left: 40.0px;"><strong>Data type:</strong> parameter type (depending on the type set here other properties can be available such as <i>Length, Decimals, Signed. Date format </i>or<i> Hour format</i>).</li>
	<li style="margin-left: 40.0px;"><strong>Is Collection: </strong>defines whether the parameter is of type Collection. If the value is true is displayed another property (Collection value) to determine the values of the Collection. More information: <a href="15294.html">Query Object: Parameters</a>.</li>
	<li style="margin-left: 40.0px;"><strong>Value:</strong> default value for the parameter; you will set it in run-time; if not the default value will be applied.</li>
</ul>

<h4 style="margin-left: 40.0px;"><a id="1.3%29+Filters" class="HashLink" href="#1.3%29+Filters">1.3) Filters</a></h4 style="margin-left: 40.0px;">

<p style="margin-left: 40.0px;">This section specifies the query filters. A deep treatment about Filters (with formal syntax diagrams): <a href="12250.html">Query object: Filters</a></p>

<p style="margin-left: 40.0px;"><img src="./images/32630.png" id="32630" class="WikiImage"/></p>

<p style="margin-left: 40.0px;">Each filter definition consists of a group of filter elements linked with a logic operator (AND, OR), and these elements can be:</p>

<ul>
	<li style="margin-left: 40.0px;"><strong>List Filter:</strong> indicates a list of values for the attribute to be filtered. The syntax is as follows: </li>
</ul>

<pre class="Code" style="margin-left: 80.0px;">
&lt;AttributeName&gt; in [&lt;Value&gt;, &lt;Value&gt;, ..., &lt;Value&gt;]</pre>

<ul>
	<li style="margin-left: 40.0px;"><strong>Range Filter: </strong>indicates a filter using a list of value ranges linked with a logic operator (AND, OR). In each range you can use relational operators (&lt;, &gt;;, &gt;=, &lt;=, =), constants and parameters. This type of filters also accepts many types of syntax itself, for example:</li>
</ul>

<pre class="Code" style="margin-left: 80.0px;">
&lt;AttributeName&gt; in [&lt;Value&gt; to &lt;Value&gt;] or &lt;AttributeName&gt;+&quot;-&quot;+&lt;AttributeName&gt; in [&lt;Value&gt; to &lt;Value&gt;]
</pre>

<ul>
	<li style="margin-left: 40.0px;"><strong>Filter by Other Attribute: </strong>indicates a filter using the values of another attribute.</li>
	<li style="margin-left: 40.0px;"><strong>Other filter groups</strong>: using the filter groups, any multilevel filter definition can be inserted in the query.</li>
</ul>

<h3><a id="2%29+SQL+statement" class="HashLink" href="#2%29+SQL+statement">2) SQL statement</a></h3>

<p>In the SQL Statement section, the SQL statement that will be used to retrieve the data from the database can be seen.</p>

<p><img src="./images/32631.png" id="32631" class="WikiImage"/></p>

<h3><a id="3%29+Preview" class="HashLink" href="#3%29+Preview">3) Preview</a></h3>

<p>This option allows modifying easily all the properties related to the Output of the Query object and seeing all it's effects immediately, the <a href="9075.html">QueryViewer control</a> takes all the properties values from the associated Query object as the default values.</p>

<p>There are four different ways to preview the query being defined:</p>

<ul>
	<li>Table</li>
	<li>PivotTable</li>
	<li>Chart</li>
	<li>Card</li>
</ul>

<h4><a id="Table+Option" class="HashLink" href="#Table+Option">Table Option</a></h4>

<p><img src="./images/32632.png" id="32632" class="WikiImage"/></p>

<h4><a id="PivotTable+Option" class="HashLink" href="#PivotTable+Option">PivotTable Option</a></h4>

<p><img src="./images/32633.png" id="32633" class="WikiImage"/></p>

<h4><a id="Chart+Option" class="HashLink" href="#Chart+Option">Chart Option</a></h4>

<p><img src="./images/32634.png" id="32634" class="WikiImage"/></p>

<h4><a id="Card+Option" class="HashLink" href="#Card+Option">Card Option</a></h4>

<p><img src="./images/32639.png" id="32639" class="WikiImage"/></p>

<p>This Preview tab is the same as the query you will get in a <a href="6916.html">Web Panel</a> using the <a href="9075.html">QueryViewer control</a>.</p>

<p>A complete example using the Query object and Query Viewer control can be located here: <a href="https://wiki.genexus.com/commwiki/wiki?8399,," target="_blank">Query Object Usage Example</a>.</p>

<h3><a id="See+also" class="HashLink" href="#See+also">See also</a></h3>

<ul>
	<li><a href="19788.html">Query Element</a></li>
	<li><a href="9075.html">QueryViewer control</a></li>
	<li><a href="31810.html">Query Card Type</a></li>
</ul>

<p></p>

<p></p>

<p></p>

<p></p>
<br />
</td></tr></tbody></table><hr /><table id="Pages" class="Table" cellpadding="1" cellspacing="2" style=" width: 100%;" ><TR><TD><b>Pages</b></TD></TR><TR><TD><a href="19603.html">Allow Change Axes Order property</a></TD><TD><a href="47094.html">Axis and Visible property refactoring</a></TD><TD><a href="47159.html">Axis property in Query Element</a></TD></TR><TR><TD><a href="48168.html">Continent property in Query</a></TD><TD><a href="48170.html">Country property in Query</a></TD><TD><a href="https://wiki.genexus.com/commwiki/wiki?26173,Defining+a+common+language+for+GeneXus+Queries+and+GXquery+4.0," target="_blank">Defining a common language for GeneXus Queries and GXquery 4.0</a></TD></TR><TR><TD><a href="19577.html">Elements Property</a></TD><TD><a href="23426.html">Grouping time values in the Query object</a></TD><TD><a href="33158.html">Include Max and Min Property</a></TD></TR><TR><TD><a href="33131.html">Include Sparkline Property</a></TD><TD><a href="33127.html">Include Trend Property</a></TD><TD><a href="48163.html">Map type property in Query</a></TD></TR><TR><TD><a href="18477.html">Max Rows property</a></TD><TD><a href="33178.html">Orientation Property</a></TD><TD><a href="31810.html">Query Card Type</a></TD></TR><TR><TD><a href="9105.html">Query Object - Troubleshooting</a></TD><TD><a href="12038.html">Query Object Considerations</a></TD><TD><a href="11782.html">Query object expressions</a></TD></TR><TR><TD><a href="https://wiki.genexus.com/commwiki/wiki?46239,Query+object+expressions+%2816+Upgrade+10%29," target="_blank">Query object expressions (16 Upgrade 10)</a></TD><TD><a href="https://wiki.genexus.com/commwiki/wiki?43673,Query+object+expressions+%28GeneXus+16+upgrade+4%29," target="_blank">Query object expressions (GeneXus 16 upgrade 4)</a></TD><TD><a href="33991.html">Query Object Usage Example</a></TD></TR><TR><TD><a href="12250.html">Query object: Filters</a></TD><TD><a href="https://wiki.genexus.com/commwiki/wiki?46207,Query+object%3A+Filters+%28up+to+16+Upgrade+10%29," target="_blank">Query object: Filters (up to 16 Upgrade 10)</a></TD><TD><a href="15294.html">Query Object: Parameters</a></TD></TR><TR><TD><a href="42812.html">Raise ItemClick event property</a></TD><TD><a href="48166.html">Region property in Query</a></TD><TD><a href="18476.html">RemoveDuplicates property</a></TD></TR><TR><TD><a href="30172.html">Timeline chart</a></TD><TD><a href="47137.html">Type property in Query Element</a></TD><TD><a href="47098.html">Use Domain Descriptions property</a></TD></TR><TR><TD><a href="47140.html">Visible property in Query Element</a></TD><TD><a href="42240.html">YAxis Title property</a></TD></TR></table>
</span></body>
</html><hr /><table id="Pages" class="Table" cellpadding="1" cellspacing="2" style=" width: 100%;" ><TR><td align="left"><font face="Verdana" size="1"><em>Source: <a href="https://wiki.genexus.com" target=_blank>wiki.genexus.com</a></em></font></td><td align="right"><font face="Verdana" size="1"><em>Last modification: 06/11/21 08:29 PM</em></font></td></TR></table></font>