<!DOCTYPE html>
<html>
<head>
<meta http-equiv=Content-Type content="text/html; charset=UTF-8">
<link rel="stylesheet" type="text/css" href="./images/WikiTheme2.css"/>
<link rel="stylesheet" type="text/css" href="./images/bootstrap.min.css"/>
<title>DBConnection Data Type</title>
</head>
<body bgcolor="#FFFFFF" style="display: block;margin: 8px;"><span id="W0004BODY" class="WikiBody"><table border=0 width=100%><tr><td><div align="right"><FONT face=Verdana size=2><a href =https://wiki.genexus.com/commwiki/wiki?6923,, target=_"blank">Newest Version</a></FONT></div></td></tr></table><h1 class="WikiName">DBConnection Data Type</h1>
<!--DBConnection Data Type--><table class="TableWikiBody" id="tblwikibody"><tbody><tr><td><p>Allows the configuration options for the connections to the database to be determined in execution time.</p>

<h3 class="Section1"><a id="Description" class="HashLink" href="#Description">Description</a></h3 class="Section1">

<p class="Section1">In order to be able to modify the configuration options of the different data stores, from a GeneXus object and in execution time, a DBConnection data type variable must be defined. To do this, you associate this variable with a specific connection (a GeneXus<strong><em> </em></strong>data store) using the GetDataStore function, and then you manage this connection using the available properties and methods.</p>

<h3 class="Section1"><a id="Notes" class="HashLink" href="#Notes">Notes</a></h3 class="Section1">

<ul>
	<li>In Web Environments only applies using <a href="8997.html">Before Connect</a> property.  <br />
	Database connections in Web objects are handled using a pool, so is not allowed to change it at runtime. Therefore it can only be used <strong>within </strong>the Procedure referenced in the previous property.</li>
	<li>For <a href="7947.html">Command Line Procedures</a> it must be taken into account that the Connect()/Disconnect() methods close the cursors which are opened in the connection they apply to. Because of this, it is not possible to execute the Connect() and/or Disconnect() method within the scope of a For each command. The developer is responsible for using the connection/disconnection at the right moment. E.g.: if the disconnection is done in the middle of a procedure, the execution may be canceled. There is also the possibility of continuing working if the procedure is reconnected, but the results will be unpredictable.</li>
</ul>

<h3 class="Section1"><a id="Properties" class="HashLink" href="#Properties">Properties</a></h3 class="Section1">

<table border="1" cellpadding="1" cellspacing="1">
	<tbody>
		<tr>
			<td><font size="2"><font color="#000000"><span style="color: black;"><a href="6968.html">ConnectionData</a></span> </font></font></td>
			<td><span style="color: black;"><font color="#000000" size="2"><a href="https://wiki.genexus.com/commwiki/wiki?6922,," target="_blank">ODBCDatasourceName</a></font></span></td>
		</tr>
		<tr>
			<td><font color="#000000" size="2">ConnectionMethod Property</font></td>
			<td><span style="color: black;"><font size="2"><font color="#000000"><span style="color: black;"><a href="https://wiki.genexus.com/commwiki/wiki?6976,," target="_blank">ODBCDriverName</a></span> </font></font></span></td>
		</tr>
		<tr>
			<td><span style="color: black;"><font color="#000000" size="2"><a href="7006.html">DatastoreName</a></font></span></td>
			<td><span style="color: black;"><span style="color: black;"><font color="#000000" size="2"><a href="https://wiki.genexus.com/commwiki/wiki?6955,," target="_blank">ODBCFileDatasourceName</a></font></span></span></td>
		</tr>
		<tr>
			<td><font size="2"><font color="#000000"><span style="color: black;"><a href="6930.html">ErrCode</a></span> </font></font></td>
			<td><span style="color: black;"><span style="color: black;"><font size="2"><font color="#000000"><span style="color: black;"><a href="https://wiki.genexus.com/commwiki/wiki?6993,," target="_blank">ShowPrompt</a></span> </font></font></span></span></td>
		</tr>
		<tr>
			<td><font size="2"><font color="#000000"><span style="color: black;"><a href="6931.html">ErrDescription</a></span> </font></font></td>
			<td><font color="#000000" size="2"><a href="7746.html">UseExternalDatasource</a></font></td>
		</tr>
		<tr>
			<td><font size="2"><font color="#000000"><span style="color: black;"><a href="7747.html">ExternalDatasourceName</a></span> </font></font></td>
			<td><span style="color: black;"><font size="2"><font color="#000000"><span style="color: black;"><a href="7001.html">UserName</a></span> </font></font></span></td>
		</tr>
		<tr>
			<td><span style="color: black;"><font color="#000000" size="2"><a href="6951.html">JDBCDriverName</a></font></span></td>
			<td><span style="color: black;"><span style="color: black;"><font size="2"><font color="#000000"><span style="color: black;"><a href="https://wiki.genexus.com/commwiki/wiki?7038,," target="_blank">UserPassword</a></span> </font></font></span></span></td>
		</tr>
		<tr>
			<td><font size="2"><font color="#000000"><span style="color: black;"><a href="7003.html">JDBCDriverURL</a></span> </font></font></td>
			<td> </td>
		</tr>
	</tbody>
</table>

<h3><a id="Methods" class="HashLink" href="#Methods">Methods</a></h3>

<table border="1" cellpadding="1" cellspacing="1">
	<tbody>
		<tr>
			<td><font size="2"><span style="color: black;"><a href="7086.html">Connect</a></span></font></td>
			<td><font size="2"><span style="color: black;"><a href="7101.html">Disconnect</a></span></font></td>
		</tr>
	</tbody>
</table>

<p><strong>Important: </strong>If the <a href="8997.html">Before Connect</a> property is set, the Connect() method execute that procedure, except when it is referenced within that object.</p>

<h3><a id="Examples" class="HashLink" href="#Examples">Examples</a></h3>

<ul>
	<li>ODBC Connection<br />
	&amp;MyConnection is a variable of DBConnection type</li>
</ul>

<pre class="prettyprint lang-genexus" style="max-width: 100%">
    &amp;MyConnection = GetDatastore(!&quot;default&quot;)
    &amp;MyConnection.Disconnect()
    &amp;MyConnection.UserName = !&quot;Administrator&quot;
    &amp;MyConnection.UserPassword = !&quot;Adm!Password&quot;
    &amp;MyConnection.ShowPrompt = 2
    &amp;MyConnection.Connect()

</pre>

<ul>
	<li>JDBC Connection</li>
</ul>

<p>&amp;MyConn is a variable of DBConnection type</p>

<pre class="prettyprint lang-genexus" style="max-width: 100%">
Event 'Connect'
      &amp;myConn = GetDataStore(!&quot;Default&quot;)
      &amp;myConn.UserName = trim(&amp;User)
      &amp;myConn.UserPassword = trim(&amp;Password)
      &amp;myConn.JDBCDriverName=!'com.inet.tds.TdsDriver'
      &amp;myConn.JDBCDriverURL=!'jdbc:inetdae:barbanegra:1433?database=testemp2'
      &amp;myConn.ShowPrompt = 2
      &amp;Res = &amp;myConn.Connect()
      Do case
        Case &amp;Res = 0
              &amp;ConnOk = !'Y'
              return
         Otherwise
              &amp;ConnOk = !'N'
              msg('Unsuccessful connection, retry...')
      Endcase
EndEvent  // 'Connect'</pre>

<h3 class="Section1"><a id="Scope" class="HashLink" href="#Scope">Scope</a></h3 class="Section1">

<p><strong>Objects:</strong> <a href="6293.html">Procedures</a>, <a href="1908.html">Transactions</a>, <a href="6916.html">Web Panels</a><br />
<strong>Languages:</strong> .Net, Java</p>

<h3><a id="Security+Tips" class="HashLink" href="#Security+Tips">Security Tips</a></h3>

<p>-Avoid setting external user's data to the properties or methods, or sanitize accordingly the entries</p>

<h3><a id="See+Also" class="HashLink" href="#See+Also">See Also</a></h3>

<p><a href="7007.html">GetDataStore Function</a></p>

<p></p>

<p></p>

<p></p>
<br />
<br /></td></tr></tbody></table><script src="./images/run_prettify.js?lang=genexus"></script><hr /><table id="Pages" class="Table" cellpadding="1" cellspacing="2" style=" width: 100%;" ><TR><TD><b>Backlinks</b></TD></TR><TR><TD><a href="8997.html">Before connect property</a></TD><TD><a href="7086.html">Connect Method</a></TD><TD><a href="6968.html">ConnectionData Property</a></TD></TR><TR><TD><a href="6779.html">Data types list</a></TD><TD><a href="7006.html">DatastoreName Property</a></TD><TD><a href="7101.html">Disconnect Method</a></TD></TR><TR><TD><a href="6930.html">ErrCode Property</a></TD><TD><a href="6931.html">ErrDescription Property</a></TD><TD><a href="6929.html">ErrDisplay Property</a></TD><TD><a href="6945.html">Error Codes and Messages for DBConnection</a></TD></TR><TR><TD><a href="7747.html">ExternalDatasourceName Property</a></TD><TD><a href="7007.html">GetDataStore Function</a></TD><TD><a href="6951.html">JDBCDriverName Property</a></TD><TD><a href="7003.html">JDBCDriverURL Property</a></TD></TR><TR></TR><TR><TD><a href="7746.html">UseExternalDatasource Property</a></TD><TD><a href="7001.html">UserName Property</a></TD></TR></table>
</span></body>
</html><hr /><table id="Pages" class="Table" cellpadding="1" cellspacing="2" style=" width: 100%;" ><TR><td align="left"><font face="Verdana" size="1"><em>Source: <a href="https://wiki.genexus.com" target=_blank>wiki.genexus.com</a></em></font></td><td align="right"><font face="Verdana" size="1"><em>Last modification: 07/31/20 01:17 PM</em></font></td></TR></table></font>