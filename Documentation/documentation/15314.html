<!DOCTYPE html>
<html>
<head>
<meta http-equiv=Content-Type content="text/html; charset=UTF-8">
<link rel="stylesheet" type="text/css" href="./images/WikiTheme2.css"/>
<link rel="stylesheet" type="text/css" href="./images/bootstrap.min.css"/>
<title>HowTo: Consuming a Procedure exposed as a Rest service</title>
</head>
<body bgcolor="#FFFFFF" style="display: block;margin: 8px;"><span id="W0004BODY" class="WikiBody"><table border=0 width=100%><tr><td><div align="right"><FONT face=Verdana size=2><a href =https://wiki.genexus.com/commwiki/wiki?15314,, target=_"blank">Newest Version</a></FONT></div></td></tr></table><h1 class="WikiName">HowTo: Consuming a Procedure exposed as a Rest service</h1>
<!--HowTo: Consuming a Procedure exposed as a Rest service--><div class="TableWikiBody" id="tblwikibody"><p>The following is a simple example where we consume a procedure exposed as a Rest web service, which only<span style="background-color: rgb(245,246,245);"> </span>receives simple parameters and doesn't return any.</p>

<p>In the example, the &quot;AddCustomer&quot; Procedure is declared as REST web service in GeneXus, so the following properties are set as described here:</p>

<ul>
	<li>Expose as web service = true</li>
	<li>Rest protocol = true</li>
</ul>

<p><img src="./images/15318.png" id="15318" class="WikiImage"/></p>

<p>The procedure receives &quot;in&quot; parameters in order to add a Customer to the corresponding table:</p>

<p>Parm Rule:</p>

<pre class="prettyprint lang-genexus" style="max-width: 100%">
parm(in:&amp;CustomerId,in:&amp;CustomerName,in:&amp;CustomerBirthDate);</pre>

<p>Source:</p>

<pre class="prettyprint lang-genexus" style="max-width: 100%">
new
   CustomerId = &amp;CustomerId
   CustomerName = &amp;CustomerName
   CustomerBirthDate = &amp;CustomerBirthDate
endnew</pre>

<p>In order to call AddCustomer as a REST web service, you should use <a href="6932.html">HttpClient data type</a>. A GeneXus client should look as shown below:</p>

<pre class="prettyprint lang-genexus" style="max-width: 100%">
// http://server:8080/BaseUrl/rest/AddCustomer
&amp;httpclient.Host = 'server'
&amp;httpclient.Port = 8080
&amp;httpclient.Secure = 0
&amp;httpclient.BaseUrl = 'Baseurl'/rest
 
&amp;body = &amp;customersdt.ToJson() //&amp;customersdt is a variable of CustomerSdt data type which is an SDT that includes the CustomerId, CustomerName and CustomerBirthDate items.
&amp;body = '{ &quot;Customer&quot;:' + &amp;body + '}' 
 
&amp;httpclient.AddHeader('Content-type','application/json')
&amp;httpclient.AddString(&amp;body)

&amp;httpclient.Execute('POST','AddCustomer') 
//Then process the HttpClient response.</pre>

<p>Download the sample from <a href="https://wiki.genexus.com/commwiki/wiki?30742,," target="_blank">Sample consuming a Rest procedure</a></p>

<p>As shown in the example, the parameters are sent in JSON format in the body of the HttpRequest; that's why in the example we use the method to convert <span style="background-color: rgb(245,246,245);">the data contained in an SDT </span>to JSON format.</p>

<p>Also, pay special attention to the line:</p>

<pre class="prettyprint lang-genexus" style="max-width: 100%">
&amp;body = '{&quot;Customer&quot;:' + &amp;body + '}'
</pre>

<p>As can be seen, it is necessary to wrap the &amp;Body parameter, in this case inside the 'Customer' key, because the REST program generated by GeneXus wrapped all the input parameters.  </p>

<p>This is particularly necessary when the REST service receives more the one input parameter, for instance: </p>

<pre class="prettyprint lang-genexus" style="max-width: 100%">
parm(in:&amp;Customer, in:&amp;Mode, out:&amp;CustomerId, out:&amp;Message);</pre>

<p>The rest protocol expects a valid JSON, and this is always in the form of {Field: Value, Field: Value,..}, an array [Field: value, Field: value] or a combination of both. So in that case you can't send something like this in the body:</p>

<pre class="prettyprint lang-genexus" style="max-width: 100%">
{&quot;CustomerId&quot;: 1, &quot;CustomerName&quot;: &quot;Paul&quot;, &quot;CustomerBirthDate&quot;: &quot;1977-01-18&quot;} <strong>&quot;INS&quot;</strong></pre>

<p>Because this is not a valid JSON.</p>

<p>Then it has to be sent like this:</p>

<pre class="prettyprint lang-genexus" style="max-width: 100%">
<strong>{&quot;Customer&quot;: </strong>{&quot;CustomerId&quot;: 1, &quot;CustomerName&quot;: &quot;Paul&quot;, &quot;CustomerBirthDate&quot;: &quot;1977-01-18&quot;}<strong>, &quot;Mode&quot;: &quot;INS&quot;}}</strong></pre>

<p>Note that each parameter is wrapped with the name of the parameter in the parm rule.</p>

<p> </p>

<div style="background-color: rgb(255,255,204);border-left: 6.0px solid rgb(255,235,59);padding: 0.01em 16.0px;">
<p><b>Note:</b><br />
With respect to consuming a Rest service (it can be generated by GeneXus or not), GeneXus provides the <a href="31864.html">OpenAPI import tool</a>.</p>
</div>

<p> </p>

<p>Next, read <a href="15315.html">Procedures as REST: Using SDT as input to the procedure</a></p>

<h3><a id="See+Also" class="HashLink" href="#See+Also">See Also</a></h3>

<p><a href="28213.html">Rest web services in GeneXus</a></p>

<p><br />
<br />
<br />
</p>
<br />
<br />
</div><script src="./images/run_prettify.js?lang=genexus"></script><hr /><table id="Pages" class="Table" cellpadding="1" cellspacing="2" style=" width: 100%;" ><TR><TD><b>Backlinks</b></TD></TR><TR><TD><a href="21467.html">Procedures as Rest web services in GeneXus</a></TD><TD><a href="28213.html">Toc:Rest web services in GeneXus</a></TD></TR><TR></TR></table>
</span></body>
</html><hr /><table id="Pages" class="Table" cellpadding="1" cellspacing="2" style=" width: 100%;" ><TR><td align="left"><font face="Verdana" size="1"><em>Source: <a href="https://wiki.genexus.com" target=_blank>wiki.genexus.com</a></em></font></td><td align="right"><font face="Verdana" size="1"><em>Last modification: 09/21/21 04:38 PM</em></font></td></TR></table></font>