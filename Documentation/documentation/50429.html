<!DOCTYPE html>
<html>
<head>
<meta http-equiv=Content-Type content="text/html; charset=UTF-8">
<link rel="stylesheet" type="text/css" href="./images/WikiTheme2.css"/>
<link rel="stylesheet" type="text/css" href="./images/bootstrap.min.css"/>
<title>Database Mocking feature showcase</title>
</head>
<body bgcolor="#FFFFFF" style="display: block;margin: 8px;"><span id="W0004BODY" class="WikiBody"><table border=0 width=100%><tr><td><div align="right"><FONT face=Verdana size=2><a href =https://wiki.genexus.com/commwiki/wiki?50429,, target=_"blank">Newest Version</a></FONT></div></td></tr></table><h1 class="WikiName">Database Mocking feature showcase</h1>
<!--Database Mocking feature showcase--><div class="TableWikiBody" id="tblwikibody"><p>In this article a practical use case of the feature <a href="38349.html">database mocking</a> is presented.</p>

<p>Let's say you have a transaction Customer comprised of an Id, Name, and Address. Additionally, you also have a procedure that receives the information to insert a new customer into the database, doing some checks and returning a boolean value and an error message in case the operation could not be completed.</p>

<p>These are the objects we have so far:</p>

<p><img src="./images/50431.png" id="50431" class="WikiImage"/></p>

<p><img src="./images/50432.png" id="50432" class="WikiImage"/></p>

<p>Now, you create a unit test for your procedure using the option Create Unit Test over it and define different test cases such as a valid new customer, an invalid id (duplicated), an empty address, name, and so on.</p>

<p><img src="./images/50433.png" id="50433" class="WikiImage"/></p>

<p>Your test now requires a certain database state, which you will have to maintain between executions. For example, for the test case when you insert a valid customer, the first time you execute the test it will pass because you made sure there wasn't a client with the id 36. But if you execute it again this is what you get:</p>

<p><img src="./images/50435.png" id="50435" class="WikiImage"/></p>

<p>You should delete the customer 36 somehow (there are several ways to do it), but you don't want to do the same every time you execute your tests, and additionally, you want to test that your checks inside the procedure are correct, not deal with database scripts or manual setups. </p>

<p>This is where database mocking shines. Once you have your data in place, select the option "Record mocking data" over the test. Once the execution finishes in the output log you will be informed that a new file object was created in your KB. This new file contains mocking data that will allow you to not depend on the database records anymore.</p>

<p>To be sure you can run the test again and verify that the execution result is the same, otherwise, you would receive an error "Customer with id 36 already exists" as we saw before.</p>

<h3><a id="Share+the+tests+and+mock+data" class="HashLink" href="#Share+the+tests+and+mock+data">Share the tests and mock data</a></h3>

<p>Once you have your tests ready you can commit your changes to GeneXus Server. According to your pipeline script configuration, the test could be executed using the mock data you recorded locally but now in the continuous integration environment and the results will be the same as those you got in your machine.</p>

<p><img src="./images/50436.png" id="50436" class="WikiImage"/></p>

<h3><a id="Mock+data+maintenance" class="HashLink" href="#Mock+data+maintenance">Mock data maintenance</a></h3>

<p>After a table structure or navigation changes, you likely have to update your mock data, since DB sentences will be different. The same applies if your object under test now has a different number of DB accesses or modifies a different number of attributes for example. You need to create the conditions required to perform a mock recording again.</p>

<p></p>
</div><hr /><table id="Pages" class="Table" cellpadding="1" cellspacing="2" style=" width: 100%;" ><TR><TD><b>Backlinks</b></TD></TR><TR><TD><a href="38349.html">Database Mocking</a></TD></TR></table>
</span></body>
</html><hr /><table id="Pages" class="Table" cellpadding="1" cellspacing="2" style=" width: 100%;" ><TR><td align="left"><font face="Verdana" size="1"><em>Source: <a href="https://wiki.genexus.com" target=_blank>wiki.genexus.com</a></em></font></td><td align="right"><font face="Verdana" size="1"><em>Last modification: 06/13/22 07:08 PM</em></font></td></TR></table></font>