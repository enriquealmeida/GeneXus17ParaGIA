<!DOCTYPE html>
<html>
<head>
<meta http-equiv=Content-Type content="text/html; charset=UTF-8">
<link rel="stylesheet" type="text/css" href="./images/WikiTheme2.css"/>
<link rel="stylesheet" type="text/css" href="./images/bootstrap.min.css"/>
<title>Automatically generated identifiers synching conflicts</title>
</head>
<body bgcolor="#FFFFFF" style="display: block;margin: 8px;"><span id="W0004BODY" class="WikiBody"><table border=0 width=100%><tr><td><div align="right"><FONT face=Verdana size=2><a href =https://wiki.genexus.com/commwiki/wiki?23543,, target=_"blank">Newest Version</a></FONT></div></td></tr></table><h1 class="WikiName">Automatically generated identifiers synching conflicts</h1>
<!--Automatically generated identifiers synching conflicts--><table class="TableWikiBody" id="tblwikibody"><tbody><tr><td><p>This page makes recommendations regarding automatically generated identifiers, possible related behaviors, and what to take into account.</p>

<p>It is very common that you choose to use automatically generated identifiers for your <a href="1908.html">Transaction object</a>s keys in order to solve enumeration problems.</p>

<p>In GeneXus, this can be performed by using features such as:</p>

<ul>
	<li>The <a href="6798.html">Autonumber property</a>,</li>
	<li>The <a href="31772.html">GUID data type</a> (with the <a href="40892.html">Autogenerate Guid property</a> set to True)</li>
	<li>calling Procedures in the <a href="8213.html">Transaction rules</a> section.</li>
</ul>

<p>To avoid synchronization conflicts, use <a href="31772.html">GUID data type</a> (with the <a href="40892.html">Autogenerate Guid property</a> set to True). In that case, a unique identifier is generated when the record is created in the device, and that identifier remains unchanged when synchronizing.</p>

<p><span style="line-height: 1.6;">If for some reason this is not possible, several conflicts may occur</span><span style="line-height: 1.6;"> and the same for the related foreign keys.</span></p>

<p>GeneXus solves part of this problem automatically. The rest of the document briefly explains how GeneXus addresses this kind of problem and what needs to be taken into account if you use automatically generated identifiers (not autogenerated GUID).</p>

<h3><a id="The+key+mapping+problem" class="HashLink" href="#The+key+mapping+problem">The key mapping problem</a></h3>

<p>For instance: An offline application about the classical Country-City example where both CountryID and CityID have the <a href="6798.html">Autonumber property</a> set to True.<br />
This app is going to be installed on two devices, and there is also a server part to accumulate all the data.</p>

<h4><a id="Moment+0" class="HashLink" href="#Moment+0">Moment 0</a></h4>

<p><strong>Server:</strong> has no registers</p>

<p><strong>DeviceA:</strong></p>

<table border="1" cellpadding="1" cellspacing="1" style="width: 0.0px;">
	<tbody>
		<tr>
			<td style="text-align: center;"><strong>CountryID</strong></td>
			<td style="text-align: center;"><strong>CountryName</strong></td>
		</tr>
		<tr>
			<td>1</td>
			<td>Uruguay</td>
		</tr>
		<tr>
			<td>2</td>
			<td>Brasil</td>
		</tr>
	</tbody>
</table>

<p> </p>

<table border="1" cellpadding="1" cellspacing="1" style="width: 0.0px;">
	<tbody>
		<tr>
			<td>
			<p style="text-align: center;"><strong>CityID</strong></p>
			</td>
			<td style="text-align: center;"><strong>CityName</strong></td>
			<td style="text-align: center;"><strong>CountryID</strong></td>
		</tr>
		<tr>
			<td>1</td>
			<td>Porto Alegre</td>
			<td>2</td>
		</tr>
		<tr>
			<td>2</td>
			<td>Montevideo</td>
			<td>1</td>
		</tr>
	</tbody>
</table>

<p> </p>

<p><br />
<strong>DeviceB:</strong></p>

<table border="1" cellpadding="1" cellspacing="1" style="width: 0.0px;">
	<tbody>
		<tr>
			<td style="text-align: center;"><strong>CountryID</strong></td>
			<td style="text-align: center;"><strong>CountryNam</strong>e</td>
		</tr>
		<tr>
			<td>1</td>
			<td>Argentina</td>
		</tr>
		<tr>
			<td>2</td>
			<td>Paraguay</td>
		</tr>
	</tbody>
</table>

<p> </p>

<table border="1" cellpadding="1" cellspacing="1" style="width: 0.0px;">
	<tbody>
		<tr>
			<td>
			<p style="text-align: center;"><strong>CityID</strong></p>
			</td>
			<td style="text-align: center;"><strong>CityName</strong></td>
			<td style="text-align: center;"><strong>CountryID</strong></td>
		</tr>
		<tr>
			<td>1</td>
			<td>Buenos Aires</td>
			<td>1</td>
		</tr>
		<tr>
			<td>2</td>
			<td>Asunción</td>
			<td>2</td>
		</tr>
	</tbody>
</table>

<p> </p>

<h4><br />
Moment 1</h4>

<p>The DeviceB will sync with the server and send its data. Then the server and the DeviceB will be synched</p>

<h4><a id="Moment+2" class="HashLink" href="#Moment+2">Moment 2</a></h4>

<p>After that, the DeviceA does the same. Which Id the DeviceA items will have?<br />
Locally the CountryIDs were 1 and 2. But on the server, there's already a 1 and 2 ID for Country.</p>

<p>The solution is to enumerate on the server on its own. So the result of both synchronizations of Country will be:</p>

<table border="1" cellpadding="1" cellspacing="1">
	<tbody>
		<tr>
			<td style="text-align: center;"><strong>CountryID</strong></td>
			<td style="text-align: center;"><strong>CountryName</strong></td>
		</tr>
		<tr>
			<td>1</td>
			<td>Argentina</td>
		</tr>
		<tr>
			<td>2</td>
			<td>Paraguay</td>
		</tr>
		<tr>
			<td><span style="font-size: medium;"><span style="color: rgb(255,0,0);">3</span></span></td>
			<td>Uruguay</td>
		</tr>
		<tr>
			<td><span style="font-size: medium;"><span style="color: rgb(255,0,0);">4</span></span></td>
			<td>Brasil</td>
		</tr>
	</tbody>
</table>

<p><br />
But what happens when CountryID is being used as a foreign key? Like in City table in this example?</p>

<p>Cascade updates have to be done to the subordinated tables as shown in the following table:</p>

<table border="1" cellpadding="1" cellspacing="1">
	<tbody>
		<tr>
			<td style="text-align: center;"><strong>CityID</strong></td>
			<td style="text-align: center;"><strong>CityName</strong></td>
			<td style="text-align: center;"><strong>CountryID</strong></td>
		</tr>
		<tr>
			<td>1</td>
			<td>Buenos Aires</td>
			<td>1</td>
		</tr>
		<tr>
			<td>2</td>
			<td>Asunción</td>
			<td>2</td>
		</tr>
		<tr>
			<td><span style="font-size: medium;">3</span></td>
			<td>Porto Alegre</td>
			<td><span style="color: rgb(255,0,0);"><span style="font-size: medium;">4</span></span></td>
		</tr>
		<tr>
			<td><span style="font-size: medium;">4</span></td>
			<td>Montevideo</td>
			<td><span style="color: rgb(255,0,0);"><span style="font-size: medium;">3</span></span></td>
		</tr>
	</tbody>
</table>

<p><br />
<strong>Note:</strong> CityIDs corresponding to Porto Alegre and Montevideo were modified the same way that CountryIDs of Uruguay and Brasil.</p>

<p>This problem seems simple on a basic example like this one but on bigger systems, it is much more complicated.</p>

<h3><a id="What+problems+are+not+solved+when+Identifiers+change+in+synchronization+time" class="HashLink" href="#What+problems+are+not+solved+when+Identifiers+change+in+synchronization+time">What problems are not solved when Identifiers change in synchronization time</a></h3>

<p>There is a key problem that is not solved: Variables in memory are not renamed. <br />
That means that the following may happen:</p>

<ol>
	<li>Record with ID = 1 is created in the device</li>
	<li>While some process occurs, data is synchronized and ID changed to value 2</li>
	<li>A variable with the ID still has value 1 in memory</li>
	<li>That variable is used to filter data ... Problem: It filters the record with value 1, which may not exist or at least for sure is not the one expected.</li>
</ol>

<p>This is why you should use GUID Data Type (with Autogenerate).</p>

<h3><a id="Advanced+Concepts" class="HashLink" href="#Advanced+Concepts">Advanced Concepts</a></h3>

<p>How does this synchronization key mapping work?<br />
To learn more about this problem check out the <a href='http://www.genexus.com/encuentro2013/gx23-materiales?es,0,,3199'>Marcos Crispino session at the Genexus 23th event</a>.</p>

<h3><a id="Availability" class="HashLink" href="#Availability">Availability</a></h3>

<p>As from <a href="https://wiki.genexus.com/commwiki/wiki?20247,," target="_blank">GeneXus X Evolution 3</a>.</p>

<h3><a id="See+also" class="HashLink" href="#See+also">See also</a></h3>

<p><a href="22240.html">The Data Synchronization Problem</a></p>

<p></p>

<p><br />
</p>

<p><br />
</p>
</td></tr></tbody></table><hr /><table id="Pages" class="Table" cellpadding="1" cellspacing="2" style=" width: 100%;" ><TR><TD><b>Backlinks</b></TD></TR><TR><TD><a href="20249.html">My first Offline Native Mobile application</a></TD><TD><a href="22228.html">Toc:Offline Native Mobile Applications</a></TD></TR><TR><TD><a href="22240.html">The Data Synchronization Problem</a></TD></TR></table>
</span></body>
</html><hr /><table id="Pages" class="Table" cellpadding="1" cellspacing="2" style=" width: 100%;" ><TR><td align="left"><font face="Verdana" size="1"><em>Source: <a href="https://wiki.genexus.com" target=_blank>wiki.genexus.com</a></em></font></td><td align="right"><font face="Verdana" size="1"><em>Last modification: 08/19/20 12:45 AM</em></font></td></TR></table></font>