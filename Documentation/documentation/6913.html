<!DOCTYPE html>
<html>
<head>
<meta http-equiv=Content-Type content="text/html; charset=UTF-8">
<link rel="stylesheet" type="text/css" href="./images/WikiTheme2.css"/>
<link rel="stylesheet" type="text/css" href="./images/bootstrap.min.css"/>
<title>Queue Data Type</title>
</head>
<body bgcolor="#FFFFFF" style="display: block;margin: 8px;"><span id="W0004BODY" class="WikiBody"><table border=0 width=100%><tr><td><div align="right"><FONT face=Verdana size=2><a href =https://wiki.genexus.com/commwiki/wiki?6913,, target=_"blank">Newest Version</a></FONT></div></td></tr></table><h1 class="WikiName">Queue Data Type</h1>
<!--Queue Data Type--><table class="TableWikiBody" id="tblwikibody"><tbody><tr><td><p>The Queue data type enables you to establish a connection to a message queue and allows you to send and receive messages to and from the queue. This data type will therefore make it possible to develop applications that require interaction with other applications that are not connected, with all the advantages of this type of programming, such as asynchronic communication and processing.</p>

<h3><a id="Description" class="HashLink" href="#Description"><font size="3"><strong>Description</strong></font></a></h3>

<p>The Queue data type will allow you to establish a connection to a message queue. Once this connection is established, you will be able to send and receive messages to and from the queue. The messages sent are defined by the <a href="6914.html">QueueMessage data type</a>, which consists of a text and a priority (see <a href="6914.html">QueueMessage data type</a>).</p>

<p>The Queue data type enables you to establish a connection to the two types of existing queues:</p>

<ul>
	<li>Point to point: a message is sent to the queue and then a client consumes the message (which then no longer exists in the queue). This means that once a message has been sent, a client can then connect to the queue and retrieve the message (if it hasn't been consumed yet).</li>
	<li>Publish / Subscribe: a message is sent to the queue and only the clients that are already connected to the queue will be able to receive the message. If a client connects to the queue after the message has been sent, this client won't receive the message.</li>
</ul>

<h3><a id="Properties" class="HashLink" href="#Properties"><font size="3"><strong>Properties</strong></font></a></h3>

<table border="1" cellpadding="1" cellspacing="1" width="700">
	<tbody>
		<tr>
			<td><font color="#000000" size="2">Provider</font></td>
			<td><font color="#000000" size="2">Indicates the provider of the queue to be used, defined in the jms.xml file.</font></td>
		</tr>
		<tr>
			<td><font color="#000000" size="2">User</font></td>
			<td><font color="#000000" size="2">Overwrites the user setup in the provider. </font></td>
		</tr>
		<tr>
			<td><font color="#000000" size="2">Password</font></td>
			<td><font color="#000000" size="2">Overwrites the password setup in the provider. </font></td>
		</tr>
		<tr>
			<td><font color="#000000" size="2">Browse</font></td>
			<td><font color="#000000" size="2">Indicates whether the messages will be kept in the queue or if they will be removed from it.</font></td>
		</tr>
		<tr>
			<td>errCode </td>
			<td>Indicates the error code in case an error happened when a method was executed, returns 0 otherwise </td>
		</tr>
		<tr>
			<td>errDescription</td>
			<td>Indicates the error detail in case an error happened</td>
		</tr>
	</tbody>
</table>

<p><br />
<strong>Provider</strong></p>

<p>Indicates who the provider of the queue to be used is. The name of the provider must have previously been defined in the jms.xml file (see Defining providers). This file must be located in the application directory (DATANNN).</p>

<p><strong>User</strong></p>

<p>Overwrites the user setup in the provider.</p>

<p>&amp;queue.user = &quot;myUser&quot;</p>

<p><strong>Password</strong></p>

<p>Overwrites the password setup in the provider.</p>

<p>&amp;queue.password = &quot;myPassword&quot;</p>

<p><strong>Browse</strong></p>

<p>Indicates whether the messages will be kept in the queue or if they will be removed from it.</p>

<p>The default value is False.</p>

<p>&amp;queue.browse = True</p>

<p><strong>errCode </strong></p>

<p>Read only property, Indicates the error code in case an error happened when a method was executed, returns 0 otherwise </p>

<p>Default value 0</p>

<p>&amp;errcode = &amp;queue.errCode</p>

<p><strong>errDescription</strong></p>

<p>Read only property, Indicates the error detail in case an error happened</p>

<p>&amp;errDsc = &amp;queue.errDescription<br />
 </p>

<h3><a id="Methods" class="HashLink" href="#Methods"><strong>Methods</strong></a></h3>

<table border="1" cellpadding="1" cellspacing="1" width="500">
	<tbody>
		<tr>
			<td><font color="#000000" size="2">Connect</font></td>
			<td><font color="#000000" size="2">Establishes a connection with the queue defined in Provider.</font></td>
		</tr>
		<tr>
			<td><font color="#000000" size="2">Disconnect</font></td>
			<td><font color="#000000" size="2">Ends the connection with the queue. </font></td>
		</tr>
		<tr>
			<td><font color="#000000" size="2">Send</font></td>
			<td><font color="#000000" size="2">Sends a message to the queue. </font></td>
		</tr>
		<tr>
			<td><font color="#000000" size="2">Commit</font></td>
			<td><font color="#000000" size="2">Commits all the messages that haven't been commited.</font></td>
		</tr>
		<tr>
			<td><font color="#000000" size="2">Rollback</font></td>
			<td><font color="#000000" size="2">Rollbacks all the messages that haven't been commited.</font></td>
		</tr>
	</tbody>
</table>

<p><strong>&lt;Boolean&gt; = Connect()</strong> <br />
<br />
Establishes a connection with the queue defined in provider. It returns True if the connection was possible and False if it was not possible.<br />
<br />
&amp;Boolean = &amp;queue.connect()<br />
<br />
<strong>Disconnect</strong><br />
<br />
Ends the connection with the queue.<br />
<br />
&amp;queue.disconnect()<br />
<br />
<font face="courier"><strong>&lt;String&gt; = Send(QueueMessage message)</strong> </font><br />
<br />
Sends a message to the queue. If the message was sent successfully, it returns its ID; otherwise it returns &quot;&quot;.<br />
<br />
&amp;char = &amp;queue.send(&amp;queueMessage)<br />
<br />
<strong>Commit</strong><br />
<br />
Sends all the messages that weren't commited to the queue (if Queue_AutoCommit = NO. See &quot;Defining Providers&quot;).<br />
<br />
<strong>Rollback</strong><br />
<br />
Rollbacks all the messages that haven't been sent to the queue (if Queue_AutoCommit = NO. See &quot;Defining Providers&quot;).</p>

<p> </p>

<h3><a id="Processing+messages+" class="HashLink" href="#Processing+messages+"><font size="3">Processing messages </font></a></h3>

<p>To process the messages you must use the &quot;For in&quot; command as follows:<br />
<br />
For &amp;message in &amp;queue<br />
<font face="courier"> ... //Work with &amp;message </font><br />
EndFor</p>

<h3><a id="Defining+Providers+" class="HashLink" href="#Defining+Providers+"><font size="3">Defining Providers </font></a></h3>

<p><font size="2"><strong>Defining Providers in Java </strong></font><br />
<br />
To define a provider it is necessary to create a jms.xml file under the application directory. This file will contain information on different providers. The following is a complete example of a jms.xml file.<br />
<br />
&lt;JMS_Providers&gt;<br />
<font face="courier"> &lt;Provider&gt; </font><br />
<font face="courier">   &lt;Name&gt;queueProvider&lt;/Name&gt; </font><br />
<font face="courier">   &lt;User&gt;&lt;/User&gt; </font><br />
<font face="courier">   &lt;Password&gt;&lt;/Password&gt; </font><br />
<font face="courier">   &lt;Type&gt;Queue&lt;/Type&gt; </font><br />
<font face="courier">   &lt;Factory&gt;com.sun.enterprise.naming.SerialInitContextFactory&lt;/Factory&gt; </font><br />
<font face="courier">   &lt;URL&gt;iiop://myserver:1050&lt;/URL&gt; </font><br />
<font face="courier">   &lt;JNDI_ID&gt;QueueConnectionFactory&lt;/JNDI_ID&gt; </font><br />
&lt;Queue_Name&gt;Queue&lt;/Queue_Name&gt;<br />
&lt;Queue_AutoCommit&gt;YES&lt;/Queue_AutoCommit&gt;<br />
<font face="courier"> &lt;/Provider&gt; </font><br />
<font face="courier"> &lt;Provider&gt; </font><br />
<font face="courier">    .... </font><br />
<font face="courier"> &lt;/Provider&gt;  </font><br />
&lt;/JMS_Providers&gt;<br />
 </p>

<table class="wikitable FCK__ShowTableBorders">
	<tbody>
		<tr>
			<td class="wikicell">&lt;Name&gt;</td>
			<td class="wikicell">Provider's name. This name will then be used in GeneXus when connecting to the queue (&amp;queue.Provider = queueProvider).</td>
		</tr>
		<tr>
			<td class="wikicell">&lt;User&gt;</td>
			<td class="wikicell">The user's identification.</td>
		</tr>
		<tr>
			<td class="wikicell">&lt;Password&gt;</td>
			<td class="wikicell">Password of the user specified at &lt;User&gt;</td>
		</tr>
		<tr>
			<td class="wikicell">&lt;Type&gt;</td>
			<td class="wikicell">The type can be either a Queue or a Topic depending on the destination defined in the server.</td>
		</tr>
		<tr>
			<td class="wikicell">&lt;Factory&gt;</td>
			<td class="wikicell">This is the initial context factory class, which is different for every server. For J2EE application servers, it's: com.sun.enterprise.naming.SerialInitContextFactory. For OpenJMS servers, it's: org.exolab.jms.jndi.InitialContextFactory.</td>
		</tr>
		<tr>
			<td class="wikicell">&lt;URL&gt;</td>
			<td class="wikicell">The URL of the server.</td>
		</tr>
		<tr>
			<td class="wikicell">&lt;JNDI_ID&gt;</td>
			<td class="wikicell">Name of the connection factory previously defined in the server.</td>
		</tr>
		<tr>
			<td class="wikicell">&lt;Queue_Name&gt;</td>
			<td class="wikicell">Name of the queue (the destination previously defined in the server).</td>
		</tr>
		<tr>
			<td class="wikicell">&lt;Queue_AutoCommit&gt;</td>
			<td class="wikicell">Indicates if the messages will have to be commited or not. If &quot;NO&quot; is specified, messages will be stored in memory and it will be necessary to make &amp;queue.commit() in order to send them. If &quot;YES&quot; is specified, there is no need to make &amp;queue.commit() because they will be automatically sent every time the &amp;queue.Send() method is invoked.</td>
		</tr>
	</tbody>
</table>

<p>For further information, see &quot;Creating queues with J2EE Software Development Kit (SDK) version 1.3.1&quot;.<br />
<br />
<strong><font size="2">Defining Providers in .NET</font> </strong><br />
<br />
In .NET the provider must be defined in the client.exe.config file for command line programs or web.config file of the web application. Under AppSetting, you need to add:<br />
<br />
&lt;add key=&quot;&lt;Queue-ProviderName&gt;&quot; value=&quot;&lt;server&gt;\&lt;queue&gt;&quot;/&gt;<br />
<br />
Where ProviderName is the name that is going to be set to &amp;queue.provider property, &lt;server&gt; is the name of the server and &lt;queue&gt; is the name of the queue defined in the server. When defining the queue, take into account that you must include the prefix &quot;Queue&quot; in the definition, but that the prefix is not used from GeneXus (only the ProviderName is used): For example:<br />
<br />
In client.exe.config:<br />
<br />
&lt;add key=&quot;Queue-MyFirstQueue&quot; value=&quot;paul-xp\myQueue&quot;/&gt;<br />
<br />
Then from GX you must use:<br />
<br />
&amp;queue.provider = &quot;MyFirstQueue&quot;<br />
<br />
In order to define a message queue in .NET you must have previously installed the Messsage Queuing service. After that you will be able to create a Queue. Note that when creating the queue, you can either set it as a transactional queue or not. If transactional is set to NO, the commit and rollback methods of the message queue data type will be disabled and messages will automatically be sent in the &quot;Send&quot; method (so it won't be necessary to commit the messages).</p>

<h3><a id="Scope" class="HashLink" href="#Scope">Scope</a></h3>

<p><strong>Objects:</strong> <a href="6293.html">Procedures</a>, <a href="1908.html">Transactions</a>, <a href="6916.html">Web Panels</a><br />
<strong>Languages:</strong> Java, .NET, Ruby (up to GeneXus X Evolution 3)<br />
<strong>Interfaces: </strong>Web</p>

<p><br />
</p>
<br />
<br /></td></tr></tbody></table><hr /><table id="Pages" class="Table" cellpadding="1" cellspacing="2" style=" width: 100%;" ><TR><TD><b>Backlinks</b></TD></TR><TR><TD><a href="6779.html">Data types list</a></TD><TD><a href="40593.html">Kafka Producer and Consumer External Objects</a></TD></TR><TR><TD><a href="6914.html">QueueMessage Data Type</a></TD></TR></table>
</span></body>
</html><hr /><table id="Pages" class="Table" cellpadding="1" cellspacing="2" style=" width: 100%;" ><TR><td align="left"><font face="Verdana" size="1"><em>Source: <a href="https://wiki.genexus.com" target=_blank>wiki.genexus.com</a></em></font></td><td align="right"><font face="Verdana" size="1"><em>Last modification: 07/31/20 01:20 PM</em></font></td></TR></table></font>