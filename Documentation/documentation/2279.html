<!DOCTYPE html>
<html>
<head>
<meta http-equiv=Content-Type content="text/html; charset=UTF-8">
<link rel="stylesheet" type="text/css" href="./images/WikiTheme2.css"/>
<link rel="stylesheet" type="text/css" href="./images/bootstrap.min.css"/>
<title>Error handling in Business Components</title>
</head>
<body bgcolor="#FFFFFF" style="display: block;margin: 8px;"><span id="W0004BODY" class="WikiBody"><table border=0 width=100%><tr><td><div align="right"><FONT face=Verdana size=2><a href =https://wiki.genexus.com/commwiki/wiki?2279,, target=_"blank">Newest Version</a></FONT></div></td></tr></table><h1 class="WikiName">Error handling in Business Components</h1>
<!--Error handling in Business Components--><div class="TableWikiBody" id="tblwikibody"><p>Upon executing the <a href="23229.html">Save</a>, <a href="23401.html">Check</a>, <a href="23211.html">Load</a> or <a href="23238.html">Delete</a> methods, the messages automatically generated by GeneXus (those issued by GeneXus through data consistency controls, uniqueness of <a href="1868.html">Primary Key</a> values, etc.) are triggered as well as your own <a href="6852.html">Error</a> and <a href="6854.html">Msg</a> rules defined in the <a href="1908.html">Transaction object</a>.</p>

<p>Even when these controls are automatically triggered, for the end user to be aware of this, you must obtain and explicitly show the messages issued.</p>

<p>Now, how do you recover the messages occurred?</p>

<p>You use the structured data type Messages that GeneXus defines automatically upon creating a <a href="9596.html">New - Knowledge Base</a>: </p>

<p><img src="./images/23254.png" id="23254" class="WikiImage"/> </p>

<p>This collection data type is meant to allow access to the messages issued in the execution of a Business Component.</p>

<p>So, with the object to use the <a href="5846.html">Business Component</a> you define two variables:</p>

<ul>
	<li>&amp;Messages: of the Messages data type, collection</li>
	<li>&amp;oneMessage: of the Messages.Message data type, which is 1 element in the collection</li>
</ul>

<p><img src="./images/23255.png" id="23255" class="WikiImage"/></p>

<h3><a id="Example" class="HashLink" href="#Example">Example</a></h3>

<p>Suppose you define the Customer Transaction as Business Component (by setting its <a href="9548.html">Business Component property</a> = True):</p>

<pre class="prettyprint lang-genexus" style="max-width: 100%">
Customer                                                                  
{                                                                           
  CustomerId*     (Autonumber property = True)                             
  CustomerName                                                              
  CustomerAddress                                                      
  CustomerPhone
  CustomerEmail
  CustomerBirthDate
  CustomerAddedDate
  CountryId
  CountryName   
}

</pre>

<p>Country Transaction:</p>

<pre class="prettyprint lang-genexus" style="max-width: 100%">
Country
{
  CountryId*     (Autonumber property = True)
  CountryName
}</pre>

<p>Customer rules:</p>

<pre class="prettyprint lang-genexus" style="max-width: 100%">
Default(CustomerAddedDate,&amp;today);
error('The customer must be 18 years old or more') if CustomerBirthDate.Age()&lt;18;</pre>

<p>Accordingly, a Business Component data type of the Customer Transaction is automatically created in the Knowledge Base and you can define in any object a variable of the new type created. Thus, in any object you define a variable named &amp;customer based on the Customer type and:</p>

<ol>
	<li><span id="cke_bm_203S" style="display: none;"> </span>- you codify what you need to do with the &amp;customer variable</li>
	<li>- you apply the Save method to the &amp;customer variable</li>
	<li>- you want to handle the errors that may have occurred, so, the following code shows how you can obtain the errors that happened in a collection variable and iterate the collection for advising the user (or doing something else):</li>
</ol>

<ol>
</ol>

<pre class="Code" style="text-align: left;">
<span id="cke_bm_203E" style="display: none;"> </span>&amp;customer.save()
If &amp;customer.Fail()
   &amp;Messages = &amp;customer.GetMessages()             //you obtain the messages that may have ocurred (you extract and load them in the &amp;Messages collection)
   for &amp;oneMessage in &amp;Messages                    //you iterate the collection
      Do case
      Case &amp;oneMessage.Id ='PrimaryKeyNotFound'   
           msg('The customer does not exist')
      Case &amp;oneMessage.Id ='ForeignKeyNotFound' 
           msg('The country does not exist') 
      Case &amp;oneMessage.Id= 'RecordWasChanged' 
           msg('The customer record was changed by another user')         
      Case &amp;oneMessage.Id ='DuplicatePrimaryKey'   
           msg('A customer with equal identifier already exists')
      Otherwise
           msg(&amp;oneMessage.Description) 
      Endcase       
   endfor
endif</pre>

<div style="TEXT-ALIGN: left;">
<h3><br />
Most common Messages defined by GeneXus:</h3>

<div style="overflow-x:auto"><table class="wikitable FCK__ShowTableBorders">
	<tbody>
		<tr>
			<td class="wikicell" style="TEXT-ALIGN: left;"><strong>Id</strong></td>
			<td class="wikicell" style="TEXT-ALIGN: left;"><strong>Type</strong></td>
			<td class="wikicell" style="TEXT-ALIGN: left;"><strong>Description</strong></td>
		</tr>
		<tr>
			<td class="wikicell" style="TEXT-ALIGN: left;">PrimaryKeyNotFound</td>
			<td class="wikicell" style="TEXT-ALIGN: left;">MessageTypes.Error  </td>
			<td class="wikicell" style="TEXT-ALIGN: left;">Data with the specified key could not be found</td>
		</tr>
		<tr>
			<td class="wikicell" style="TEXT-ALIGN: left;">DuplicatePrimaryKey</td>
			<td class="wikicell" style="TEXT-ALIGN: left;">MessageTypes.Error</td>
			<td class="wikicell" style="TEXT-ALIGN: left;">Record already exist</td>
		</tr>
		<tr>
			<td class="wikicell" style="TEXT-ALIGN: left;">ForeignKeyNotFound</td>
			<td class="wikicell" style="TEXT-ALIGN: left;">MessageTypes.Error</td>
			<td class="wikicell" style="TEXT-ALIGN: left;">No matching 'TableName'</td>
		</tr>
		<tr>
			<td class="wikicell" style="TEXT-ALIGN: left;">CandidateKeyNotFound</td>
			<td class="wikicell" style="TEXT-ALIGN: left;">MessageTypes.Error</td>
			<td class="wikicell" style="TEXT-ALIGN: left;">You can't update a record without reading it first</td>
		</tr>
		<tr>
			<td class="wikicell" style="TEXT-ALIGN: left;">CannotDeleteReferencedRecord</td>
			<td class="wikicell" style="TEXT-ALIGN: left;">MessageTypes.Error</td>
			<td class="wikicell" style="TEXT-ALIGN: left;">Invalid delete, related information in 'TableName'</td>
		</tr>
		<tr>
			<td class="wikicell" style="TEXT-ALIGN: left;">RecordIsLocked</td>
			<td class="wikicell" style="TEXT-ALIGN: left;">MessageTypes.Error</td>
			<td class="wikicell" style="TEXT-ALIGN: left;">Record is in use by another</td>
		</tr>
		<tr>
			<td class="wikicell" style="TEXT-ALIGN: left;">OutOfRange</td>
			<td class="wikicell" style="TEXT-ALIGN: left;">MessageTypes.Error</td>
			<td class="wikicell" style="TEXT-ALIGN: left;">'AttributeName' is out of range</td>
		</tr>
		<tr>
			<td class="wikicell" style="TEXT-ALIGN: left;">RecordWasChanged</td>
			<td class="wikicell" style="TEXT-ALIGN: left;">MessageTypes.Error  </td>
			<td class="wikicell" style="TEXT-ALIGN: left;">'TableName' was changed</td>
		</tr>
	</tbody>
</table></div>

<p style="TEXT-ALIGN: left;MARGIN-LEFT: 80.0px;"> </p>

<p style="MARGIN-LEFT: 40.0px;"><strong>Notes</strong>:<br />
 - OutOfRange: Applies to an attribute wich has set the Value Range property or an attribute based on an Enumerated Data type.<br />
 - If there are any object name conflicts with the <a href="10021.html">Structured Data Type (SDT)</a> &quot;Messages&quot;, when a Knowledge Base is converted to 9.0 version, the object will be rename <a href="https://wiki.genexus.com/commwiki/wiki?2026,," target="_blank">see compatibility section ...</a></p>

<h3><br />
Error and Msg rules defined by the user in the transaction rules:</h3>

<p>The <a href="6852.html">Error</a> and <a href="6854.html">Msg</a> rules allow you to include Messages in the <a href="40335.html">Messages collection (SDT)</a>. When you define Error and Msg rules you can set the Id optional parameter, following this syntax:</p>

<p>                    Msg('Message phase', Id); <br />
                    Error('Error phrase', Id);</p>

<p><br />
i.e.: Error(&quot;Customer name cannot be empty&quot;, <strong>CustomerNameCannotBeEmpty</strong>) if CustomerName.isempty();<br />
<br />
The <strong>CustomerNameCannotBeEmpty</strong> parameter is considered as the &quot;Id&quot; property of the Messages SDT.</p>

<p> </p>

<h3><a id="Considerations" class="HashLink" href="#Considerations">Considerations</a></h3>

<p><b>Id</b><br />
   -  For the <a href="1756.html">GeneXus</a> standard messages, the &quot;Id&quot; is <strong>ever</strong> in English, no matter the model configured language.</p>
</div>

<p>   -   &quot;Id&quot;, however they can be just a code like &quot;1&quot;, &quot;2&quot;, &quot;3&quot; or &quot;Error1&quot;, &quot;Error2&quot;, recommended to define explanatory texts id like &quot;CustomerNameCannotBeEmpty&quot;. The reason is that the code will be clearer. For example: &quot;If &amp;Customer.GetMessages().Item(1).Id=<strong>CustomerNameCannotBeEmpty</strong> is clearer than &quot;If &amp;Customer.GetMessages().Item(1).Id=<strong>1</strong>&quot;</p>

<p style="TEXT-ALIGN: left;"><strong>Type</strong></p>

<p style="TEXT-ALIGN: left;">The &quot;Type&quot; is based on a enumerated domain. You can ask about this values: <b>MessageTypes.Warning </b>and<b> </b><b>MessageTypes.Error</b>. </p>

<div class="titlebar"> </div>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>

<p></p>
<br />
<br />
</div><script src="./images/run_prettify.js?lang=genexus"></script><hr /><table id="Pages" class="Table" cellpadding="1" cellspacing="2" style=" width: 100%;" ><TR><TD><b>Backlinks</b></TD></TR><TR><TD><a href="5846.html">Toc:Business Component</a></TD><TD><a href="23238.html">Business Component Delete method</a></TD><TD><a href="23402.html">Business Component Fail method</a></TD></TR><TR><TD><a href="23475.html">Business Component GetMessages method</a></TD><TD><a href="31695.html">Business Component Insert method</a></TD><TD><a href="31697.html">Business Component InsertOrUpdate method</a></TD><TD><a href="23211.html">Business Component Load method</a></TD></TR><TR><TD><a href="9548.html">Business Component property</a></TD><TD><a href="23229.html">Business Component Save method</a></TD><TD><a href="23404.html">Business Component Success method</a></TD><TD><a href="31696.html">Business Component Update method</a></TD></TR><TR><TD><a href="6852.html">Error rule</a></TD><TD><a href="6854.html">Msg rule</a></TD><TD><a href="16843.html">Transaction Rules in Native Mobile Applications</a></TD></TR></table>
</span></body>
</html><hr /><table id="Pages" class="Table" cellpadding="1" cellspacing="2" style=" width: 100%;" ><TR><td align="left"><font face="Verdana" size="1"><em>Source: <a href="https://wiki.genexus.com" target=_blank>wiki.genexus.com</a></em></font></td><td align="right"><font face="Verdana" size="1"><em>Last modification: 02/14/22 09:18 PM</em></font></td></TR></table></font>