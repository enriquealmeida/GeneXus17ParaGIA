<!DOCTYPE html>
<html>
<head>
<meta http-equiv=Content-Type content="text/html; charset=UTF-8">
<link rel="stylesheet" type="text/css" href="./images/WikiTheme2.css"/>
<link rel="stylesheet" type="text/css" href="./images/bootstrap.min.css"/>
<title>HowTo: Integrate queries in a chatbot</title>
</head>
<body bgcolor="#FFFFFF" style="display: block;margin: 8px;"><span id="W0004BODY" class="WikiBody"><table border=0 width=100%><tr><td><div align="right"><FONT face=Verdana size=2><a href =https://wiki.genexus.com/commwiki/wiki?46415,, target=_"blank">Newest Version</a></FONT></div></td></tr></table><h1 class="WikiName">HowTo: Integrate queries in a chatbot</h1>
<!--HowTo: Integrate queries in a chatbot--><table class="TableWikiBody" id="tblwikibody"><tbody><tr><td><p>Sometimes you need to answer a question in the chatbot by presenting data with different visualization options such as charts, pivot tables, or tables. To solve this scenario, you can include query objects in your conversational flow. </p>

<p>Before following this tutorial, reading <a href="https://wiki.genexus.com/commwiki/wiki?37076,," target="_blank">HowTo: Build a chatbot using GeneXus</a> is recommended.</p>

<h2><a id="Adding+a+query+in+a+Conversational+Flow" class="HashLink" href="#Adding+a+query+in+a+Conversational+Flow">Adding a query in a Conversational Flow</a></h2>

<p>Select the option to add a new Conversational Object and then select the query object you want to add.</p>

<p><img src="./images/46417.png" id="46417" class="WikiImage"/></p>

<p>After that, the conversational flow is initialized. In the trigger messages section, you will see one message with the query description and another message referring to the GXQueryType entity to represent the output format.</p>

<pre class="prettyprint lang-genexus" style="max-width: 100%">
Sales By Country in a &amp;GXQueryViewType:{Table}</pre>

<p>&amp;GXQueryViewType represents the input parameter that is mapped with the GXQueryType entity to set the output format, such as a bar chart, pie chart, pivot table, etc. This entity must be defined in the Chatbot agent (Watson, Dialog Flow, etc.) and to do so you can use the procedure <strong>UploadGridTypeEntity</strong>. See <a href="https://wiki.genexus.com/commwiki/wiki?39302,," target="_blank">HowTo : Initialize entity values in the AI provider</a>.</p>

<p>If the query has parameters, they are all defined in the User Inputs section.</p>

<p>Query parameters will be required; when the parameter has a specific value (Country, Brand, Category, etc.), it must be matched with an entity and the data must be uploaded to the agent (DialogFlow, Watson) in order to train the agent. For the case that the parameter is of generic type –for example, an integer– the system will detect it by itself.</p>

<p><img src="./images/46422.png" id="46422" class="WikiImage"/></p>

<p>Here is an example of a parameter &quot;CTRDSC&quot; that is mapped with an entity &quot;Country&quot; that you must define in your AI provider following the instructions provided in <a href="https://wiki.genexus.com/commwiki/wiki?39302,," target="_blank">HowTo : Initialize entity values in the AI provider</a>.</p>

<p><img src="./images/46423.png" id="46423" class="WikiImage"/></p>

<p>In this case, in Dialog Flow you will see the following entities:</p>

<p><img src="./images/46424.png" id="46424" class="WikiImage"/></p>

<p>And if you edit the Country entity, you can see or edit the values:</p>

<p><img src="./images/46425.png" id="46425" class="WikiImage"/></p>

<p>Following the example, you can add trigger messages with this syntax:</p>

<pre class="prettyprint lang-genexus" style="max-width: 100%">
Sales for &amp;CtrDsc:{Uruguay}</pre>

<p>Where &amp;CtrDsc represents the input parameter of the query that is used to filter the data and is mapped with the Country entity defined in the agent of your AI provider.</p>

<p> </p>

<h2><a id="Executing+the+chatbot+with+queries" class="HashLink" href="#Executing+the+chatbot+with+queries">Executing the chatbot with queries</a></h2>

<p>After you configure your agent provider and generate the chatbot and the application, you are ready to run your chatbot and test the interaction with the queries. In this example, the name of the conversational flow is SalesChatbot; a module was automatically generated by the chatbot generator and you can find a web panel named SalesChabotChatbotWebUI and run this one to test the interaction.</p>

<p><img src="./images/46443.png" id="46443" class="WikiImage"/></p>

<p>For example, for this conversational flow:</p>

<p><img src="./images/46427.png" id="46427" class="WikiImage"/></p>

<p>By typing &quot;Sales by Country&quot; you get this response. First, the chatbot prompts you to enter the country name, and after that returns the data filtered by the country you specify.</p>

<p><img src="./images/46441.png" id="46441" class="WikiImage"/></p>

<p>By typing &quot;Sales by country in a bar chart&quot; you get this response. The flow is the same as the previous example but, in this case, the output is presented in a bar chart.</p>

<p><img src="./images/46442.png" id="46442" class="WikiImage"/></p>

<h3><a id="Availability" class="HashLink" href="#Availability">Availability</a></h3>

<p>This feature is available since <a href="46066.html">GeneXus 17</a>.</p>

<p></p>
</td></tr></tbody></table><script src="./images/run_prettify.js?lang=genexus"></script><hr /><table id="Pages" class="Table" cellpadding="1" cellspacing="2" style=" width: 100%;" ><TR><TD><b>Backlinks</b></TD></TR><TR><TD><a href="47418.html">GeneXus 17 upgrade 2</a></TD></TR><TR><TD><a href="46416.html">HowTo: Create a chatbot using a Dashboard</a></TD><TD><a href="46592.html">Multi-experience with GeneXus 17</a></TD></TR></table>
</span></body>
</html><hr /><table id="Pages" class="Table" cellpadding="1" cellspacing="2" style=" width: 100%;" ><TR><td align="left"><font face="Verdana" size="1"><em>Source: <a href="https://wiki.genexus.com" target=_blank>wiki.genexus.com</a></em></font></td><td align="right"><font face="Verdana" size="1"><em>Last modification: 09/15/20 01:52 PM</em></font></td></TR></table></font>