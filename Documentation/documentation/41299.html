<!DOCTYPE html>
<html>
<head>
<meta http-equiv=Content-Type content="text/html; charset=UTF-8">
<link rel="stylesheet" type="text/css" href="./images/WikiTheme2.css"/>
<link rel="stylesheet" type="text/css" href="./images/bootstrap.min.css"/>
<title>Client.Socket External Object</title>
</head>
<body bgcolor="#FFFFFF" style="display: block;margin: 8px;"><span id="W0004BODY" class="WikiBody"><table border=0 width=100%><tr><td><div align="right"><FONT face=Verdana size=2><a href =https://wiki.genexus.com/commwiki/wiki?41299,, target=_"blank">Newest Version</a></FONT></div></td></tr></table><h1 class="WikiName">Client.Socket External Object</h1>
<!--Client.Socket External Object--><div class="TableWikiBody" id="tblwikibody"><p>It allows establishing, from the client, a bidirectional connection with the <a href='https://en.wikipedia.org/wiki/WebSocket'>WebSocket</a> Server and thus exchanging data efficiently and in real time.</p>

<p>When using GeneXus to create your application and the server, GeneXus will automatically configure the Server connection via WebSocket, as well as manage the connections of client applications and disconnect from them. If the connection is lost or a problem arises, it will try to re-establish the connection. However, if the implementation requires it, the Open and Close methods will be used, which will allow establishing and closing connections with other WebSocket Servers not generated by GeneXus.</p>

<p>Its operation is similar to that of the external object <a href="22442.html">Server.Socket external object</a>, so the Send, Open, and Close events are listened to on the server side using the procedures configured under the properties node Web Notification configuration. For further reading, this article is recommended: <a href="33633.html">HowTo: Receiving and processing a notification message from an external app</a>.</p>

<div style="overflow-x:auto"><table border="0" cellpadding="0" cellspacing="0">
	<tbody>
		<tr>
			<td>
			<p align="center"><img src="./images/41300.png" id="41300" class="WikiImage"/></p>
			</td>
			<td>
			<p align="center"><img src="./images/41301.png" id="41301" class="WikiImage"/></p>
			</td>
		</tr>
	</tbody>
</table></div>

<h3><a id="Properties" class="HashLink" href="#Properties"><strong>Properties</strong></a></h3>

<h4><a id="Status+property" class="HashLink" href="#Status+property"><strong>Status property</strong></a></h4>

<p>Returns the value of the connection, Connected or Disconnected. Read-only.</p>

<h3><a id="Methods" class="HashLink" href="#Methods"><strong>Methods</strong></a></h3>

<h4><a id="Open+method" class="HashLink" href="#Open+method"><strong>Open method</strong></a></h4>

<p>Establishes a connection with the indicated server.</p>

<div style="overflow-x:auto"><table border="0" cellpadding="0" cellspacing="0">
	<tbody>
		<tr>
			<td style="width: 95.0px;">
			<p><strong>Return value</strong></p>
			</td>
			<td style="width: 101.0px;">
			<p>None</p>
			</td>
		</tr>
		<tr>
			<td style="width: 95.0px;">
			<p><strong>Parameters</strong></p>
			</td>
			<td style="width: 101.0px;">
			<p>Url:Character()</p>
			</td>
		</tr>
	</tbody>
</table></div>

<h4><a id="Close+method" class="HashLink" href="#Close+method"><strong>Close method</strong></a></h4>

<p>Closes the connection with the server you are connected to.</p>

<div style="overflow-x:auto"><table border="0" cellpadding="0" cellspacing="0">
	<tbody>
		<tr>
			<td style="width: 95.0px;">
			<p><strong>Return value</strong></p>
			</td>
			<td style="width: 37.0px;">
			<p>None</p>
			</td>
		</tr>
		<tr>
			<td style="width: 95.0px;">
			<p><strong>Parameters</strong></p>
			</td>
			<td style="width: 37.0px;">
			<p>None</p>
			</td>
		</tr>
	</tbody>
</table></div>

<h4><a id="Send+method" class="HashLink" href="#Send+method"><strong>Send method</strong></a></h4>

<p>Sends a message to the server you are connected to.</p>

<div style="overflow-x:auto"><table border="0" cellpadding="0" cellspacing="0">
	<tbody>
		<tr>
			<td style="width: 95.0px;">
			<p><strong>Return value</strong></p>
			</td>
			<td style="width: 107.0px;">
			<p>None</p>
			</td>
		</tr>
		<tr>
			<td style="width: 95.0px;">
			<p><strong>Parameters</strong></p>
			</td>
			<td style="width: 107.0px;">
			<p>Msg:Character()</p>
			</td>
		</tr>
	</tbody>
</table></div>

<h3><a id="Events" class="HashLink" href="#Events"><strong>Events</strong></a></h3>

<h4><a id="Connected+event" class="HashLink" href="#Connected+event"><strong>Connected event</strong></a></h4>

<p>Triggered after running the Open method, once the connection is correctly established.</p>

<div style="overflow-x:auto"><table border="0" cellpadding="0" cellspacing="0">
	<tbody>
		<tr>
			<td style="width: 51.0px;">
			<p><strong>Input</strong></p>
			</td>
			<td style="width: 37.0px;">
			<p>None</p>
			</td>
		</tr>
		<tr>
			<td style="width: 51.0px;">
			<p><strong>Output</strong></p>
			</td>
			<td style="width: 37.0px;">
			<p>None</p>
			</td>
		</tr>
	</tbody>
</table></div>

<p><strong>ConnectionFailed event</strong></p>

<p>Triggered after running the Close method, if the connection failed or was lost somehow.</p>

<div style="overflow-x:auto"><table border="0" cellpadding="0" cellspacing="0">
	<tbody>
		<tr>
			<td style="width: 55.0px;">
			<p><strong>Input</strong></p>
			</td>
			<td style="width: 37.0px;">
			<p>None</p>
			</td>
		</tr>
		<tr>
			<td style="width: 55.0px;">
			<p><strong>Output</strong></p>
			</td>
			<td style="width: 37.0px;">
			<p>None</p>
			</td>
		</tr>
	</tbody>
</table></div>

<p><strong>MessageReceived</strong></p>

<p>Triggered when a message is received. It's a data String received as a Json, which brings the DeviceID and the message sent.</p>

<div style="overflow-x:auto"><table border="0" cellpadding="0" cellspacing="0">
	<tbody>
		<tr>
			<td style="width: 55.0px;">
			<p><strong>Input</strong></p>
			</td>
			<td style="width: 107.0px;">
			<p>None</p>
			</td>
		</tr>
		<tr>
			<td style="width: 55.0px;">
			<p><strong>Output</strong></p>
			</td>
			<td style="width: 107.0px;">
			<p>Msg:Character()</p>
			</td>
		</tr>
	</tbody>
</table></div>

<h3><a id="Examples" class="HashLink" href="#Examples"><strong>Examples</strong></a></h3>

<p>Below is a brief example of a basic implementation of a chat via WebSocket, and lastly a finished implementation.</p>

<p>First, a transaction called Chat will be used to store the message content and the date on which it was sent.</p>

<p>Sample transaction:</p>

<p><img src="./images/41552.PNG" id="41552" class="WikiImage"/></p>

<p>Create a Panel for Smart Devices; add a Grid with an attribute that will show the message received; drag a variable of type VarChar(200) called SentMessage; add a button called Send, and in the event of this button type the code below:</p>

<pre class="prettyprint lang-genexus" style="max-width: 100%">
Event 'Send'
        GeneXus.Client.Socket.Send(&amp;SentMessage)
Endevent</pre>

<p>Sample layout:</p>

<p><img src="./images/41553.png" id="41553" class="WikiImage"/></p>

<p>Now, create a procedure called Sender with the following code:</p>

<pre class="prettyprint lang-genexus" style="max-width: 100%">
&amp;Chat                          = New()
&amp;Chat.ChatMessage              = &amp;NotificationInfo.message
&amp;Chat.ChatMessageDateTime      = NOW()
&amp;Chat.Save()
Commit

&amp;ServerSocket.Broadcast(&amp;NotificationInfo)</pre>

<p>With this code, you will add the new message to the DB. Next, you will make a broadcast to refresh the Grid view for all connected users, regardless of who sent the message.</p>

<p>Note: For more information on how to set up this procedure, read the document <a href="33633.html">HowTo: Receiving and processing a notification message from an external app</a> under the section Received Handler.</p>

<p>Lastly, in the events of the Panel for Smart Devices, you will create the event MessageReceived that will run a Refresh:</p>

<pre class="prettyprint lang-genexus" style="max-width: 100%">
Event Client.Socket.MessageReceived(&amp;Message)
  Refresh
EndEvent</pre>

<p>Example of a possible implementation:</p>

<p><img src="./images/41361.gif" id="41361" class="WikiImage"/></p>

<h3><a id="Scope" class="HashLink" href="#Scope">Scope</a></h3>

<p><strong>Generators: </strong><a href="14453.html">Android</a>, <a href="14917.html">Apple</a>, <a href="12258.html">Java</a>, .NET, <a href="38604.html">.NET Core</a></p>

<p><div style="background-color: rgb(242,242,242);border-left: 6.0px solid rgb(128,128,128);margin-bottom: 15.0px;padding: 4.0px 12.0px;"><b>Note</b>:  The Java, .NET, and .NET Core generators include WebSocket Client support for Web back end since <a href="https://wiki.genexus.com/commwiki/wiki?49301,," target="_blank">GeneXus 17 upgrade 7</a> but they do not support the Status property due to the limitation that properties of External Objects are not supported in Web.</div>
</p>

<p></p>
</div><script src="./images/run_prettify.js?lang=genexus"></script><hr /><table id="Pages" class="Table" cellpadding="1" cellspacing="2" style=" width: 100%;" ><TR><TD><b>Backlinks</b></TD></TR><TR><TD><a href="49629.html">Client.Socket External Object (GeneXus 17 u6 and prior)</a></TD></TR><TR><TD><a href="33633.html">HowTo: Receiving and processing a notification message from an external app</a></TD><TD><a href="45291.html">Load balancing considerations</a></TD><TD><a href="15288.html">Category:Smart Devices API</a></TD></TR></table>
</span></body>
</html><hr /><table id="Pages" class="Table" cellpadding="1" cellspacing="2" style=" width: 100%;" ><TR><td align="left"><font face="Verdana" size="1"><em>Source: <a href="https://wiki.genexus.com" target=_blank>wiki.genexus.com</a></em></font></td><td align="right"><font face="Verdana" size="1"><em>Last modification: 11/19/21 03:16 PM</em></font></td></TR></table></font>